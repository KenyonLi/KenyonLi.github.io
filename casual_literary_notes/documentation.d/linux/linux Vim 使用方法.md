## Vim 使用方法

## 基础操作



Vim 是一个功能强大的文本编辑器，在 Unix 和 Linux 系统中非常流行。虽然 Vim 的学习曲线相对较陡，但掌握一些基本命令可以帮助你高效地编辑文本。以下是 Vim 的基本使用说明。

### 1. 打开 Vim

在终端中输入以下命令打开 Vim：

```sh
vim filename
```

如果文件 `filename` 不存在，Vim 会创建一个新文件。

### 2. 基本模式

Vim 有几种不同的模式，主要包括：

- **普通模式**（Normal Mode）：这是默认模式，用于导航和操作文本。
- **插入模式**（Insert Mode）：用于插入和编辑文本。
- **命令模式**（Command Mode）：用于执行保存、退出等命令。
- **可视模式**（Visual Mode）：用于选择文本。

### 3. 切换模式

- **进入插入模式**：按 `i` 键。
- **返回普通模式**：按 `Esc` 键。
- **进入命令模式**：在普通模式下按 `:` 键。
- **进入可视模式**：在普通模式下按 `v` 键。

### 4. 基本导航

在普通模式下使用以下按键导航：

- `h`：向左移动一个字符。
- `j`：向下移动一行。
- `k`：向上移动一行。
- `l`：向右移动一个字符。
- `0`：移动到行首。
- `$`：移动到行尾。
- `gg`：移动到文件开头。
- `G`：移动到文件末尾。

### 5. 插入和编辑文本

在插入模式下，你可以正常输入文本。以下是一些常用的插入命令：

- `i`：在光标前插入文本。
- `a`：在光标后插入文本。
- `o`：在当前行下方插入一个新行。
- `O`：在当前行上方插入一个新行。

### 6. 删除和复制文本

在普通模式下使用以下命令删除和复制文本：

- `x`：删除光标处的字符。
- `dd`：删除当前行。
- `yy`：复制当前行。
- `p`：在光标后粘贴文本。

### 7. 撤销和重做

在普通模式下使用以下命令：

- `u`：撤销上一步操作。
- `Ctrl` + `r`：重做上一步撤销的操作。

### 8. 搜索和替换

- **搜索**：在普通模式下按 `/` 键，然后输入要搜索的文本并按 `Enter`。使用 `n` 键查找下一个匹配项，`N` 键查找上一个匹配项。
- **替换**：在命令模式下输入以下命令：

  ```sh
  :%s/old/new/g
  ```

  其中 `old` 是要替换的文本，`new` 是替换后的文本。

### 9. 保存和退出

在命令模式下使用以下命令：

- `:w`：保存文件。
- `:q`：退出 Vim。
- `:wq` 或 `:x`：保存并退出。
- `:q!`：强制退出，不保存更改。

### 10. 可视模式

在普通模式下按 `v` 键进入可视模式，然后使用箭头键选择文本。可视模式下可以进行以下操作：

- `d`：删除选中文本。
- `y`：复制选中文本。
- `p`：粘贴选中文本。

### 示例操作

假设我们要编辑一个文件 `example.txt`，并在其中添加一些文本、保存并退出：

1. 打开文件：

   ```sh
   vim example.txt
   ```

2. 进入插入模式并输入文本：

   按 `i` 键进入插入模式，然后输入：

   ```
   This is an example file.
   We are learning how to use Vim.
   ```

3. 返回普通模式：

   按 `Esc` 键。

4. 保存文件：

   按 `:` 键进入命令模式，然后输入 `w` 并按 `Enter`。

5. 退出 Vim：

   按 `:` 键进入命令模式，然后输入 `q` 并按 `Enter`。

通过掌握这些基本命令，你可以在 Vim 中进行有效的文本编辑。随着时间的推移，你可以学习更多高级功能，以提高编辑效率。



## 显示行号



在 Vim 中，你可以通过设置显示行号来方便地进行代码编辑和导航。以下是几种显示行号的方法：

### 1. 临时显示行号

如果你只需要在当前会话中临时显示行号，可以在命令模式下使用以下命令：

```vim
:set number
```

要取消显示行号，可以使用以下命令：

```vim
:set nonumber
```

### 2. 永久显示行号

如果你希望每次启动 Vim 时都显示行号，可以将设置添加到 Vim 配置文件中。Vim 的配置文件通常是 `~/.vimrc`。

编辑 `~/.vimrc` 文件：

```sh
vim ~/.vimrc
```

在文件中添加以下行：

```vim
set number
```

保存并退出文件后，每次启动 Vim 时都会显示行号。

### 3. 其他行号选项

Vim 还提供了一些其他与行号相关的选项：

- **相对行号**：显示相对于当前行的行号。这样有助于快速进行相对行的跳转和操作。

  临时启用相对行号：

  ```vim
  :set relativenumber
  ```

  永久启用相对行号，在 `~/.vimrc` 中添加：

  ```vim
  set relativenumber
  ```

- **同时显示绝对和相对行号**：可以同时显示当前行的绝对行号和其他行的相对行号。将以下两行添加到 `~/.vimrc`：

  ```vim
  set number
  set relativenumber
  ```

### 示例操作

1. **临时显示行号**：

   打开 Vim 并加载文件：

   ```sh
   vim example.txt
   ```

   在命令模式下输入：

   ```vim
   :set number
   ```

2. **永久显示行号**：

   编辑 Vim 配置文件：

   ```sh
   vim ~/.vimrc
   ```

   在文件中添加：

   ```vim
   set number
   ```

   保存并退出。下次启动 Vim 时将自动显示行号。

3. **启用相对行号**：

   临时启用：

   ```vim
   :set relativenumber
   ```

   永久启用，在 `~/.vimrc` 中添加：

   ```vim
   set relativenumber
   ```

通过以上设置，你可以在 Vim 中方便地显示行号，以帮助你更高效地编辑和导航代码。

## 分屏操作

在 Vim 中，分屏功能非常强大，允许你同时查看和编辑多个文件或同一个文件的不同部分。以下是分屏操作的详细说明：

### 1. 垂直分屏

垂直分屏可以将当前窗口分成左右两个部分：

- 打开一个新文件在右侧垂直分屏：

  ```vim
  :vsp filename
  ```

- 仅垂直分割当前窗口，不打开新文件：

  ```vim
  :vsplit
  ```

快捷键：

- `Ctrl` + `w` + `v`：垂直分屏。

### 2. 水平分屏

水平分屏可以将当前窗口分成上下两个部分：

- 打开一个新文件在下方水平分屏：

  ```vim
  :sp filename
  ```

- 仅水平分割当前窗口，不打开新文件：

  ```vim
  :split
  ```

快捷键：

- `Ctrl` + `w` + `s`：水平分屏。

### 3. 在分屏之间切换

你可以使用 `Ctrl` + `w` 组合键在分屏之间切换：

- `Ctrl` + `w` + `h`：移动到左侧分屏。
- `Ctrl` + `w` + `j`：移动到下方分屏。
- `Ctrl` + `w` + `k`：移动到上方分屏。
- `Ctrl` + `w` + `l`：移动到右侧分屏。

### 4. 关闭分屏

你可以使用以下命令关闭当前分屏：

- `:q`：关闭当前分屏。
- `Ctrl` + `w` + `c`：关闭当前分屏。
- `Ctrl` + `w` + `o`：关闭除当前分屏外的所有分屏。

### 5. 调整分屏大小

你可以使用以下命令调整分屏的大小：

- `Ctrl` + `w` + `>`：增加当前分屏的宽度。
- `Ctrl` + `w` + `<`：减少当前分屏的宽度。
- `Ctrl` + `w` + `+`：增加当前分屏的高度。
- `Ctrl` + `w` + `-`：减少当前分屏的高度。
- `Ctrl` + `w` + `=`：使所有分屏等高等宽。

### 示例操作

假设我们要打开两个文件 `file1.txt` 和 `file2.txt`，并在垂直和水平分屏中查看它们：

1. **打开 Vim 并加载 `file1.txt`**：

   ```sh
   vim file1.txt
   ```

2. **垂直分屏并打开 `file2.txt`**：

   在命令模式下输入：

   ```vim
   :vsp file2.txt
   ```

   或使用快捷键：

   ```sh
   Ctrl + w + v
   ```

3. **在水平分屏中打开同一个文件的另一个部分**：

   在命令模式下输入：

   ```vim
   :sp
   ```

   或使用快捷键：

   ```sh
   Ctrl + w + s
   ```

4. **在分屏之间切换**：

   使用快捷键 `Ctrl` + `w` + `h/j/k/l` 在不同的分屏之间切换。

5. **调整分屏大小**：

   使用快捷键 `Ctrl` + `w` + `>`, `<`, `+`, `-` 调整分屏的大小。

6. **关闭分屏**：

   使用命令 `:q` 或快捷键 `Ctrl` + `w` + `c` 关闭当前分屏。

通过这些操作，你可以在 Vim 中高效地分屏查看和编辑多个文件或同一文件的不同部分，从而提高工作效率。



## 格式化格式

在 Vim 中，格式化文本有多种方法，包括自动缩进、对齐代码块和使用外部格式化工具。以下是一些常用的文本格式化方法。

### 1. 自动缩进

Vim 可以自动调整缩进，使代码更易读：

- **设置自动缩进**：

  在命令模式下输入：

  ```vim
  :set autoindent
  ```

- **设置智能缩进**（适用于编程语言）：

  ```vim
  :set smartindent
  ```

- **设置扩展缩进**（适用于代码块）：

  ```vim
  :set cindent
  ```

要使这些设置永久生效，可以将它们添加到 `~/.vimrc` 文件中：

```vim
set autoindent
set smartindent
set cindent
```

### 2. 手动缩进和反缩进

在普通模式下，你可以手动调整缩进：

- **增加缩进**：

  在可视模式下选择要缩进的行，然后按 `>` 键。例如，要增加 3 行的缩进：

  ```vim
  Vjj>
  ```

- **减少缩进**：

  在可视模式下选择要减少缩进的行，然后按 `<` 键。例如，要减少 3 行的缩进：

  ```vim
  Vjj<
  ```

### 3. 格式化整个文件

Vim 提供了 `=` 命令来自动格式化代码块或整个文件：

- **格式化整个文件**：

  在普通模式下输入：

  ```vim
  gg=G
  ```

  这将从文件头（`gg`）到文件尾（`G`）进行格式化。

- **格式化当前行**：

  在普通模式下输入：

  ```vim
  ==
  ```

- **格式化选中的行**：

  进入可视模式选择行，然后按 `=`。

### 4. 使用外部格式化工具

Vim 可以调用外部工具来格式化代码。以下是一个示例，使用 `clang-format` 格式化 C/C++ 代码：

- **在命令模式下运行外部格式化工具**：

  ```vim
  :%!clang-format
  ```

你可以将其映射到快捷键中。例如，将 `F5` 键映射为调用 `clang-format`：

```vim
autocmd FileType c,cpp nnoremap <F5> :%!clang-format<CR>
```

### 5. 自动格式化文件

你可以使用自动命令在保存文件时自动格式化代码：

- **在保存文件时自动格式化**：

  在 `~/.vimrc` 文件中添加以下行（以 `clang-format` 为例）：

  ```vim
  autocmd BufWritePre *.c,*.cpp :silent! %!clang-format
  ```

### 6. 对齐文本

你可以使用 `align.vim` 插件或其他对齐工具来对齐文本。例如，要对齐等号：

- 安装 `align.vim` 插件后，选择要对齐的行并运行以下命令：

  ```vim
  :Align =
  ```

### 示例操作

假设我们有一个 C 文件 `example.c`，并希望格式化它：

1. **打开文件**：

   ```sh
   vim example.c
   ```

2. **设置自动缩进**：

   在命令模式下输入：

   ```vim
   :set autoindent
   :set smartindent
   :set cindent
   ```

3. **格式化整个文件**：

   在普通模式下输入：

   ```vim
   gg=G
   ```

4. **使用 `clang-format` 格式化文件**：

   在命令模式下输入：

   ```vim
   :%!clang-format
   ```

通过这些步骤，你可以在 Vim 中有效地格式化和对齐代码，提高代码的可读性和维护性。

## Vim 中快速格式化 sh 脚本

在 Vim 中快速格式化 sh 脚本或任何文本文件，可以通过以下几种方式实现：

### 1. 自动缩进和格式化

在 Vim 中，你可以使用内置的命令来自动缩进和格式化代码块。

- **设置自动缩进**：

  在编辑 sh 脚本时，确保自动缩进功能已经启用。在命令模式下输入：

  ```vim
  :set autoindent
  ```

- **格式化整个文件**：

  在普通模式下输入以下命令：

  ```vim
  gg=G
  ```

  这将从文件开头 (`gg`) 到文件结尾 (`G`) 进行格式化。

### 2. 使用外部工具进行格式化

你还可以利用外部工具来格式化 sh 脚本。常见的工具如 `shfmt` 可以帮助你快速格式化 Shell 脚本。

- **安装 `shfmt` 工具**：

  首先需要安装 `shfmt` 工具。在大多数 Linux 发行版上，可以使用包管理器进行安装，如：

  ```sh
  sudo apt-get install shfmt    # For Debian/Ubuntu
  sudo yum install shfmt        # For CentOS/RHEL
  ```

- **在 Vim 中调用 `shfmt` 进行格式化**：

  在 Vim 中执行以下命令，可以使用 `shfmt` 对整个文件进行格式化：

  ```vim
  :%!shfmt
  ```

  这会将整个文件的内容通过 `shfmt` 处理后替换当前内容。

### 3. 使用插件进行格式化

如果你经常需要格式化 Shell 脚本，可以考虑安装适当的 Vim 插件来简化这一过程。例如，`vim-shfmt` 插件可以集成 `shfmt` 工具，并提供更多格式化选项和快捷键。

### 示例操作

假设我们有一个名为 `script.sh` 的 Shell 脚本文件，并希望在 Vim 中格式化它：

1. **打开脚本文件**：

   ```sh
   vim script.sh
   ```

2. **设置自动缩进**：

   在命令模式下输入：

   ```vim
   :set autoindent
   ```

3. **使用 `gg=G` 格式化整个文件**：

   在普通模式下输入：

   ```vim
   gg=G
   ```

4. **使用 `shfmt` 工具进行格式化**：

   首先安装 `shfmt` 工具，然后在 Vim 中执行以下命令：

   ```vim
   :%!shfmt
   ```

通过以上步骤，你可以在 Vim 中快速并有效地格式化 Shell 脚本或其他文本文件。





手动安装软件通常涉及下载预编译的二进制文件，并将其复制到系统的可执行路径中。以下是手动安装软件的一般步骤，我将以 `yq` 工具为例说明详细操作：

### 手动安装 `yq` 工具的步骤

`yq` 是一个处理 YAML 文件的命令行工具，我们将手动下载并安装它。

#### 1. 下载 `yq` 的二进制文件

1. 访问 `yq` 的 GitHub releases 页面：[yq Releases](https://github.com/mikefarah/yq/releases)。

2. 根据你的操作系统和架构选择合适的二进制文件。例如，如果你使用的是 Linux x64，选择类似 `yq_linux_amd64` 的文件。

3. 下载选定的二进制文件。可以使用 `wget` 命令：

   ```sh
   wget https://github.com/mikefarah/yq/releases/latest/download/yq_linux_amd64 -O /usr/bin/yq &&\
       chmod +x /usr/bin/yq
   ```

4. 解压下载的文件：

   ```sh
   tar -zxvf yq_linux_amd64.tar.gz
   ```

   这将解压出 `yq` 可执行文件。

#### 2. 安装 `yq`

1. 将 `yq` 可执行文件复制到系统的路径中，例如 `/usr/local/bin`：

   ```sh
   sudo cp yq_linux_amd64 /usr/local/bin/yq
   ```

2. 赋予 `yq` 可执行文件执行权限：

   ```sh
   sudo chmod +x /usr/local/bin/yq
   ```

3. 验证安装是否成功：

   在终端中运行以下命令，应该显示 `yq` 的版本信息：

   ```sh
   yq --version
   ```

#### 3. 在 Vim 中使用 `yq` 格式化 YAML 文件

1. 打开一个 YAML 文件：

   ```sh
   vim your_yaml_file.yaml
   ```

2. 在 Vim 中执行 `yq` 命令来格式化文件：

   ```vim
   :%!yq .
   ```

   这将使用 `yq` 工具对整个 YAML 文件进行格式化并将结果替换当前内容。

通过以上步骤，你可以手动安装 `yq` 或其他类似的工具，并在 Vim 中使用它们来处理和格式化文件。记得根据你使用的工具和操作系统，相应地选择正确的下载链接和文件。