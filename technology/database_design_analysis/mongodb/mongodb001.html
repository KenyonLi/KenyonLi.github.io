<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.63">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" href="/images/logo_v.png"><meta name="keywords" content="kenyonli"><title>分布式中间件-MongoDB | Kenyon Li 随笔 </title><meta name="description" content="欢迎您，来到 Kenyon Li 世界！">
    <link rel="preload" href="/assets/style-d5da7002.css" as="style"><link rel="stylesheet" href="/assets/style-d5da7002.css">
    <link rel="modulepreload" href="/assets/app-c1c3c937.js"><link rel="modulepreload" href="/assets/mongodb001.html-fc05ec9d.js"><link rel="modulepreload" href="/assets/mongodb001.html-ac44abd4.js"><link rel="prefetch" href="/assets/index.html-0c5df828.js" as="script"><link rel="prefetch" href="/assets/index.html-122d66cc.js" as="script"><link rel="prefetch" href="/assets/index.html-1565d8e0.js" as="script"><link rel="prefetch" href="/assets/index.html-6eb9f9a2.js" as="script"><link rel="prefetch" href="/assets/lan_dao.html-f8b49934.js" as="script"><link rel="prefetch" href="/assets/mo_fei_din_lu.html-e84486e3.js" as="script"><link rel="prefetch" href="/assets/read01.html-3499d74d.js" as="script"><link rel="prefetch" href="/assets/yan_pi_juen.html-ebc74c11.js" as="script"><link rel="prefetch" href="/assets/object_oriented_analysis.html-c0b97768.js" as="script"><link rel="prefetch" href="/assets/design001.html-683e1b25.js" as="script"><link rel="prefetch" href="/assets/design002.html-d00aa6ad.js" as="script"><link rel="prefetch" href="/assets/design003.html-ac2e30f0.js" as="script"><link rel="prefetch" href="/assets/ea001.html-e8ab0da6.js" as="script"><link rel="prefetch" href="/assets/ai0001.html-fbb9c4b1.js" as="script"><link rel="prefetch" href="/assets/abp001.html-4d078b9b.js" as="script"><link rel="prefetch" href="/assets/abp002.html-361c1354.js" as="script"><link rel="prefetch" href="/assets/abp003.html-370e112b.js" as="script"><link rel="prefetch" href="/assets/abp004.html-2a550719.js" as="script"><link rel="prefetch" href="/assets/abp005.html-b7b8040d.js" as="script"><link rel="prefetch" href="/assets/abp006.html-afe3148a.js" as="script"><link rel="prefetch" href="/assets/abp007.html-c73814a2.js" as="script"><link rel="prefetch" href="/assets/abp008.html-3c920bb6.js" as="script"><link rel="prefetch" href="/assets/abp009.html-5aa18139.js" as="script"><link rel="prefetch" href="/assets/abp010.html-2f60cd08.js" as="script"><link rel="prefetch" href="/assets/abp011.html-144ed9f8.js" as="script"><link rel="prefetch" href="/assets/abp012.html-b0b755c1.js" as="script"><link rel="prefetch" href="/assets/abp013.html-07f9ef95.js" as="script"><link rel="prefetch" href="/assets/abp014.html-d9b342ae.js" as="script"><link rel="prefetch" href="/assets/abp015.html-2f03e87a.js" as="script"><link rel="prefetch" href="/assets/abp016.html-94352902.js" as="script"><link rel="prefetch" href="/assets/abpmicroservices0001.html-af71ea93.js" as="script"><link rel="prefetch" href="/assets/abpmicroservices0002.html-22ac1590.js" as="script"><link rel="prefetch" href="/assets/abpmicroservices0003.html-fe194269.js" as="script"><link rel="prefetch" href="/assets/abpmicroservices0004.html-c78a6bc2.js" as="script"><link rel="prefetch" href="/assets/abpmicroservices0005.html-658ff302.js" as="script"><link rel="prefetch" href="/assets/abpmicroservices0006.html-229b0517.js" as="script"><link rel="prefetch" href="/assets/abpmicroservices0007.html-943fd56b.js" as="script"><link rel="prefetch" href="/assets/abpmicroservices0008.html-c0fd71da.js" as="script"><link rel="prefetch" href="/assets/abpmicroservices0009.html-1a1fd836.js" as="script"><link rel="prefetch" href="/assets/abpmicroservices0010.html-8139592f.js" as="script"><link rel="prefetch" href="/assets/abpmicroservices0011.html-da7de1f7.js" as="script"><link rel="prefetch" href="/assets/abpmicroservices0012.html-cf03f10f.js" as="script"><link rel="prefetch" href="/assets/index.html-e99c2026.js" as="script"><link rel="prefetch" href="/assets/csharp01.html-08c0927b.js" as="script"><link rel="prefetch" href="/assets/dotnet01.html-9daf028e.js" as="script"><link rel="prefetch" href="/assets/dotnet02.html-6c7c2a0a.js" as="script"><link rel="prefetch" href="/assets/index.html-6379db3c.js" as="script"><link rel="prefetch" href="/assets/socket001.html-7e4e5d27.js" as="script"><link rel="prefetch" href="/assets/elasticsearch001.html-da1479cf.js" as="script"><link rel="prefetch" href="/assets/elasticsearch002.html-bb49ddf5.js" as="script"><link rel="prefetch" href="/assets/kafka01.html-d20844e4.js" as="script"><link rel="prefetch" href="/assets/minio001.html-98035ebe.js" as="script"><link rel="prefetch" href="/assets/rabbitmq01.html-6d96f442.js" as="script"><link rel="prefetch" href="/assets/rabbitmq02.html-d7e85cf9.js" as="script"><link rel="prefetch" href="/assets/schedule_master001.html-4e11cba4.js" as="script"><link rel="prefetch" href="/assets/sharding_sphere_proxy001.html-3469aa09.js" as="script"><link rel="prefetch" href="/assets/tuning001.html-61d6ef57.js" as="script"><link rel="prefetch" href="/assets/tuning002.html-6628017a.js" as="script"><link rel="prefetch" href="/assets/tuning003.html-a5dde2f7.js" as="script"><link rel="prefetch" href="/assets/tuning004.html-054bc685.js" as="script"><link rel="prefetch" href="/assets/tuning005.html-f5259f7c.js" as="script"><link rel="prefetch" href="/assets/index.html-89e48f33.js" as="script"><link rel="prefetch" href="/assets/index.html-33fe1ab6.js" as="script"><link rel="prefetch" href="/assets/redis001.html-235bdc89.js" as="script"><link rel="prefetch" href="/assets/01mysql_info.html-a6b66b2f.js" as="script"><link rel="prefetch" href="/assets/02mysql_info.html-068822cb.js" as="script"><link rel="prefetch" href="/assets/03mysql_innoDB.html-506d1653.js" as="script"><link rel="prefetch" href="/assets/04mysql_info.html-790a1718.js" as="script"><link rel="prefetch" href="/assets/05InnoDB_lock.html-223ae1b5.js" as="script"><link rel="prefetch" href="/assets/06mysql_info.html-4b2d3f6a.js" as="script"><link rel="prefetch" href="/assets/07mysql_info.html-50ae10d4.js" as="script"><link rel="prefetch" href="/assets/08mysql_info.html-7601e865.js" as="script"><link rel="prefetch" href="/assets/09mysql_centos.html-43a9f4a0.js" as="script"><link rel="prefetch" href="/assets/10mysql_write_read.html-84b83419.js" as="script"><link rel="prefetch" href="/assets/index.html-106989a1.js" as="script"><link rel="prefetch" href="/assets/cdn001.html-1eda9371.js" as="script"><link rel="prefetch" href="/assets/dns001.html-d38b2d4f.js" as="script"><link rel="prefetch" href="/assets/docker01.html-c099819b.js" as="script"><link rel="prefetch" href="/assets/docker02.html-2fa931a0.js" as="script"><link rel="prefetch" href="/assets/docker03.html-feb12d1f.js" as="script"><link rel="prefetch" href="/assets/docker04.html-8213c817.js" as="script"><link rel="prefetch" href="/assets/frp001.html-86b24d68.js" as="script"><link rel="prefetch" href="/assets/jenkins001.html-d0fcb613.js" as="script"><link rel="prefetch" href="/assets/centos9_001.html-e73b097e.js" as="script"><link rel="prefetch" href="/assets/index.html-7a43a8bb.js" as="script"><link rel="prefetch" href="/assets/linux001.html-a464543d.js" as="script"><link rel="prefetch" href="/assets/linux002.html-58cf1ca5.js" as="script"><link rel="prefetch" href="/assets/linux003.html-51f3f2b1.js" as="script"><link rel="prefetch" href="/assets/linux004.html-23a1a9e7.js" as="script"><link rel="prefetch" href="/assets/vpn01.html-d411bec4.js" as="script"><link rel="prefetch" href="/assets/vpn02.html-9041f95f.js" as="script"><link rel="prefetch" href="/assets/vpn03.html-10bdbaeb.js" as="script"><link rel="prefetch" href="/assets/vpn04.html-c838e0a5.js" as="script"><link rel="prefetch" href="/assets/nginx001.html-e8ab8a03.js" as="script"><link rel="prefetch" href="/assets/nginx002.html-c594a14a.js" as="script"><link rel="prefetch" href="/assets/index.html-f213c134.js" as="script"><link rel="prefetch" href="/assets/index.html-d290a688.js" as="script"><link rel="prefetch" href="/assets/index.html-32bd2362.js" as="script"><link rel="prefetch" href="/assets/index.html-aae62809.js" as="script"><link rel="prefetch" href="/assets/axure_rp_10_001.html-337bca08.js" as="script"><link rel="prefetch" href="/assets/management_0001.html-8076a85d.js" as="script"><link rel="prefetch" href="/assets/404.html-60b35caa.js" as="script"><link rel="prefetch" href="/assets/index.html-1db2663f.js" as="script"><link rel="prefetch" href="/assets/index.html-e7f831f3.js" as="script"><link rel="prefetch" href="/assets/index.html-8b52f0d9.js" as="script"><link rel="prefetch" href="/assets/index.html-4648e07d.js" as="script"><link rel="prefetch" href="/assets/lan_dao.html-8a98ac78.js" as="script"><link rel="prefetch" href="/assets/mo_fei_din_lu.html-f5dc1ae7.js" as="script"><link rel="prefetch" href="/assets/read01.html-1687e123.js" as="script"><link rel="prefetch" href="/assets/yan_pi_juen.html-64856c47.js" as="script"><link rel="prefetch" href="/assets/object_oriented_analysis.html-1470ec02.js" as="script"><link rel="prefetch" href="/assets/design001.html-2dca36d3.js" as="script"><link rel="prefetch" href="/assets/design002.html-d7f05fa3.js" as="script"><link rel="prefetch" href="/assets/design003.html-d38fa6cb.js" as="script"><link rel="prefetch" href="/assets/ea001.html-a0d6ab52.js" as="script"><link rel="prefetch" href="/assets/ai0001.html-570f8bf2.js" as="script"><link rel="prefetch" href="/assets/abp001.html-e8e8c350.js" as="script"><link rel="prefetch" href="/assets/abp002.html-8b64116a.js" as="script"><link rel="prefetch" href="/assets/abp003.html-97dcc164.js" as="script"><link rel="prefetch" href="/assets/abp004.html-61336e39.js" as="script"><link rel="prefetch" href="/assets/abp005.html-c353f637.js" as="script"><link rel="prefetch" href="/assets/abp006.html-1440855d.js" as="script"><link rel="prefetch" href="/assets/abp007.html-ab8fed2b.js" as="script"><link rel="prefetch" href="/assets/abp008.html-6d348981.js" as="script"><link rel="prefetch" href="/assets/abp009.html-49dfe559.js" as="script"><link rel="prefetch" href="/assets/abp010.html-9c827b9c.js" as="script"><link rel="prefetch" href="/assets/abp011.html-3fb5d44f.js" as="script"><link rel="prefetch" href="/assets/abp012.html-97019b82.js" as="script"><link rel="prefetch" href="/assets/abp013.html-70d09ec2.js" as="script"><link rel="prefetch" href="/assets/abp014.html-df3b5c55.js" as="script"><link rel="prefetch" href="/assets/abp015.html-68bba06f.js" as="script"><link rel="prefetch" href="/assets/abp016.html-301af947.js" as="script"><link rel="prefetch" href="/assets/abpmicroservices0001.html-fb866520.js" as="script"><link rel="prefetch" href="/assets/abpmicroservices0002.html-aac60f40.js" as="script"><link rel="prefetch" href="/assets/abpmicroservices0003.html-72bb2608.js" as="script"><link rel="prefetch" href="/assets/abpmicroservices0004.html-0aa290ee.js" as="script"><link rel="prefetch" href="/assets/abpmicroservices0005.html-84e05aa9.js" as="script"><link rel="prefetch" href="/assets/abpmicroservices0006.html-4fda8e55.js" as="script"><link rel="prefetch" href="/assets/abpmicroservices0007.html-69b1b7dd.js" as="script"><link rel="prefetch" href="/assets/abpmicroservices0008.html-cf956168.js" as="script"><link rel="prefetch" href="/assets/abpmicroservices0009.html-9ac9702e.js" as="script"><link rel="prefetch" href="/assets/abpmicroservices0010.html-87af3317.js" as="script"><link rel="prefetch" href="/assets/abpmicroservices0011.html-3da615b7.js" as="script"><link rel="prefetch" href="/assets/abpmicroservices0012.html-e913010d.js" as="script"><link rel="prefetch" href="/assets/index.html-318c85d6.js" as="script"><link rel="prefetch" href="/assets/csharp01.html-2c14b5d2.js" as="script"><link rel="prefetch" href="/assets/dotnet01.html-01750e0b.js" as="script"><link rel="prefetch" href="/assets/dotnet02.html-8c224ecf.js" as="script"><link rel="prefetch" href="/assets/index.html-1916077d.js" as="script"><link rel="prefetch" href="/assets/socket001.html-ba30a642.js" as="script"><link rel="prefetch" href="/assets/elasticsearch001.html-7430deaa.js" as="script"><link rel="prefetch" href="/assets/elasticsearch002.html-c4327d81.js" as="script"><link rel="prefetch" href="/assets/kafka01.html-d0597fdb.js" as="script"><link rel="prefetch" href="/assets/minio001.html-e4e18988.js" as="script"><link rel="prefetch" href="/assets/rabbitmq01.html-94778e50.js" as="script"><link rel="prefetch" href="/assets/rabbitmq02.html-5d7ed981.js" as="script"><link rel="prefetch" href="/assets/schedule_master001.html-db33de28.js" as="script"><link rel="prefetch" href="/assets/sharding_sphere_proxy001.html-e178b1f2.js" as="script"><link rel="prefetch" href="/assets/tuning001.html-81ee10f0.js" as="script"><link rel="prefetch" href="/assets/tuning002.html-3915c089.js" as="script"><link rel="prefetch" href="/assets/tuning003.html-d28fbc5d.js" as="script"><link rel="prefetch" href="/assets/tuning004.html-45498f86.js" as="script"><link rel="prefetch" href="/assets/tuning005.html-53075a0a.js" as="script"><link rel="prefetch" href="/assets/index.html-83472dc7.js" as="script"><link rel="prefetch" href="/assets/index.html-2e07e830.js" as="script"><link rel="prefetch" href="/assets/redis001.html-81baf7e4.js" as="script"><link rel="prefetch" href="/assets/01mysql_info.html-d7f1867f.js" as="script"><link rel="prefetch" href="/assets/02mysql_info.html-8fc8d63a.js" as="script"><link rel="prefetch" href="/assets/03mysql_innoDB.html-9c9af126.js" as="script"><link rel="prefetch" href="/assets/04mysql_info.html-4b3160ce.js" as="script"><link rel="prefetch" href="/assets/05InnoDB_lock.html-205ddc38.js" as="script"><link rel="prefetch" href="/assets/06mysql_info.html-76bb44c4.js" as="script"><link rel="prefetch" href="/assets/07mysql_info.html-e1071d89.js" as="script"><link rel="prefetch" href="/assets/08mysql_info.html-c24d3548.js" as="script"><link rel="prefetch" href="/assets/09mysql_centos.html-4826990b.js" as="script"><link rel="prefetch" href="/assets/10mysql_write_read.html-f8502a25.js" as="script"><link rel="prefetch" href="/assets/index.html-341ba3fa.js" as="script"><link rel="prefetch" href="/assets/cdn001.html-1e454cb6.js" as="script"><link rel="prefetch" href="/assets/dns001.html-2add38d8.js" as="script"><link rel="prefetch" href="/assets/docker01.html-748273dd.js" as="script"><link rel="prefetch" href="/assets/docker02.html-d1864030.js" as="script"><link rel="prefetch" href="/assets/docker03.html-b13fc535.js" as="script"><link rel="prefetch" href="/assets/docker04.html-4a38e8b5.js" as="script"><link rel="prefetch" href="/assets/frp001.html-92c57efc.js" as="script"><link rel="prefetch" href="/assets/jenkins001.html-c62bbaa1.js" as="script"><link rel="prefetch" href="/assets/centos9_001.html-186fb4f5.js" as="script"><link rel="prefetch" href="/assets/index.html-aed31d7b.js" as="script"><link rel="prefetch" href="/assets/linux001.html-99ea1dd0.js" as="script"><link rel="prefetch" href="/assets/linux002.html-2fbd42df.js" as="script"><link rel="prefetch" href="/assets/linux003.html-3c59ddc1.js" as="script"><link rel="prefetch" href="/assets/linux004.html-b7f6db9b.js" as="script"><link rel="prefetch" href="/assets/vpn01.html-42016abb.js" as="script"><link rel="prefetch" href="/assets/vpn02.html-2ae1a7b1.js" as="script"><link rel="prefetch" href="/assets/vpn03.html-66ddcbf5.js" as="script"><link rel="prefetch" href="/assets/vpn04.html-022cbbf6.js" as="script"><link rel="prefetch" href="/assets/nginx001.html-5dfd0aa1.js" as="script"><link rel="prefetch" href="/assets/nginx002.html-23a7ed3a.js" as="script"><link rel="prefetch" href="/assets/index.html-b3e0fb83.js" as="script"><link rel="prefetch" href="/assets/index.html-1142373e.js" as="script"><link rel="prefetch" href="/assets/index.html-06a86388.js" as="script"><link rel="prefetch" href="/assets/index.html-5ce4eeab.js" as="script"><link rel="prefetch" href="/assets/axure_rp_10_001.html-e60bbb12.js" as="script"><link rel="prefetch" href="/assets/management_0001.html-c805580e.js" as="script"><link rel="prefetch" href="/assets/404.html-e3ed7bad.js" as="script"><link rel="prefetch" href="/assets/index-e32a7948.js" as="script"><link rel="prefetch" href="/assets/mermaid.core-f21db64e.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><img class="logo" src="/images/home_logo_v.png" alt="Kenyon Li 随笔 "><span class="site-name can-hide">Kenyon Li 随笔 </span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/" class="" aria-label="首页"><!--[--><!--]--> 首页 <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="生活"><span class="title">生活</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="生活"><span class="title">生活</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/life/index.md" class="router-link-active" aria-label="生活之旅"><!--[--><!--]--> 生活之旅 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="技术"><span class="title">技术</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="技术"><span class="title">技术</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/technology/front_end/vue/index.md" class="router-link-active" aria-label="前端设计与技术"><!--[--><!--]--> 前端设计与技术 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/technology/back_end/csharp/csharp01.md" class="router-link-active" aria-label="后端设计与技术"><!--[--><!--]--> 后端设计与技术 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/technology/database_design_analysis/mysql/01mysql_info.md" class="router-link-active" aria-label="数据库设计与技术"><!--[--><!--]--> 数据库设计与技术 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/technology/architecture_design_analysis/enterprise_architect/ea001.md" class="router-link-active" aria-label="架构设计与分析"><!--[--><!--]--> 架构设计与分析 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/technology/deployment_operations/docker/docker01.md" class="router-link-active" aria-label="部署与运维技术"><!--[--><!--]--> 部署与运维技术 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/technology/product_design_analysis/axure_rp_10_001.md" class="router-link-active" aria-label="产品设计与分析"><!--[--><!--]--> 产品设计与分析 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/technology/code_management/git/index.md" class="router-link-active" aria-label="代码管理"><!--[--><!--]--> 代码管理 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/technology/artificial_intelligence/ai/ai0001.md" class="router-link-active" aria-label="人工智能"><!--[--><!--]--> 人工智能 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/technology/project_management/project_management_0001.md" class="router-link-active" aria-label="项目管理"><!--[--><!--]--> 项目管理 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="阅读"><span class="title">阅读</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="阅读"><span class="title">阅读</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/read/social_interaction/yan_pi_juen.md" class="router-link-active" aria-label="羊皮卷"><!--[--><!--]--> 羊皮卷 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/read/social_interaction/lan_dao.md" class="router-link-active" aria-label="狼道"><!--[--><!--]--> 狼道 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/read/social_interaction/mo_fei_din_lu.md" class="router-link-active" aria-label="墨菲定律"><!--[--><!--]--> 墨菲定律 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/read/social_interaction/read01.md" class="router-link-active" aria-label="什么反刍思维"><!--[--><!--]--> 什么反刍思维 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/read/technology/object_oriented_analysis.md" class="router-link-active" aria-label="面向对象分析与设计"><!--[--><!--]--> 面向对象分析与设计 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="收藏"><span class="title">收藏</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="收藏"><span class="title">收藏</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/collect/index.md" class="router-link-active" aria-label="浏览器书签"><!--[--><!--]--> 浏览器书签 <!--[--><!--]--></a></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" placeholder="搜索" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/" class="" aria-label="首页"><!--[--><!--]--> 首页 <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="生活"><span class="title">生活</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="生活"><span class="title">生活</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/life/index.md" class="router-link-active" aria-label="生活之旅"><!--[--><!--]--> 生活之旅 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="技术"><span class="title">技术</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="技术"><span class="title">技术</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/technology/front_end/vue/index.md" class="router-link-active" aria-label="前端设计与技术"><!--[--><!--]--> 前端设计与技术 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/technology/back_end/csharp/csharp01.md" class="router-link-active" aria-label="后端设计与技术"><!--[--><!--]--> 后端设计与技术 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/technology/database_design_analysis/mysql/01mysql_info.md" class="router-link-active" aria-label="数据库设计与技术"><!--[--><!--]--> 数据库设计与技术 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/technology/architecture_design_analysis/enterprise_architect/ea001.md" class="router-link-active" aria-label="架构设计与分析"><!--[--><!--]--> 架构设计与分析 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/technology/deployment_operations/docker/docker01.md" class="router-link-active" aria-label="部署与运维技术"><!--[--><!--]--> 部署与运维技术 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/technology/product_design_analysis/axure_rp_10_001.md" class="router-link-active" aria-label="产品设计与分析"><!--[--><!--]--> 产品设计与分析 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/technology/code_management/git/index.md" class="router-link-active" aria-label="代码管理"><!--[--><!--]--> 代码管理 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/technology/artificial_intelligence/ai/ai0001.md" class="router-link-active" aria-label="人工智能"><!--[--><!--]--> 人工智能 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/technology/project_management/project_management_0001.md" class="router-link-active" aria-label="项目管理"><!--[--><!--]--> 项目管理 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="阅读"><span class="title">阅读</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="阅读"><span class="title">阅读</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/read/social_interaction/yan_pi_juen.md" class="router-link-active" aria-label="羊皮卷"><!--[--><!--]--> 羊皮卷 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/read/social_interaction/lan_dao.md" class="router-link-active" aria-label="狼道"><!--[--><!--]--> 狼道 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/read/social_interaction/mo_fei_din_lu.md" class="router-link-active" aria-label="墨菲定律"><!--[--><!--]--> 墨菲定律 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/read/social_interaction/read01.md" class="router-link-active" aria-label="什么反刍思维"><!--[--><!--]--> 什么反刍思维 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/read/technology/object_oriented_analysis.md" class="router-link-active" aria-label="面向对象分析与设计"><!--[--><!--]--> 面向对象分析与设计 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="收藏"><span class="title">收藏</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="收藏"><span class="title">收藏</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/collect/index.md" class="router-link-active" aria-label="浏览器书签"><!--[--><!--]--> 浏览器书签 <!--[--><!--]--></a></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">前端设计与技术 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><p tabindex="0" class="sidebar-item collapsible">javasrcipt <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/front_end/javascript/index.md" class="sidebar-item" aria-label="js语法基础"><!--[--><!--]--> js语法基础 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item collapsible">H5语法 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/front_end/h5/index.md" class="sidebar-item" aria-label="H5语法基础"><!--[--><!--]--> H5语法基础 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item collapsible">CSS样式 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/front_end/css/index.md" class="sidebar-item" aria-label="CSS语法基础"><!--[--><!--]--> CSS语法基础 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item collapsible">Vue语法 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/front_end/vue/index.md" class="sidebar-item" aria-label="vue语法基础"><!--[--><!--]--> vue语法基础 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">后端设计与技术 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><p tabindex="0" class="sidebar-item collapsible">C#语法特性 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/back_end/csharp/csharp01.md" class="sidebar-item" aria-label="C#语法特性"><!--[--><!--]--> C#语法特性 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item collapsible">C/C++ <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/back_end/cppreference/index.md" class="sidebar-item" aria-label="c/c++"><!--[--><!--]--> c/c++ <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item collapsible">dotnet Core <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/back_end/dotnetcore/dotnet01.md" class="sidebar-item" aria-label="dotnet 安装 CLI/SDK"><!--[--><!--]--> dotnet 安装 CLI/SDK <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/dotnetcore/index.md" class="sidebar-item" aria-label="EFCore数据库迁移命令"><!--[--><!--]--> EFCore数据库迁移命令 <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/dotnetcore/socket001.md" class="sidebar-item" aria-label="Socket网络编程"><!--[--><!--]--> Socket网络编程 <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/dotnetcore/dotnet02.md" class="sidebar-item" aria-label="Net 后台代码模拟浏览器请求 Get、Post、Put的扩展方法"><!--[--><!--]--> Net 后台代码模拟浏览器请求 Get、Post、Put的扩展方法 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item collapsible">ABP vNnext <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/back_end/abp/abp001.md" class="sidebar-item" aria-label="ABP CLI"><!--[--><!--]--> ABP CLI <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/abp/abp002.md" class="sidebar-item" aria-label="ABP vNnext  核心根基模块化"><!--[--><!--]--> ABP vNnext  核心根基模块化 <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/abp/abp003.md" class="sidebar-item" aria-label="ABP核心项目-电商项目(一)-落地实战"><!--[--><!--]--> ABP核心项目-电商项目(一)-落地实战 <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/abp/abp004.md" class="sidebar-item" aria-label="ABP核心项目-电商项目落地实战(二)-领域层优化"><!--[--><!--]--> ABP核心项目-电商项目落地实战(二)-领域层优化 <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/abp/abp005.md" class="sidebar-item" aria-label="ABP核心项目-电商项目落地实战(三)-仓储、服务层优化"><!--[--><!--]--> ABP核心项目-电商项目落地实战(三)-仓储、服务层优化 <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/abp/abp006.md" class="sidebar-item" aria-label="ABP核心项目-电商项目落地实战(四)-应用、web层优化、原理"><!--[--><!--]--> ABP核心项目-电商项目落地实战(四)-应用、web层优化、原理 <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/abp/abp007.md" class="sidebar-item" aria-label="ABP核心项目-电商项目(五)-动态c#API客户端模块"><!--[--><!--]--> ABP核心项目-电商项目(五)-动态c#API客户端模块 <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/abp/abp008.md" class="sidebar-item" aria-label="ABP核心项目-电商项目(六)-用户组件-用户身份模块"><!--[--><!--]--> ABP核心项目-电商项目(六)-用户组件-用户身份模块 <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/abp/abp009.md" class="sidebar-item" aria-label="ABP核心项目-电商项目(七)-用户组件-账户模块"><!--[--><!--]--> ABP核心项目-电商项目(七)-用户组件-账户模块 <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/abp/abp010.md" class="sidebar-item" aria-label="ABP核心项目-电商项目(八)-用户组件-权限模块"><!--[--><!--]--> ABP核心项目-电商项目(八)-用户组件-权限模块 <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/abp/abp011.md" class="sidebar-item" aria-label="ABP核心项目-电商项目(九)-用户组件-多租户模块"><!--[--><!--]--> ABP核心项目-电商项目(九)-用户组件-多租户模块 <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/abp/abp012.md" class="sidebar-item" aria-label="ABP核心项目-电商项目(十)-疑问记录"><!--[--><!--]--> ABP核心项目-电商项目(十)-疑问记录 <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/abp/abp013.md" class="sidebar-item" aria-label="ABP核心项目-电商项目(十一)-设置模块"><!--[--><!--]--> ABP核心项目-电商项目(十一)-设置模块 <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/abp/abp014.md" class="sidebar-item" aria-label="ABP核心项目-电商项目(十二)-特征模块"><!--[--><!--]--> ABP核心项目-电商项目(十二)-特征模块 <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/abp/abp015.md" class="sidebar-item" aria-label="ABP核心项目-电商项目(十三)-异常/认证/本地化模块"><!--[--><!--]--> ABP核心项目-电商项目(十三)-异常/认证/本地化模块 <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/abp/abp016.md" class="sidebar-item" aria-label="ABP核心项目-电商项目(十四)-虚拟文件系统"><!--[--><!--]--> ABP核心项目-电商项目(十四)-虚拟文件系统 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item collapsible">Apb微服务项目 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/back_end/abpmicroservices/abpmicroservices0001.md" class="sidebar-item" aria-label="微服务电商项目落地"><!--[--><!--]--> 微服务电商项目落地 <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/abpmicroservices/abpmicroservices0002.md" class="sidebar-item" aria-label="微服务通信"><!--[--><!--]--> 微服务通信 <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/abpmicroservices/abpmicroservices0003.md" class="sidebar-item" aria-label="微服务网关-Ocelot"><!--[--><!--]--> 微服务网关-Ocelot <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/abpmicroservices/abpmicroservices0004.md" class="sidebar-item" aria-label="微服务注册中心-Consul"><!--[--><!--]--> 微服务注册中心-Consul <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/abpmicroservices/abpmicroservices0005.md" class="sidebar-item" aria-label="微服务注配置中心-Nacos"><!--[--><!--]--> 微服务注配置中心-Nacos <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/abpmicroservices/abpmicroservices0006.md" class="sidebar-item" aria-label="微服务事件总线-CAP"><!--[--><!--]--> 微服务事件总线-CAP <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/abpmicroservices/abpmicroservices0007.md" class="sidebar-item" aria-label="微服务链路监控-skywalking"><!--[--><!--]--> 微服务链路监控-skywalking <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/abpmicroservices/abpmicroservices0008.md" class="sidebar-item" aria-label="微服务日志中心"><!--[--><!--]--> 微服务日志中心 <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/abpmicroservices/abpmicroservices0009.md" class="sidebar-item" aria-label="微服务分布式事务"><!--[--><!--]--> 微服务分布式事务 <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/abpmicroservices/abpmicroservices0010.md" class="sidebar-item" aria-label="微服务分布式权限"><!--[--><!--]--> 微服务分布式权限 <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/abpmicroservices/abpmicroservices0011.md" class="sidebar-item" aria-label="微服务分布式文件系统、分布式缓存、分布式锁"><!--[--><!--]--> 微服务分布式文件系统、分布式缓存、分布式锁 <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/abpmicroservices/abpmicroservices0012.md" class="sidebar-item" aria-label="微服务大数据库MongoDB、任务调度Hangfire"><!--[--><!--]--> 微服务大数据库MongoDB、任务调度Hangfire <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item collapsible">分布式消息中间件-RabbitMQ <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/back_end/rabbitmq/rabbitmq01.md" class="sidebar-item" aria-label="RabbitMQ简介（一）"><!--[--><!--]--> RabbitMQ简介（一） <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/rabbitmq/rabbitmq02.md" class="sidebar-item" aria-label="RabbitMQ（二）"><!--[--><!--]--> RabbitMQ（二） <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item collapsible">分布式消息中间件-Kafka <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/back_end/kafka/kafka01.md" class="sidebar-item" aria-label="Kafka介绍（一）"><!--[--><!--]--> Kafka介绍（一） <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item collapsible">分布式中间件-ShardingSphere-Proxy <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/back_end/sharding_sphere_proxy/sharding_sphere_proxy001.md" class="sidebar-item" aria-label="分布式中间件-ShardingSphere-Proxy"><!--[--><!--]--> 分布式中间件-ShardingSphere-Proxy <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item collapsible">分布式中间件-ElasticSearch <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/back_end/elasticsearch/elasticsearch001.md" class="sidebar-item" aria-label="ElasticSearch"><!--[--><!--]--> ElasticSearch <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/elasticsearch/elasticsearch002.md" class="sidebar-item" aria-label="ElasticSearch-分词器"><!--[--><!--]--> ElasticSearch-分词器 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item collapsible">分布式中间件-Minio <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/back_end/minio/minio001.md" class="sidebar-item" aria-label="Minio"><!--[--><!--]--> Minio <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item collapsible">分布式任务调度中间件-ScheduleMaster <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/back_end/schedule_master/schedule_master001.md" class="sidebar-item" aria-label="分布式任务调度中间件-ScheduleMaster"><!--[--><!--]--> 分布式任务调度中间件-ScheduleMaster <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item collapsible">性能调优 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/back_end/tuning/tuning001.md" class="sidebar-item" aria-label="DNS调优"><!--[--><!--]--> DNS调优 <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/tuning/tuning002.md" class="sidebar-item" aria-label="CDN调优"><!--[--><!--]--> CDN调优 <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/tuning/tuning003.md" class="sidebar-item" aria-label="Nginx调优"><!--[--><!--]--> Nginx调优 <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/tuning/tuning004.md" class="sidebar-item" aria-label="WebAPI调优"><!--[--><!--]--> WebAPI调优 <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/tuning/tuning005.md" class="sidebar-item" aria-label="EFCore调优"><!--[--><!--]--> EFCore调优 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading active collapsible">数据库设计与技术 <span class="down arrow"></span></p><ul style="" class="sidebar-item-children"><!--[--><li><p tabindex="0" class="sidebar-item collapsible">MySql数据库 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/database_design_analysis/mysql/index.md" class="sidebar-item" aria-label="Mysql8.0 Ubuntu 20.4 安装"><!--[--><!--]--> Mysql8.0 Ubuntu 20.4 安装 <!--[--><!--]--></a><!----></li><li><a href="/technology/database_design_analysis/mysql/09mysql_centos.md" class="sidebar-item" aria-label="Mysql8.0 CentOS Stream 9 安装"><!--[--><!--]--> Mysql8.0 CentOS Stream 9 安装 <!--[--><!--]--></a><!----></li><li><a href="/technology/database_design_analysis/mysql/10mysql_write_read.md" class="sidebar-item" aria-label="Mysql 8.0 主从部署-读写分离"><!--[--><!--]--> Mysql 8.0 主从部署-读写分离 <!--[--><!--]--></a><!----></li><li><a href="/technology/database_design_analysis/mysql/01mysql_info.md" class="sidebar-item" aria-label="Mysql 架构体系详解"><!--[--><!--]--> Mysql 架构体系详解 <!--[--><!--]--></a><!----></li><li><a href="/technology/database_design_analysis/mysql/02mysql_info.md" class="sidebar-item" aria-label="InnoDB架构详解、事务介绍"><!--[--><!--]--> InnoDB架构详解、事务介绍 <!--[--><!--]--></a><!----></li><li><a href="/technology/database_design_analysis/mysql/03mysql_innoDB.md" class="sidebar-item" aria-label="InnoDB事务"><!--[--><!--]--> InnoDB事务 <!--[--><!--]--></a><!----></li><li><a href="/technology/database_design_analysis/mysql/04mysql_info.md" class="sidebar-item" aria-label="InnoDB索引"><!--[--><!--]--> InnoDB索引 <!--[--><!--]--></a><!----></li><li><a href="/technology/database_design_analysis/mysql/05InnoDB_lock.md" class="sidebar-item" aria-label="Mysql InnoDB锁"><!--[--><!--]--> Mysql InnoDB锁 <!--[--><!--]--></a><!----></li><li><a href="/technology/database_design_analysis/mysql/06mysql_info.md" class="sidebar-item" aria-label="Mysql 性能优化"><!--[--><!--]--> Mysql 性能优化 <!--[--><!--]--></a><!----></li><li><a href="/technology/database_design_analysis/mysql/07mysql_info.md" class="sidebar-item" aria-label="MySQL分库分表"><!--[--><!--]--> MySQL分库分表 <!--[--><!--]--></a><!----></li><li><a href="/technology/database_design_analysis/mysql/08mysql_info.md" class="sidebar-item" aria-label="MySQL集群篇"><!--[--><!--]--> MySQL集群篇 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item active collapsible">MongoDB数据库 <span class="down arrow"></span></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/technology/database_design_analysis/mongodb/mongodb001.md" class="sidebar-item active" aria-label="分布式中间件-MongoDB"><!--[--><!--]--> 分布式中间件-MongoDB <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item collapsible">Redis数据库 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/database_design_analysis/redis/redis001.md" class="sidebar-item" aria-label="分布式中间件-Redis"><!--[--><!--]--> 分布式中间件-Redis <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">架构设计与分析 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><p tabindex="0" class="sidebar-item collapsible">设计模式 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/architecture_design_analysis/design/design001.md" class="sidebar-item" aria-label="工厂、抽象工厂、策略模式"><!--[--><!--]--> 工厂、抽象工厂、策略模式 <!--[--><!--]--></a><!----></li><li><a href="/technology/architecture_design_analysis/design/design002.md" class="sidebar-item" aria-label="设计模式-应用场景和优缺点"><!--[--><!--]--> 设计模式-应用场景和优缺点 <!--[--><!--]--></a><!----></li><li><a href="/technology/architecture_design_analysis/design/design003.md" class="sidebar-item" aria-label="存储高可用"><!--[--><!--]--> 存储高可用 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item collapsible">EA工具 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/architecture_design_analysis/enterprise_architect/ea001.md" class="sidebar-item" aria-label="UML、类图、顺序图 "><!--[--><!--]--> UML、类图、顺序图  <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">部署与运维技术 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><p tabindex="0" class="sidebar-item collapsible">linux系统 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/deployment_operations/linux/index.md" class="sidebar-item" aria-label="linux基础"><!--[--><!--]--> linux基础 <!--[--><!--]--></a><!----></li><li><a href="/technology/deployment_operations/linux/centos9_001.md" class="sidebar-item" aria-label="linux（centos9）root密码忘记了，怎么重置或修改密码"><!--[--><!--]--> linux（centos9）root密码忘记了，怎么重置或修改密码 <!--[--><!--]--></a><!----></li><li><a href="/technology/deployment_operations/linux/vpn01.md" class="sidebar-item" aria-label="Ubuntu20.4 搭建vpn服务器"><!--[--><!--]--> Ubuntu20.4 搭建vpn服务器 <!--[--><!--]--></a><!----></li><li><a href="/technology/deployment_operations/linux/vpn02.md" class="sidebar-item" aria-label="Linux实现socks终端代理、全局代理"><!--[--><!--]--> Linux实现socks终端代理、全局代理 <!--[--><!--]--></a><!----></li><li><a href="/technology/deployment_operations/linux/vpn03.md" class="sidebar-item" aria-label="搭建 vpn 使用 x-ui 部署配置"><!--[--><!--]--> 搭建 vpn 使用 x-ui 部署配置 <!--[--><!--]--></a><!----></li><li><a href="/technology/deployment_operations/linux/linux001.md" class="sidebar-item" aria-label="yum及yum-config-manager命令详解"><!--[--><!--]--> yum及yum-config-manager命令详解 <!--[--><!--]--></a><!----></li><li><a href="/technology/deployment_operations/linux/linux002.md" class="sidebar-item" aria-label="dnf命令详解"><!--[--><!--]--> dnf命令详解 <!--[--><!--]--></a><!----></li><li><a href="/technology/deployment_operations/linux/linux003.md" class="sidebar-item" aria-label="linux 运行 AppImage 应用"><!--[--><!--]--> linux 运行 AppImage 应用 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item collapsible">Nginx工具 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/deployment_operations/nginx/nginx001.md" class="sidebar-item" aria-label="分布式中间件-Nginx"><!--[--><!--]--> 分布式中间件-Nginx <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item collapsible">Docker容器 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/deployment_operations/docker/docker01.md" class="sidebar-item" aria-label="微服务部署Docker"><!--[--><!--]--> 微服务部署Docker <!--[--><!--]--></a><!----></li><li><a href="/technology/deployment_operations/docker/docker02.md" class="sidebar-item" aria-label="Docker集群"><!--[--><!--]--> Docker集群 <!--[--><!--]--></a><!----></li><li><a href="/technology/deployment_operations/docker/docker03.md" class="sidebar-item" aria-label="微服务部署-k8s(一)"><!--[--><!--]--> 微服务部署-k8s(一) <!--[--><!--]--></a><!----></li><li><a href="/technology/deployment_operations/docker/docker04.md" class="sidebar-item" aria-label="微服务部署-k8s(二)-应用"><!--[--><!--]--> 微服务部署-k8s(二)-应用 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item collapsible">jenkins工具 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/deployment_operations/jenkins/jenkins001.md" class="sidebar-item" aria-label="Jenkins 安装部署"><!--[--><!--]--> Jenkins 安装部署 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item collapsible">frp 网络穿透工具 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/deployment_operations/frp/frp001.md" class="sidebar-item" aria-label="Frp网络穿透工具"><!--[--><!--]--> Frp网络穿透工具 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">产品设计与分析 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><p tabindex="0" class="sidebar-item collapsible">Axure原型工具 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/product_design_analysis/axure/axure_rp_10_001.md" class="sidebar-item" aria-label="axure原型设计工具"><!--[--><!--]--> axure原型设计工具 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">代码管理 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><p tabindex="0" class="sidebar-item collapsible">git工具 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/code_management/git/index.md" class="sidebar-item" aria-label="git 常用命令"><!--[--><!--]--> git 常用命令 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item collapsible">Markdown语法 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/code_management/markdown/index.md" class="sidebar-item" aria-label="Markdown使用手册"><!--[--><!--]--> Markdown使用手册 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">人工智能 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><p tabindex="0" class="sidebar-item collapsible">人工智能 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/artificial_intelligence/ai/ai0001.md" class="sidebar-item" aria-label="什么是人工智能"><!--[--><!--]--> 什么是人工智能 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">项目管理 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><p tabindex="0" class="sidebar-item collapsible">工作职责 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/project_management/project/management_0001.md" class="sidebar-item" aria-label="项目管理工作职责"><!--[--><!--]--> 项目管理工作职责 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h2 id="目录" tabindex="-1"><a class="header-anchor" href="#目录" aria-hidden="true">#</a> 目录</h2><nav class="table-of-contents"><ul><li><a aria-current="page" href="/technology/database_design_analysis/mongodb/mongodb001.html#目录" class="router-link-active router-link-exact-active">目录</a></li><li><a aria-current="page" href="/technology/database_design_analysis/mongodb/mongodb001.html#分布式中间件-mongodb" class="router-link-active router-link-exact-active">分布式中间件-MongoDB</a><ul><li><a aria-current="page" href="/technology/database_design_analysis/mongodb/mongodb001.html#什么mongodb" class="router-link-active router-link-exact-active">什么MongoDB</a></li><li><a aria-current="page" href="/technology/database_design_analysis/mongodb/mongodb001.html#什么是文档" class="router-link-active router-link-exact-active">什么是文档</a></li><li><a aria-current="page" href="/technology/database_design_analysis/mongodb/mongodb001.html#什么地方使用mongodb" class="router-link-active router-link-exact-active">什么地方使用MongoDB</a></li></ul></li><li><a aria-current="page" href="/technology/database_design_analysis/mongodb/mongodb001.html#微服务系统中系统中为什么要使用mongodb" class="router-link-active router-link-exact-active">微服务系统中系统中为什么要使用MongoDB</a><ul><li><a aria-current="page" href="/technology/database_design_analysis/mongodb/mongodb001.html#单体电商系统" class="router-link-active router-link-exact-active">单体电商系统</a></li><li><a aria-current="page" href="/technology/database_design_analysis/mongodb/mongodb001.html#电商微服务系统" class="router-link-active router-link-exact-active">电商微服务系统</a></li><li><a aria-current="page" href="/technology/database_design_analysis/mongodb/mongodb001.html#电商微服务系统-mongodb" class="router-link-active router-link-exact-active">电商微服务系统-MongoDB</a></li></ul></li><li><a aria-current="page" href="/technology/database_design_analysis/mongodb/mongodb001.html#微服务系统中如何落地mongodb" class="router-link-active router-link-exact-active">微服务系统中如何落地MongoDB</a><ul><li><a aria-current="page" href="/technology/database_design_analysis/mongodb/mongodb001.html#添加商品场景落地" class="router-link-active router-link-exact-active">添加商品场景落地</a></li><li><a aria-current="page" href="/technology/database_design_analysis/mongodb/mongodb001.html#添加商品数据原理" class="router-link-active router-link-exact-active">添加商品数据原理</a></li><li><a aria-current="page" href="/technology/database_design_analysis/mongodb/mongodb001.html#mongodb全局架构设计" class="router-link-active router-link-exact-active">MongoDB全局架构设计</a></li><li><a aria-current="page" href="/technology/database_design_analysis/mongodb/mongodb001.html#添加商品场景落地-情况1" class="router-link-active router-link-exact-active">添加商品场景落地-情况1</a></li><li><a aria-current="page" href="/technology/database_design_analysis/mongodb/mongodb001.html#查询商品场景落地" class="router-link-active router-link-exact-active">查询商品场景落地</a></li><li><a aria-current="page" href="/technology/database_design_analysis/mongodb/mongodb001.html#查询商品场景落地-情况1" class="router-link-active router-link-exact-active">查询商品场景落地-情况1</a></li><li><a aria-current="page" href="/technology/database_design_analysis/mongodb/mongodb001.html#查询商品落地场景-情况2" class="router-link-active router-link-exact-active">查询商品落地场景-情况2</a></li><li><a aria-current="page" href="/technology/database_design_analysis/mongodb/mongodb001.html#删除商品场景落地" class="router-link-active router-link-exact-active">删除商品场景落地</a></li><li><a aria-current="page" href="/technology/database_design_analysis/mongodb/mongodb001.html#修改商品场景落地" class="router-link-active router-link-exact-active">修改商品场景落地</a></li><li><a aria-current="page" href="/technology/database_design_analysis/mongodb/mongodb001.html#修改商品场景落地-情况1" class="router-link-active router-link-exact-active">修改商品场景落地-情况1</a></li><li><a aria-current="page" href="/technology/database_design_analysis/mongodb/mongodb001.html#修改商品场景落地-情况2" class="router-link-active router-link-exact-active">修改商品场景落地-情况2</a></li></ul></li><li><a aria-current="page" href="/technology/database_design_analysis/mongodb/mongodb001.html#mongodb复制集" class="router-link-active router-link-exact-active">MongoDB复制集</a><ul><li><a aria-current="page" href="/technology/database_design_analysis/mongodb/mongodb001.html#什么是复制集" class="router-link-active router-link-exact-active">什么是复制集</a></li><li><a aria-current="page" href="/technology/database_design_analysis/mongodb/mongodb001.html#微服务项目中如何落地mongodb复制集" class="router-link-active router-link-exact-active">微服务项目中如何落地MongoDB复制集？</a></li><li><a aria-current="page" href="/technology/database_design_analysis/mongodb/mongodb001.html#mongodb-复制集准备" class="router-link-active router-link-exact-active">MongoDB 复制集准备</a></li><li><a aria-current="page" href="/technology/database_design_analysis/mongodb/mongodb001.html#mongodb-复制集角色分配" class="router-link-active router-link-exact-active">MongoDB 复制集角色分配</a></li><li><a aria-current="page" href="/technology/database_design_analysis/mongodb/mongodb001.html#mongodb-复制集电商微服务项目连接" class="router-link-active router-link-exact-active">MongoDB 复制集电商微服务项目连接</a></li></ul></li><li><a aria-current="page" href="/technology/database_design_analysis/mongodb/mongodb001.html#mongodb分片" class="router-link-active router-link-exact-active">MongoDB分片</a><ul><li><a aria-current="page" href="/technology/database_design_analysis/mongodb/mongodb001.html#微服务项目中如何落地mongodb分片" class="router-link-active router-link-exact-active">微服务项目中如何落地MongoDB分片</a></li><li><a aria-current="page" href="/technology/database_design_analysis/mongodb/mongodb001.html#mongodb复制集compass连接" class="router-link-active router-link-exact-active">MongoDB复制集Compass连接</a></li><li><a aria-current="page" href="/technology/database_design_analysis/mongodb/mongodb001.html#mongodb复制集compass连接-1" class="router-link-active router-link-exact-active">MongoDB复制集Compass连接</a></li><li><a aria-current="page" href="/technology/database_design_analysis/mongodb/mongodb001.html#mongodb-config-server阶段准备" class="router-link-active router-link-exact-active">MongoDB Config Server阶段准备</a></li><li><a aria-current="page" href="/technology/database_design_analysis/mongodb/mongodb001.html#mongodb-config-server角色分配" class="router-link-active router-link-exact-active">MongoDB Config Server角色分配</a></li><li><a aria-current="page" href="/technology/database_design_analysis/mongodb/mongodb001.html#mongodb复制集compass连接-2" class="router-link-active router-link-exact-active">MongoDB复制集Compass连接</a></li><li><a aria-current="page" href="/technology/database_design_analysis/mongodb/mongodb001.html#mongodb-routers阶段准备" class="router-link-active router-link-exact-active">MongoDB Routers阶段准备</a></li><li><a aria-current="page" href="/technology/database_design_analysis/mongodb/mongodb001.html#mongodb复制集compass连接-3" class="router-link-active router-link-exact-active">MongoDB复制集Compass连接</a></li><li><a aria-current="page" href="/technology/database_design_analysis/mongodb/mongodb001.html#mongodb-复制集电商微服务项目连接-1" class="router-link-active router-link-exact-active">MongoDB 复制集电商微服务项目连接</a></li><li><a aria-current="page" href="/technology/database_design_analysis/mongodb/mongodb001.html#主要原因是-路由并没有注册" class="router-link-active router-link-exact-active">主要原因是，路由并没有注册</a></li></ul></li><li><a aria-current="page" href="/technology/database_design_analysis/mongodb/mongodb001.html#总结-分片集群" class="router-link-active router-link-exact-active">总结 分片集群</a><ul><li><a aria-current="page" href="/technology/database_design_analysis/mongodb/mongodb001.html#复制集和分片集群" class="router-link-active router-link-exact-active">复制集和分片集群</a></li></ul></li></ul></nav><h2 id="分布式中间件-mongodb" tabindex="-1"><a class="header-anchor" href="#分布式中间件-mongodb" aria-hidden="true">#</a> 分布式中间件-MongoDB</h2><h3 id="什么mongodb" tabindex="-1"><a class="header-anchor" href="#什么mongodb" aria-hidden="true">#</a> 什么MongoDB</h3><p>MongoDB是文档数据库，专门用来存储类似Json文档的数据库，</p><h3 id="什么是文档" tabindex="-1"><a class="header-anchor" href="#什么是文档" aria-hidden="true">#</a> 什么是文档</h3><p>json,xml,yaml这些都是文档。mongodb主要是用来存储什么文档呢，主要是存储Bson文档，Bson文档和json是类似的，不同在一于Bson文档主要是可以添加数据类型。</p><h3 id="什么地方使用mongodb" tabindex="-1"><a class="header-anchor" href="#什么地方使用mongodb" aria-hidden="true">#</a> 什么地方使用MongoDB</h3><p>MongoDB主要用在微服务系统中。</p><h2 id="微服务系统中系统中为什么要使用mongodb" tabindex="-1"><a class="header-anchor" href="#微服务系统中系统中为什么要使用mongodb" aria-hidden="true">#</a> 微服务系统中系统中为什么要使用MongoDB</h2><p>微服务系统有很多，包含电商微服务系统，包含OA微服务系统，以及其他不同微服务系统。主要通过电商微服务系统来进行举例说明为什么要使用MongoDB？先得到一个电商微服务系统。如何得到呢？电商微服务系统是由单体系统而来</p><h3 id="单体电商系统" tabindex="-1"><a class="header-anchor" href="#单体电商系统" aria-hidden="true">#</a> 单体电商系统</h3><p><img src="/images/mongodb/mongodb_0001image.png" alt="Alt text"></p><p>在单体电商系统中，我们主要看一个业务场景，查询商品业务场景。<br> 查询商品实现过程，客户端发起请求 ——&gt; 电商系统 ——&gt; 电商数据库。<br> 如果客户端有这样一个要求，查询订单的时候，需要查询出商品。如何实现这个规则要求呢？<br> 查询订单实现过程，客户端发起请求——&gt;电商系统——&gt;电商数据库——&gt;订单表和商品表进行关联。</p><p>当时，如果电商系统并发量，业务量，数据量全部上升之后，单体系统查询，添加、修改、删除性能会急剧下降。进一步甚至导致系统宕机（宕机也就是无法访问），如果系统出现了宕机问题，直接导致客户端无法访问。</p><p>在允许电商并发量、业务量、数据量同时上升的情况下，如何提升系统性能，防止系统宕机呢？<br> 方案：需要进行业务模块拆分<br> 结果：形成电商微服务系统</p><h3 id="电商微服务系统" tabindex="-1"><a class="header-anchor" href="#电商微服务系统" aria-hidden="true">#</a> 电商微服务系统</h3><p><img src="/images/mongodb/mongodb_0002image.png" alt="Alt text"></p><p>在微服务电商中，我们主要看一个业务场景，查询商品业务场景。</p><p>查询商品实现过程，客户端发起查询请求——&gt;电商系统——&gt;电商微服务——&gt;电商数据库。</p><p>如果客户端有这样一个要求，查询订单时候，需要查询出商品。如何实现个规则要求呢？<br> 查询订单实现过程，客户端发起请求——&gt;电商网站——&gt;订单微服务——&gt;电商数据库。<br> 电商网站——&gt;商品微服务——&gt;电商数据库。</p><p>一次订单查询需要涉及到2个微服务（订单微服务、商品微服务）查询。<br> 如果并发量比较大，会导致两个微服务查询性能下降。因为是同步请求，同步请求并发处理有限<br> 如果2个微服务其中一个微服务宕机了，会导致无法进行查询。</p><p>如何提升系统性能和防止系统宕机呢？<br> 方案： 使用MongoDB</p><h3 id="电商微服务系统-mongodb" tabindex="-1"><a class="header-anchor" href="#电商微服务系统-mongodb" aria-hidden="true">#</a> 电商微服务系统-MongoDB</h3><p><img src="/images/mongodb/mongodb_0003image.png" alt="Alt text"></p><p>在微服务电商系统中，我们主要看一个业务场景，查询商品业务场景。<br> 查询商品实现过程，客户端发起请求——&gt;电商系统——&gt;电商微服务——&gt;电商数据库。</p><p>如果客户端有这样一个要求，查询订单的时候，需要查询出商品。如何实现这个规则要求呢？ 查询订单实现过程，客户端发起请求——&gt;电商网站——&gt;MongoDB。</p><p>在MongoDB中可以一次性查询出订单商品信息数据。而且还可以提升性能</p><p>总结：这就是我们在电商系统中使用MongoDB原因<br> 1、先从单体电商系统分析<br> 2、然后再从电商微服务系统分析<br> 3、最后引入MongoDB<br> 4、由此得到微服务系统中为什么要使用MongoDB</p><h2 id="微服务系统中如何落地mongodb" tabindex="-1"><a class="header-anchor" href="#微服务系统中如何落地mongodb" aria-hidden="true">#</a> 微服务系统中如何落地MongoDB</h2><p>前提：<br> 1、电商微服务系统<br> 2、MongoDB<br> 3、MongoDB Compass<br> 步骤<br> 1、电商微服务系统准备<br> 通过vs创建.Net7 电商微服务系统 <img src="/images/mongodb/mongodb_0004image.png" alt="Alt text"><br> 2、MongoDB准备<br> 2.1 MongoDB 前提准备<br><a href="https://fastdl.mongodb.org/windows/mongodb-windows-x86_64-7.0.0-signed.msi" target="_blank" rel="noopener noreferrer">MongoDB下载地址<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>：https://fastdl.mongodb.org/windows/mongodb-windows-x86_64-7.0.0-signed.msi</p><pre><code>  MongoDB下载地址： https://www.mongodb.com/try/download/community  
  MongoDB安装：
</code></pre><p><img src="/images/mongodb/mongodb_0005image.png" alt="Alt text"></p><p>3、MongoDB Compass准备<br> 3.1 MongoDB Compass前提准备<br> ​ <a href="https://downloads.mongodb.com/compass/mongodb-compass-1.31.1-win32-x64.zip" target="_blank" rel="noopener noreferrer">MongoDB Compass下载地址1.31.1-win32-x64<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>：https://downloads.mongodb.com/compass/mongodb-compass-1.31.1-win32-x64.zip<br><a href="https://downloads.mongodb.com/compass/mongodb-compass-1.39.3-win32-x64.exe?_ga=2.86267800.1014844034.1693278031-905397172.1693277989" target="_blank" rel="noopener noreferrer">MongoDB Compass下载地址1.39.3-win32-x64<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>：https://downloads.mongodb.com/compass/mongodb-compass-1.39.3-win32-x64.exe<br><img src="/images/mongodb/mongodb_0006image.png" alt="Alt text"></p><pre><code>3.2 MongoDB Shell   
</code></pre><p><a href="https://downloads.mongodb.com/compass/mongosh-1.10.6-win32-x64.zip" target="_blank" rel="noopener noreferrer">MongoDB Shell 下载地址<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a><a href="https://blog.csdn.net/a6661314/article/details/128741072" target="_blank" rel="noopener noreferrer">Windows 环境下 MongoDB7.0 找不到 mongo.exe <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a><br><img src="/images/mongodb/mongodb_0007image.png" alt="Alt text"></p><h3 id="添加商品场景落地" tabindex="-1"><a class="header-anchor" href="#添加商品场景落地" aria-hidden="true">#</a> 添加商品场景落地</h3><p>条件<br> 1、电商微服务系统LKN.EBusiness<br> 2、MongoDB.Driver 3、客户端访问<br> 4、MongoDB Compass 步骤<br> 1、先进入到电商微服务系统LKN.EBusiness 1.1 在项目中通过nuget引入MongoDB.Driver <img src="/images/mongodb/mongodb_0008image.png" alt="Alt text"></p><p>1.2先在电商网站中创建ProductController类，在ProductController类中添加代码</p><div class="language-C# line-numbers-mode" data-ext="C#"><pre class="language-C#"><code>/// &lt;summary&gt;
 /// 商品控制器
 /// &lt;/summary&gt;
 [ApiController]
 [Route(&quot;Product&quot;)]
 public class ProductController : ControllerBase
 {
     private readonly IProductService _productService;

     public ProductController(IProductService productService)
     {
         _productService = productService;
     } 
     /// &lt;summary&gt;
     /// 添加商品
     /// &lt;/summary&gt;
     /// &lt;param name=&quot;product&quot;&gt;&lt;/param&gt;
     /// &lt;returns&gt;&lt;/returns&gt;
     [HttpPost]
     public ActionResult&lt;Product&gt; CreateProduct(Product product)
     {
         _productService.Create(product);
         return CreatedAtAction(&quot;GetProduct&quot;, new { id = product.Id }, product);
     }
 }

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>1.3、 然后在电商网站中创建ProductServer类，在ProductService类中添加代码</p><div class="language-C# line-numbers-mode" data-ext="C#"><pre class="language-C#"><code> /// &lt;summary&gt;
/// 商品服务实现
/// &lt;/summary&gt;
public class ProductService : IProductService
{
 private readonly IMongoCollection&lt;Product&gt; _products;

 public ProductService()
 {
     // 1、建立MongoDB连接
     var client = new MongoClient(&quot;mongodb://localhost:27017&quot;);
     // 2、获取商品库(自己创建商品数据)
     var database = client.GetDatabase(&quot;ProductDB&quot;);

     // 3、获取商品表(自己创建商品数)
     _products = database.GetCollection&lt;Product&gt;(&quot;Product&quot;);
  
 }

 public void Create(Product Product)
 {
     _products.InsertOne(Product);
 }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>1.4、然后启动电商网站实例一<br><img src="/images/mongodb/mongodb_0009image.png" alt="Alt text"></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>dotnet run 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote><p>2、MongoDB 准备</p><blockquote><p>2.1 先进入到MongoDB 中 <img src="/images/mongodb/mongodb_0010image.png" alt="Alt text"></p></blockquote></blockquote><blockquote><blockquote><p>2.2 然后打开MongoDB.cfg配置，在里面添加</p></blockquote></blockquote><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># mongod.conf</span>
<span class="token comment"># for documentation of all options, see:</span>
<span class="token comment">#   http://docs.mongodb.org/manual/reference/configuration-options/</span>

<span class="token comment"># Where and how to store data.</span>
storage:
dbPath: D:<span class="token punctuation">\</span>Program Files<span class="token punctuation">\</span>MongoDB<span class="token punctuation">\</span>Server<span class="token punctuation">\</span><span class="token number">7.0</span><span class="token punctuation">\</span>data

<span class="token comment"># where to write logging data.</span>
systemLog:
destination: <span class="token function">file</span>
logAppend: <span class="token boolean">true</span>
path:  D:<span class="token punctuation">\</span>Program Files<span class="token punctuation">\</span>MongoDB<span class="token punctuation">\</span>Server<span class="token punctuation">\</span><span class="token number">7.0</span><span class="token punctuation">\</span>log<span class="token punctuation">\</span>mongod.log

<span class="token comment"># network interfaces</span>
net:
port: <span class="token number">27017</span>
bindIp: <span class="token number">127.0</span>.0.1

<span class="token comment">#processManagement:</span>

<span class="token comment">#security:</span>

<span class="token comment">#operationProfiling:</span>

<span class="token comment">#replication:</span>

<span class="token comment">#sharding:</span>

<span class="token comment">## Enterprise-Only Options:</span>

<span class="token comment">#auditLog:</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><blockquote><p>2.3、然后启动MongoDB</p></blockquote></blockquote><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>mongod.exe <span class="token parameter variable">--config</span> <span class="token string">&quot;D:\Program Files\MongoDB\Server<span class="token entity" title="\7">\7</span>.0<span class="token entity" title="\b">\b</span>in\mongod.cfg&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="/images/mongodb/mongodb_0011image.png" alt="Alt text"></p><blockquote><p>3、客户端访问</p><blockquote><p>3.1 、进入到浏览器，添加商品<br><img src="/images/mongodb/mongodb_0012image.png" alt="Alt text"></p></blockquote></blockquote><blockquote><p>4、MongoDB Compass准备</p><blockquote><p>4.1 启动Compass</p></blockquote></blockquote><p><img src="/images/mongodb/mongodb_0013image.png" alt="Alt text"></p><blockquote><blockquote><p>4.2 登录Compass</p></blockquote></blockquote><p><img src="/images/mongodb/mongodb_0014image.png" alt="Alt text"></p><blockquote><blockquote><p>4.3查看 Compass <img src="/images/mongodb/mongodb_0015image.png" alt="Alt text"></p></blockquote></blockquote><h3 id="添加商品数据原理" tabindex="-1"><a class="header-anchor" href="#添加商品数据原理" aria-hidden="true">#</a> 添加商品数据原理</h3><h3 id="mongodb全局架构设计" tabindex="-1"><a class="header-anchor" href="#mongodb全局架构设计" aria-hidden="true">#</a> MongoDB全局架构设计</h3><p>高度模块化的设计是 MongoDB 的架构基础。在 MongoDB 中，除了少量的核心代码，其他一切皆为模块。</p><p>所有模块间是分层次、分类别的，MongoDB 官方共有五大类型的模块：核心模块、配置模块、事件模块、HTTP 模块、mail 模块、stream模块。它们之间的关系如下：</p><p><img src="/images/mongodb/mongodb_0016image.png" alt="Alt text"><br> 在5种模块中，配置模块和核心模块是与MongoDB框架密切相关的。而事件模块则是HTTP模块和Email模块的基础。HTTP模块和mail 模块的“地位”类似，它们都是更关心应用层面。<br> MongodDB Wiredtiger 架构设计<br> Wiredtiger 引擎写入原理</p><p><img src="/images/mongodb/mongodb_0017image.png" alt="Alt text"></p><p>第一件事情：把商品数据存储在缓存中<br> 第二件事情：缓存的数据同步到磁盘</p><h4 id="wiredtiger-数据防丢失败原理" tabindex="-1"><a class="header-anchor" href="#wiredtiger-数据防丢失败原理" aria-hidden="true">#</a> Wiredtiger 数据防丢失败原理</h4><p><img src="/images/mongodb/mongodb_0018image.png" alt="Alt text"></p><p>如上图，图中多一个 journaling buffer 和 journal 文件</p><ul><li>journaling buffer<br> 存放 mongodb 增删改指令的缓冲区</li><li>journal 文件<br> 类似于关系数据库中的事务日志<br> 引入 journaling 的目的是：<br> journaling 能够使 mongodb 数据库由于意外故障后快速恢复</li></ul><h5 id="wiredting-索引原理" tabindex="-1"><a class="header-anchor" href="#wiredting-索引原理" aria-hidden="true">#</a> wiredting 索引原理</h5><p><img src="/images/mongodb/mongodb_0019image.png" alt="Alt text"></p><p>MongoDB中的缓存和磁盘存储数据都是依靠B+树数据结构实现数据存储，root节点和Internal 节点存储索引数据，leaf 存储真实数据<br> 总结：MongoDB如何存储数据的原理<br> 1、MongoDB全局设计<br> 2、MongoDB 存储引擎 Wiredtger<br> 3、Wiredter 如何存取数据<br> 4、Wiredter 如何防止数据丢失<br> 5、Wiredter 数据面存储结构，主要使用的是B+树（索引和数据是分开的），如果是B树，那么就会存索引和数据类似于一本书的结构。以页为单位存储数据，和存储索引</p><h3 id="添加商品场景落地-情况1" tabindex="-1"><a class="header-anchor" href="#添加商品场景落地-情况1" aria-hidden="true">#</a> 添加商品场景落地-情况1</h3><p>情况1：当客户端通过电商微服务往MongoDB添加商品数据的时候，如果一个个添加，添加的效率比较低。如何解决添加商品添加效率低的问题？<br> 方案：批量添加</p><h4 id="如何落地批量添加" tabindex="-1"><a class="header-anchor" href="#如何落地批量添加" aria-hidden="true">#</a> 如何落地批量添加</h4><p>条件<br> 1、least_conn<br> 步骤<br> 1.1 先在电商网站中创建ProductController类，在ProductController类中添加代码</p><div class="language-C# line-numbers-mode" data-ext="C#"><pre class="language-C#"><code>/// &lt;summary&gt;
    /// 商品控制器
    /// &lt;/summary&gt;
    [ApiController]
    [Route(&quot;Product&quot;)]
    public class ProductController : ControllerBase
    {
        private readonly IProductService _productService;

        public ProductController(IProductService productService)
        {
            _productService = productService;
        } 
        /// &lt;summary&gt;
        /// 批量添加商品
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;product&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        [HttpPost(&quot;ProductList&quot;)]
        public ActionResult&lt;Product&gt; CreateProductList(Product[] Products)
        {
            _productService.CreateList(Products.ToList());
            return CreatedAtAction(&quot;GetProduct&quot;, Products);
        }
    }
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>1.2、然后在电商网站中创建ProductServer类，在ProductService类中添加代码</p><div class="language-C# line-numbers-mode" data-ext="C#"><pre class="language-C#"><code> /// &lt;summary&gt;
/// 商品服务实现
/// &lt;/summary&gt;
public class ProductService : IProductService
{
    private readonly IMongoCollection&lt;Product&gt; _products;

    public ProductService()
    {
        // 1、建立MongoDB连接
        var client = new MongoClient(&quot;mongodb://localhost:27017&quot;);
        // 2、获取商品库(自己创建商品数据)
        var database = client.GetDatabase(&quot;ProductDB&quot;);

        // 3、获取商品表(自己创建商品数)
        _products = database.GetCollection&lt;Product&gt;(&quot;Product&quot;);
     
    }

    public void CreateList(List&lt;Product&gt; Products)
        {
            _products.InsertMany(Products);
        }
 }
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><blockquote><p>1.3、客户端访问</p><blockquote><p>1、进入到浏览器，添加商品</p></blockquote></blockquote></blockquote><p><img src="/images/mongodb/mongodb_0020image.png" alt="Alt text"></p><h3 id="查询商品场景落地" tabindex="-1"><a class="header-anchor" href="#查询商品场景落地" aria-hidden="true">#</a> 查询商品场景落地</h3><p>分析： 当客户端通过电商微服务往MongoDB中添加商品数据时候，商品数据已经被成功添加到MongoDB中。如何通过MongoDB查询到商品数据呢？<br> 方案：查询商品</p><h4 id="如何落地查询商品" tabindex="-1"><a class="header-anchor" href="#如何落地查询商品" aria-hidden="true">#</a> 如何落地查询商品</h4><p>条件<br> 1、ip_hash<br> 步骤<br> 1.1 先在电商网站中创建ProductController 类 ，在ProductController类添加代码</p><div class="language-C# line-numbers-mode" data-ext="C#"><pre class="language-C#"><code>/// &lt;summary&gt;
    /// 商品控制器
    /// &lt;/summary&gt;
    [ApiController]
    [Route(&quot;Product&quot;)]
    public class ProductController : ControllerBase
    {
        private readonly IProductService _productService;

        public ProductController(IProductService productService)
        {
            _productService = productService;
        } 
        /// &lt;summary&gt;
        /// 商品单个商品
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;id&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        [HttpGet(&quot;{id}&quot;)]
        public ActionResult&lt;Product&gt; GetProduct(string id)
        {
            var product = _productService.GetProductById(id);

            if (product == null)
            {
                return NotFound();
            }

            return product;
        }
    }
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>1.2、然后在电商网站中创建ProductService类，在ProductService类中添加代码</p><div class="language-C# line-numbers-mode" data-ext="C#"><pre class="language-C#"><code> /// &lt;summary&gt;
/// 商品服务实现
/// &lt;/summary&gt;
public class ProductService : IProductService
{
    private readonly IMongoCollection&lt;Product&gt; _products;

    public ProductService()
    {
        // 1、建立MongoDB连接
        var client = new MongoClient(&quot;mongodb://localhost:27017&quot;);
        // 2、获取商品库(自己创建商品数据)
        var database = client.GetDatabase(&quot;ProductDB&quot;);

        // 3、获取商品表(自己创建商品数)
        _products = database.GetCollection&lt;Product&gt;(&quot;Product&quot;);
     
    }

   public Product GetProductById(string id)
        {
            return _products.Find&lt;Product&gt;(product =&gt; product.Id == id).FirstOrDefault();
        }
 }
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="查询商品场景落地-情况1" tabindex="-1"><a class="header-anchor" href="#查询商品场景落地-情况1" aria-hidden="true">#</a> 查询商品场景落地-情况1</h3><p>情况1：当客户端通过微服务往MongoDB中查询商品的时候，一个一个查询效率比较低，如何实现批量查询？<br> 方案： 批量查询</p><h5 id="如何实现批量查询呢" tabindex="-1"><a class="header-anchor" href="#如何实现批量查询呢" aria-hidden="true">#</a> 如何实现批量查询呢</h5><p>步骤<br> 1.1 先在电商网站中创建ProductController类，在ProductController类中添加代码</p><div class="language-C# line-numbers-mode" data-ext="C#"><pre class="language-C#"><code>/// &lt;summary&gt;
    /// 商品控制器
    /// &lt;/summary&gt;
    [ApiController]
    [Route(&quot;Product&quot;)]
    public class ProductController : ControllerBase
    {
        private readonly IProductService _productService;

        public ProductController(IProductService productService)
        {
            _productService = productService;
        } 
        /// &lt;summary&gt;
        /// 查询商品列表
        /// &lt;/summary&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        [HttpGet]
        public ActionResult&lt;IEnumerable&lt;Product&gt;&gt; GetProducts()
        {
            return _productService.GetProducts().ToList();
        }
    }
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>1.2、然后在电商网站中创建ProductService类，在ProduceService类中添加代码</p><div class="language-C# line-numbers-mode" data-ext="C#"><pre class="language-C#"><code> /// &lt;summary&gt;
/// 商品服务实现
/// &lt;/summary&gt;
public class ProductService : IProductService
{
    private readonly IMongoCollection&lt;Product&gt; _products;

    public ProductService()
    {
        // 1、建立MongoDB连接
        var client = new MongoClient(&quot;mongodb://localhost:27017&quot;);
        // 2、获取商品库(自己创建商品数据)
        var database = client.GetDatabase(&quot;ProductDB&quot;);

        // 3、获取商品表(自己创建商品数)
        _products = database.GetCollection&lt;Product&gt;(&quot;Product&quot;);
     
    }

   public IEnumerable&lt;Product&gt; GetProducts()
        {
            return _products.Find(product =&gt; true).ToList();
        }
 }
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="查询商品落地场景-情况2" tabindex="-1"><a class="header-anchor" href="#查询商品落地场景-情况2" aria-hidden="true">#</a> 查询商品落地场景-情况2</h3><p>情况2：当客户端通过电商微服务往MongoDB中查询商品的时候，批量查询很多数据，由于数据量过大，导致内存直接溢出。如何防止数据量过大，导致内存溢出的问题？ 方案：分页查询</p><p>如何落地分布查询呢</p><p>步骤</p><p>1.1 先在电商网站创建ProductController类，在ProductController类中添加代码</p><div class="language-C# line-numbers-mode" data-ext="C#"><pre class="language-C#"><code>/// &lt;summary&gt;
    /// 商品控制器
    /// &lt;/summary&gt;
    [ApiController]
    [Route(&quot;Product&quot;)]
    public class ProductController : ControllerBase
    {
        private readonly IProductService _productService;

        public ProductController(IProductService productService)
        {
            _productService = productService;
        } 
        /// &lt;summary&gt;
        /// 商品分页查询
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;Page&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;PageSize&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        [HttpGet(&quot;Page&quot;)]
        public ActionResult&lt;IEnumerable&lt;Product&gt;&gt; GetProductsByPage(int Page ,int PageSize)
        {
            return _productService.GetProductsByPage(Page, PageSize).ToList();
        }
    }
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>1.2 然后在电商网站中创建ProductService类，在ProductService类中添加代码</p><div class="language-C# line-numbers-mode" data-ext="C#"><pre class="language-C#"><code>/// &lt;summary&gt;
/// 商品服务实现
/// &lt;/summary&gt;
public class ProductService : IProductService
{
    private readonly IMongoCollection&lt;Product&gt; _products;

    public ProductService()
    {
        // 1、建立MongoDB连接
        var client = new MongoClient(&quot;mongodb://localhost:27017&quot;);
        // 2、获取商品库(自己创建商品数据)
        var database = client.GetDatabase(&quot;ProductDB&quot;);

        // 3、获取商品表(自己创建商品数)
        _products = database.GetCollection&lt;Product&gt;(&quot;Product&quot;);
     
    }

   /// &lt;summary&gt;
        /// 商品分页查询
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;id&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;Product&quot;&gt;&lt;/param&gt;
        public IEnumerable&lt;Product&gt; GetProductsByPage(int Page,int PageSize)
        {
            var skip = (Page - 1) * PageSize;
            return _products.Find(x =&gt; true).Skip(skip).Limit(PageSize).ToList();
        }
 }
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="删除商品场景落地" tabindex="-1"><a class="header-anchor" href="#删除商品场景落地" aria-hidden="true">#</a> 删除商品场景落地</h3><p>分析：当客户端通过电商微服务往MongoDB中添加商品的时候，数据量非常大，这个时候，客户端希望能够删除商品，如何删除商品？<br> 方案：删除商品</p><p>如何删除商品？</p><p>步骤<br> 1.1 先在电商网站中创建ProductControlles类，在ProductController类中添加</p><div class="language-C# line-numbers-mode" data-ext="C#"><pre class="language-C#"><code>/// &lt;summary&gt;
    /// 商品控制器
    /// &lt;/summary&gt;
    [ApiController]
    [Route(&quot;Product&quot;)]
    public class ProductController : ControllerBase
    {
        private readonly IProductService _productService;

        public ProductController(IProductService productService)
        {
            _productService = productService;
        } 
        
        /// &lt;summary&gt;
        /// 删除商品
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;product&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        [HttpDelete]
        public IActionResult DeletetProduct(Product product)
        {
            try
            {
                _productService.Delete(product);
            }
            catch (Exception)
            {
                throw;
            }

            return NoContent();
        }
    }
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>1.2 然后在电商网站中创建ProductService类，在ProductService类中添加代码</p><div class="language-C# line-numbers-mode" data-ext="C#"><pre class="language-C#"><code> /// &lt;summary&gt;
/// 商品服务实现
/// &lt;/summary&gt;
public class ProductService : IProductService
{
    private readonly IMongoCollection&lt;Product&gt; _products;

    public ProductService()
    {
        // 1、建立MongoDB连接
        var client = new MongoClient(&quot;mongodb://localhost:27017&quot;);
        // 2、获取商品库(自己创建商品数据)
        var database = client.GetDatabase(&quot;ProductDB&quot;);

        // 3、获取商品表(自己创建商品数)
        _products = database.GetCollection&lt;Product&gt;(&quot;Product&quot;);
     
    }

   public void Delete(Product Product)
        {
            _products.DeleteOne(product =&gt; product.Id == Product.Id);
        }
 }
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="修改商品场景落地" tabindex="-1"><a class="header-anchor" href="#修改商品场景落地" aria-hidden="true">#</a> 修改商品场景落地</h3><p>分析：当客户端通过微服务往MongoDB中添加商品的时候，商品添加错误，希望能够修改商品，这个时候，客户端希望能够修改商品，如何修改商品？<br> 方案： 修改商品</p><h5 id="如何修改商品" tabindex="-1"><a class="header-anchor" href="#如何修改商品" aria-hidden="true">#</a> 如何修改商品？</h5><p>步骤<br> 1.1 先在电商网站中创建ProductController类，在ProductController类中添加代码</p><div class="language-C# line-numbers-mode" data-ext="C#"><pre class="language-C#"><code>/// &lt;summary&gt;
    /// 商品控制器
    /// &lt;/summary&gt;
    [ApiController]
    [Route(&quot;Product&quot;)]
    public class ProductController : ControllerBase
    {
        private readonly IProductService _productService;

        public ProductController(IProductService productService)
        {
            _productService = productService;
        } 
        
        /// &lt;summary&gt;
        /// 修改商品
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;id&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;product&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        [HttpPut(&quot;{id}&quot;)]
        public IActionResult PutProduct(string id, Product product)
        {
            try
            {
                _productService.Update(id,product);
            }
            catch (Exception)
            {
                throw;
            }

            return NoContent();
        }
    }
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>1.2 然后在电商网站中创建ProductService类，在ProductService类中添加代码</p><div class="language-C# line-numbers-mode" data-ext="C#"><pre class="language-C#"><code> /// &lt;summary&gt;
/// 商品服务实现
/// &lt;/summary&gt;
public class ProductService : IProductService
{
    private readonly IMongoCollection&lt;Product&gt; _products;

    public ProductService()
    {
        // 1、建立MongoDB连接
        var client = new MongoClient(&quot;mongodb://localhost:27017&quot;);
        // 2、获取商品库(自己创建商品数据)
        var database = client.GetDatabase(&quot;ProductDB&quot;);

        // 3、获取商品表(自己创建商品数)
        _products = database.GetCollection&lt;Product&gt;(&quot;Product&quot;);
     
    }

   		/// &lt;summary&gt;
        /// 更新
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;id&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;Product&quot;&gt;&lt;/param&gt;
        public void Update(string id, Product Product)
        {
            var update = Builders&lt;Product&gt;.Update;
            _products.UpdateOne(product =&gt; product.Id == id, update.Set(&quot;ProductTitle&quot;, Product.ProductTitle));
        }
 }
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="修改商品场景落地-情况1" tabindex="-1"><a class="header-anchor" href="#修改商品场景落地-情况1" aria-hidden="true">#</a> 修改商品场景落地-情况1</h3><p>分析：当客户端通过电商微服务在MongoDB中修改商品的时候，只能修改一个文档的字段值，如果一个个修改文档的字段值，效率会比较低，导致修改效率下降，如何实现批量修改文档的字段值？<br> 方案：批量修改文档字段值</p><p>如何落地批量修改文档字段值？ 步骤<br> 1.1 先在电商网站中创建ProductController类，在ProductController类中添加代码</p><div class="language-C# line-numbers-mode" data-ext="C#"><pre class="language-C#"><code>/// &lt;summary&gt;
    /// 商品控制器
    /// &lt;/summary&gt;
    [ApiController]
    [Route(&quot;Product&quot;)]
    public class ProductController : ControllerBase
    {
        private readonly IProductService _productService;

        public ProductController(IProductService productService)
        {
            _productService = productService;
        } 
        
        /// &lt;summary&gt;
        /// 商品文档批量修改
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;id&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;product&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        [HttpPut(&quot;UpdateList&quot;)]
        public IActionResult PutProductList(string id, Product product)
        {
            try
            {
                _productService.UpdateList(id, product);
            }
            catch (Exception)
            {
                throw;
            }

            return NoContent();
        }
    }
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>​ 1.2、然后在电商网站中创建ProductService类，在ProductService类中添加代码</p><div class="language-C# line-numbers-mode" data-ext="C#"><pre class="language-C#"><code>/// &lt;summary&gt;
/// 商品服务实现
/// &lt;/summary&gt;
public class ProductService : IProductService
{
    private readonly IMongoCollection&lt;Product&gt; _products;

    public ProductService()
    {
        // 1、建立MongoDB连接
        var client = new MongoClient(&quot;mongodb://localhost:27017&quot;);
        // 2、获取商品库(自己创建商品数据)
        var database = client.GetDatabase(&quot;ProductDB&quot;);

        // 3、获取商品表(自己创建商品数)
        _products = database.GetCollection&lt;Product&gt;(&quot;Product&quot;);
     
    }

   		/// &lt;summary&gt;
        /// 批量更新
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;id&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;Product&quot;&gt;&lt;/param&gt;
        public void UpdateList(string id, Product Product)
        {
            var filter = Builders&lt;Product&gt;.Filter;
            var update = Builders&lt;Product&gt;.Update;
            _products.UpdateMany(product =&gt; product.ProductCode == Product.ProductCode, update.Set(&quot;ProductTitle&quot;, Product.ProductTitle));
        }
 }
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="修改商品场景落地-情况2" tabindex="-1"><a class="header-anchor" href="#修改商品场景落地-情况2" aria-hidden="true">#</a> 修改商品场景落地-情况2</h3><p>分析：当客户端通过电商微服务往MongoDB中添加商品的时候，商品添加错误，希望能够修改商品，这个时候，只能一个个修改字段值，当商品有了新的属性字段的时候，如何动态更新字段？</p><p>方案：动态增加商品字段</p><p>如何落地动态增加商品字段？<br> 步骤</p><p>1.1 先在电商网站中创建ProductController类，在ProductController类中添加代码</p><div class="language-C# line-numbers-mode" data-ext="C#"><pre class="language-C#"><code>/// &lt;summary&gt;
    /// 商品控制器
    /// &lt;/summary&gt;
    [ApiController]
    [Route(&quot;Product&quot;)]
    public class ProductController : ControllerBase
    {
        private readonly IProductService _productService;

        public ProductController(IProductService productService)
        {
            _productService = productService;
        } 
        
        /// &lt;summary&gt;
        /// 修改商品
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;id&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;product&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        [HttpPut(&quot;UpdateField&quot;)]
        public IActionResult PutFieldProduct(string id, ProductUpdateFiledDto productUpdateFiledDto)
        {
            try
            {
                _productService.UpdateFiled(id, productUpdateFiledDto);
            }
            catch (Exception)
            {
                throw;
            }

            return NoContent();
        }
    }
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>1.2、然后在电商网站中创建ProductService类，在ProductService类中添加代码</p><div class="language-C# line-numbers-mode" data-ext="C#"><pre class="language-C#"><code> /// &lt;summary&gt;
/// 商品服务实现
/// &lt;/summary&gt;
public class ProductService : IProductService
{
    private readonly IMongoCollection&lt;Product&gt; _products;

    public ProductService()
    {
        // 1、建立MongoDB连接
        var client = new MongoClient(&quot;mongodb://localhost:27017&quot;);
        // 2、获取商品库(自己创建商品数据)
        var database = client.GetDatabase(&quot;ProductDB&quot;);

        // 3、获取商品表(自己创建商品数)
        _products = database.GetCollection&lt;Product&gt;(&quot;Product&quot;);
     
    }

   		/// &lt;summary&gt;
        /// 更新字段(增加字段)
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;id&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;Product&quot;&gt;&lt;/param&gt;
        public void UpdateFiled(string id, ProductUpdateFiledDto productUpdateFiledDto)
        {
            var update = Builders&lt;Product&gt;.Update;
            _products.UpdateOne(product =&gt; product.Id == id, update.AddToSet(&quot;ProductTest&quot;, productUpdateFiledDto.ProductLike));
        }
 }
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>1.3 浏览器访问</p><p><img src="/images/mongodb/mongodb_0021image.png" alt="Alt text"></p><p>1.4 compass结果显示</p><p><img src="/images/mongodb/mongodb_0022image.png" alt="Alt text"></p><h2 id="mongodb复制集" tabindex="-1"><a class="header-anchor" href="#mongodb复制集" aria-hidden="true">#</a> MongoDB复制集</h2><p>分析：服务端被限制只能允许访问10个请求，那么就会限制请求数量进行访问，请求数进行访问，请求数可能来至于多个客户端，如果一个客户端都把请求数占用了。就会导致其他客户端无法进行请求，导致恶意攻击。<br> 方案： 客户端限流</p><h3 id="什么是复制集" tabindex="-1"><a class="header-anchor" href="#什么是复制集" aria-hidden="true">#</a> 什么是复制集</h3><p>一份数据复制成多份。如图所示</p><p><img src="/images/mongodb/mongodb_0023image.png" alt="Alt text"></p><p>项目中为什么要使用复制集<br> 微服务电商系统，如图所示</p><p><img src="/images/mongodb/mongodb_0024image.png" alt="Alt text"></p><p>当客户端通过电商网站人MongoDB中查询数据的时候，如果MongoDB宕机，就会导致整个系统不可用，如何保证MongoDB高可用呢？<br> 方案： MongoDB复制集<br> 微服务电商系统-MongoDB复制集，如图所示</p><p><img src="/images/mongodb/mongodb_0025image.png" alt="Alt text"></p><h3 id="微服务项目中如何落地mongodb复制集" tabindex="-1"><a class="header-anchor" href="#微服务项目中如何落地mongodb复制集" aria-hidden="true">#</a> 微服务项目中如何落地MongoDB复制集？</h3><p>MongoDB复制集集群概念</p><p><img src="/images/mongodb/mongodb_0026image.png" alt="Alt text"></p><h4 id="primary-主节点-负责接受客户端请求" tabindex="-1"><a class="header-anchor" href="#primary-主节点-负责接受客户端请求" aria-hidden="true">#</a> primary ： 主节点，负责接受客户端请求</h4><h4 id="secondary-从节点-负责从主节点复制数据" tabindex="-1"><a class="header-anchor" href="#secondary-从节点-负责从主节点复制数据" aria-hidden="true">#</a> secondary: 从节点，负责从主节点复制数据</h4><h3 id="mongodb-复制集准备" tabindex="-1"><a class="header-anchor" href="#mongodb-复制集准备" aria-hidden="true">#</a> MongoDB 复制集准备</h3><p>条件<br> 1、MongoDB(3个MongoDB实例) 2、电商微服务系统<br> 步骤<br> 1、在MongoDB 中创建3个配置文件</p><p><img src="/images/mongodb/mongodb_0027image.png" alt="Alt text"></p><p>1.2、在mongod-27018.cfg文件中，添加内容</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># mongod.conf</span>

<span class="token comment"># for documentation of all options, see:</span>
<span class="token comment">#   http://docs.mongodb.org/manual/reference/configuration-options/</span>

<span class="token comment"># Where and how to store data.</span>
storage:
  dbPath: D:<span class="token punctuation">\</span>Program Files<span class="token punctuation">\</span>MongoDB<span class="token punctuation">\</span>Server<span class="token punctuation">\</span><span class="token number">7.0</span><span class="token punctuation">\</span>ReplicaSet-data<span class="token punctuation">\</span>data-27018

<span class="token comment"># where to write logging data.</span>
systemLog:
  destination: <span class="token function">file</span>
  logAppend: <span class="token boolean">true</span>
  path:  D:<span class="token punctuation">\</span>Program Files<span class="token punctuation">\</span>MongoDB<span class="token punctuation">\</span>Server<span class="token punctuation">\</span><span class="token number">7.0</span><span class="token punctuation">\</span>ReplicaSet-log<span class="token punctuation">\</span>mongod-27018.log

<span class="token comment"># network interfaces</span>
net:
  port: <span class="token number">27018</span>
  bindIp: <span class="token number">127.0</span>.0.1


<span class="token comment">#processManagement:</span>

<span class="token comment">#security:</span>

<span class="token comment">#operationProfiling:</span>

replication:
  replSetName: rs0

<span class="token comment">#sharding:</span>

<span class="token comment">## Enterprise-Only Options:</span>

<span class="token comment">#auditLog:</span>


</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>​ 1.3、在mongod-27019.cfg文件中，添加内容</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># mongod.conf</span>

<span class="token comment"># for documentation of all options, see:</span>
<span class="token comment">#   http://docs.mongodb.org/manual/reference/configuration-options/</span>

<span class="token comment"># Where and how to store data.</span>
storage:
  dbPath: D:<span class="token punctuation">\</span>Program Files<span class="token punctuation">\</span>MongoDB<span class="token punctuation">\</span>Server<span class="token punctuation">\</span><span class="token number">7.0</span><span class="token punctuation">\</span>ReplicaSet-data<span class="token punctuation">\</span>data-27019

<span class="token comment"># where to write logging data.</span>
systemLog:
  destination: <span class="token function">file</span>
  logAppend: <span class="token boolean">true</span>
  path:  D:<span class="token punctuation">\</span>Program Files<span class="token punctuation">\</span>MongoDB<span class="token punctuation">\</span>Server<span class="token punctuation">\</span><span class="token number">7.0</span><span class="token punctuation">\</span>ReplicaSet-log<span class="token punctuation">\</span>mongod-27019.log

<span class="token comment"># network interfaces</span>
net:
  port: <span class="token number">27019</span>
  bindIp: <span class="token number">127.0</span>.0.1


<span class="token comment">#processManagement:</span>

<span class="token comment">#security:</span>

<span class="token comment">#operationProfiling:</span>

replication:
  replSetName: rs0

<span class="token comment">#sharding:</span>

<span class="token comment">## Enterprise-Only Options:</span>

<span class="token comment">#auditLog:</span>


</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>​ 1.4、在mongod-27020.cfg文件中，添加内容</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># mongod.conf</span>

<span class="token comment"># for documentation of all options, see:</span>
<span class="token comment">#   http://docs.mongodb.org/manual/reference/configuration-options/</span>

<span class="token comment"># Where and how to store data.</span>
storage:
  dbPath: D:<span class="token punctuation">\</span>Program Files<span class="token punctuation">\</span>MongoDB<span class="token punctuation">\</span>Server<span class="token punctuation">\</span><span class="token number">7.0</span><span class="token punctuation">\</span>ReplicaSet-data<span class="token punctuation">\</span>data-27020

<span class="token comment"># where to write logging data.</span>
systemLog:
  destination: <span class="token function">file</span>
  logAppend: <span class="token boolean">true</span>
  path:  D:<span class="token punctuation">\</span>Program Files<span class="token punctuation">\</span>MongoDB<span class="token punctuation">\</span>Server<span class="token punctuation">\</span><span class="token number">7.0</span><span class="token punctuation">\</span>ReplicaSet-log<span class="token punctuation">\</span>mongod-27020.log

<span class="token comment"># network interfaces</span>
net:
  port: <span class="token number">27020</span>
  bindIp: <span class="token number">127.0</span>.0.1


<span class="token comment">#processManagement:</span>

<span class="token comment">#security:</span>

<span class="token comment">#operationProfiling:</span>

replication:
  replSetName: rs0

<span class="token comment">#sharding:</span>

<span class="token comment">## Enterprise-Only Options:</span>

<span class="token comment">#auditLog:</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>2、在MongoDB 中创建三个数据目录</p><p><img src="/images/mongodb/mongodb_0028image.png" alt="Alt text"></p><p>3、在MongoDB 中创建日志目录</p><p><img src="/images/mongodb/mongodb_0029image.png" alt="Alt text"></p><p>4、MongoDB多个实例启动<br> 4.1 mongod-27018实例启动</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token operator">&gt;</span>mongod.exe <span class="token parameter variable">-f</span> <span class="token string">&quot;D:\Program Files\MongoDB\Server<span class="token entity" title="\7">\7</span>.0<span class="token entity" title="\b">\b</span>in\ReplicaSet\mongod-27018.cfg&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="/images/mongodb/mongodb_0030image.png" alt="Alt text"></p><p>4.2 mongod-27019实例启动</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>mongod.exe <span class="token parameter variable">-f</span> <span class="token string">&quot;D:\Program Files\MongoDB\Server<span class="token entity" title="\7">\7</span>.0<span class="token entity" title="\b">\b</span>in\ReplicaSet\mongod-27019.cfg&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="/images/mongodb/mongodb_0031image.png" alt="Alt text"><br> 4.3 mongod-27020 实例启动</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token operator">&gt;</span>mongod.exe <span class="token parameter variable">-f</span> ./ReplicaSet/mongod-27020.cfg
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="/images/mongodb/mongodb_0032image.png" alt="Alt text"></p><h3 id="mongodb-复制集角色分配" tabindex="-1"><a class="header-anchor" href="#mongodb-复制集角色分配" aria-hidden="true">#</a> MongoDB 复制集角色分配</h3><p>条件 1.mongosh.exe<br><a href="https://blog.csdn.net/a6661314/article/details/128741072" target="_blank" rel="noopener noreferrer">Windows 环境下 MongoDB7.0 找不到 mongo.exe <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a><br> 步骤<br> 1、primary节点初始化<br> 1.1 连接27018 节点 <code>mongosh.exe --host 127.0.0.1 --port 27018 </code></p><p><img src="/images/mongodb/mongodb_0033image.png" alt="Alt text"></p><p>1.2 初始化主节点 <code>rs.initiate()</code></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>  rs.initate<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="/images/mongodb/mongodb_0034image.png" alt="Alt text"></p><p>1.3、主节点状态查看 <code>rs.status()</code></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>rs.status<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="/images/mongodb/mongodb_0035image.png" alt="Alt text"></p><p>1.4 主节点中添加27019节点</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>rs.add<span class="token punctuation">(</span><span class="token string">&quot;127.0.0.1:27019&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="/images/mongodb/mongodb_0036image.png" alt="Alt text"></p><p>1.5、主节点中添加27020节点</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>rs.add<span class="token punctuation">(</span><span class="token string">&quot;127.0.0.1:27020&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="/images/mongodb/mongodb_0037image.png" alt="Alt text"></p><p>1.6查看节点状态</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>rs.status<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="/images/mongodb/mongodb_0038image.png" alt="Alt text"></p><p>MongoDB复制集 Compass 连接</p><p>compass 连接地址<br><code>mongodb://localhost:27018,localhost:27019,localhost:27020/?readPreference=primary&amp;appname=MongoDB%20Compass&amp;ssl=false</code></p><p><img src="/images/mongodb/mongodb_0039image.png" alt="Alt text"></p><h3 id="mongodb-复制集电商微服务项目连接" tabindex="-1"><a class="header-anchor" href="#mongodb-复制集电商微服务项目连接" aria-hidden="true">#</a> MongoDB 复制集电商微服务项目连接</h3><p><img src="/images/mongodb/mongodb_0040image.png" alt="Alt text"></p><h5 id="mongodb复制集缺陷" tabindex="-1"><a class="header-anchor" href="#mongodb复制集缺陷" aria-hidden="true">#</a> MongoDB复制集缺陷</h5><p>1、数据量过大，MongoDB所在的磁盘容量有限，无法存储海量数据<br> 2、高并发的写，一个MongoDB主节点并发处理能力有限，无法解决高并发写<br> 所以：需要使用MongoDB分片</p><h2 id="mongodb分片" tabindex="-1"><a class="header-anchor" href="#mongodb分片" aria-hidden="true">#</a> MongoDB分片</h2><p>MongoDB分片架构</p><p><img src="/images/mongodb/mongodb_0041image.png" alt="Alt text"></p><p>架构说明<br> 1、2套shard分片复制集群。作用：分片存储数据。6个实例地址<br> 2、Config Server 配置中心。作用：存储分片地址。3个实例地址<br> 3、Routers 路由。作用：连接客户端，实现数据如何分片。2个实例地址<br> 4、总共需要11实例地址。</p><h3 id="微服务项目中如何落地mongodb分片" tabindex="-1"><a class="header-anchor" href="#微服务项目中如何落地mongodb分片" aria-hidden="true">#</a> 微服务项目中如何落地MongoDB分片</h3><h4 id="mongodb-分片落地前提" tabindex="-1"><a class="header-anchor" href="#mongodb-分片落地前提" aria-hidden="true">#</a> MongoDB 分片落地前提</h4><p>条件<br> 1、Shard分片1 3个实例<br> 2、Shard分片2 3个实例 3、Config Server 3个实例 4、Router 2个实例</p><h5 id="mongodb分片1-阶段准备" tabindex="-1"><a class="header-anchor" href="#mongodb分片1-阶段准备" aria-hidden="true">#</a> MongoDB分片1 阶段准备</h5><p>步骤<br> 1、Shard 分片1准备<br> 1.1、先在MongoDB bin 目录中创建shards 文件夹</p><p><img src="/images/mongodb/mongodb_0042image.png" alt="Alt text"></p><p>1.2、在MongoDB中创建3个配置文件</p><p><img src="/images/mongodb/mongodb_0043image.png" alt="Alt text"></p><p>1.3、然后在mongod-27021.cfg文件中添加内容</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># mongod.conf</span>

<span class="token comment"># for documentation of all options, see:</span>
<span class="token comment">#   http://docs.mongodb.org/manual/reference/configuration-options/</span>

<span class="token comment"># Where and how to store data.</span>
storage:
  dbPath: D:<span class="token punctuation">\</span>Program Files<span class="token punctuation">\</span>MongoDB<span class="token punctuation">\</span>Server<span class="token punctuation">\</span><span class="token number">7.0</span><span class="token punctuation">\</span>shards-data<span class="token punctuation">\</span>shard-27021

<span class="token comment"># where to write logging data.</span>
systemLog:
  destination: <span class="token function">file</span>
  logAppend: <span class="token boolean">true</span>
  path:  D:<span class="token punctuation">\</span>Program Files<span class="token punctuation">\</span>MongoDB<span class="token punctuation">\</span>Server<span class="token punctuation">\</span><span class="token number">7.0</span><span class="token punctuation">\</span>shards-log<span class="token punctuation">\</span>mongod-27021.log

<span class="token comment"># network interfaces</span>
net:
  port: <span class="token number">27021</span>
  bindIp: <span class="token number">127.0</span>.0.1


<span class="token comment">#processManagement:</span>
     <span class="token comment">#mongodb使用的时区</span>
      <span class="token comment">#timeZoneInfo: /usr/share/zoneinfo</span>
     <span class="token comment"># 是否以后台驻留进程运行（true：是，false：否）</span>
      <span class="token comment">#fork: true</span>
<span class="token comment">#security:</span>

<span class="token comment">#operationProfiling:</span>

replication:
  replSetName: sharding1 

sharding:
  <span class="token comment"># 分片集群名称。统一管理的</span>
  clusterRole: shardsvr
<span class="token comment">## Enterprise-Only Options:</span>

<span class="token comment">#auditLog:</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>1.4 然后在mongod-27022.cfg文件中添加内容</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># mongod.conf</span>

<span class="token comment"># for documentation of all options, see:</span>
<span class="token comment">#   http://docs.mongodb.org/manual/reference/configuration-options/</span>

<span class="token comment"># Where and how to store data.</span>
storage:
  dbPath: D:<span class="token punctuation">\</span>Program Files<span class="token punctuation">\</span>MongoDB<span class="token punctuation">\</span>Server<span class="token punctuation">\</span><span class="token number">7.0</span><span class="token punctuation">\</span>shards-data<span class="token punctuation">\</span>shard-27022

<span class="token comment"># where to write logging data.</span>
systemLog:
  destination: <span class="token function">file</span>
  logAppend: <span class="token boolean">true</span>
  path:  D:<span class="token punctuation">\</span>Program Files<span class="token punctuation">\</span>MongoDB<span class="token punctuation">\</span>Server<span class="token punctuation">\</span><span class="token number">7.0</span><span class="token punctuation">\</span>shards-log<span class="token punctuation">\</span>mongod-27022.log

<span class="token comment"># network interfaces</span>
net:
  port: <span class="token number">27022</span>
  bindIp: <span class="token number">127.0</span>.0.1


<span class="token comment">#processManagement:</span>
     <span class="token comment">#mongodb使用的时区</span>
      <span class="token comment">#timeZoneInfo: /usr/share/zoneinfo</span>
     <span class="token comment"># 是否以后台驻留进程运行（true：是，false：否）</span>
      <span class="token comment">#fork: true</span>
<span class="token comment">#security:</span>

<span class="token comment">#operationProfiling:</span>

replication:
  replSetName: sharding1 

sharding:
  <span class="token comment"># 分片集群名称。统一管理的</span>
  clusterRole: shardsvr
<span class="token comment">## Enterprise-Only Options:</span>

<span class="token comment">#auditLog:</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>1.5、然后在mongod-27023.cfg文件中添加内容</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># mongod.conf</span>

<span class="token comment"># for documentation of all options, see:</span>
<span class="token comment">#   http://docs.mongodb.org/manual/reference/configuration-options/</span>

<span class="token comment"># Where and how to store data.</span>
storage:
  dbPath: D:<span class="token punctuation">\</span>Program Files<span class="token punctuation">\</span>MongoDB<span class="token punctuation">\</span>Server<span class="token punctuation">\</span><span class="token number">7.0</span><span class="token punctuation">\</span>shards-data<span class="token punctuation">\</span>shard-27023

<span class="token comment"># where to write logging data.</span>
systemLog:
  destination: <span class="token function">file</span>
  logAppend: <span class="token boolean">true</span>
  path:  D:<span class="token punctuation">\</span>Program Files<span class="token punctuation">\</span>MongoDB<span class="token punctuation">\</span>Server<span class="token punctuation">\</span><span class="token number">7.0</span><span class="token punctuation">\</span>shards-log<span class="token punctuation">\</span>mongod-27023.log

<span class="token comment"># network interfaces</span>
net:
  port: <span class="token number">27023</span>
  bindIp: <span class="token number">127.0</span>.0.1


<span class="token comment">#processManagement:</span>
     <span class="token comment">#mongodb使用的时区</span>
      <span class="token comment">#timeZoneInfo: /usr/share/zoneinfo</span>
     <span class="token comment"># 是否以后台驻留进程运行（true：是，false：否）</span>
      <span class="token comment">#fork: true</span>
<span class="token comment">#security:</span>

<span class="token comment">#operationProfiling:</span>

replication:
  replSetName: sharding1 

sharding:
  <span class="token comment"># 分片集群名称。统一管理的</span>
  clusterRole: shardsvr
<span class="token comment">## Enterprise-Only Options:</span>

<span class="token comment">#auditLog:</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>2、在MongoDB 分片1 中创建3个数据目录</p><p><img src="/images/mongodb/mongodb_0044image.png" alt="Alt text"></p><p>3、在MongoDB中创建日志目录</p><p><img src="/images/mongodb/mongodb_0045image.png" alt="Alt text"></p><blockquote><p>4、MongoDB 启动分片1 多个实例</p><blockquote><p>4.1 mongod-27021实例启动</p></blockquote></blockquote><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>D:<span class="token punctuation">\</span>Program Files<span class="token punctuation">\</span>MongoDB<span class="token punctuation">\</span>Server<span class="token punctuation">\</span><span class="token number">7.0</span><span class="token punctuation">\</span>bin<span class="token operator">&gt;</span>mongod.exe <span class="token parameter variable">--config</span> ./shards/mongod-27021.cfg
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="/images/mongodb/mongodb_0046image.png" alt="Alt text"></p><blockquote><blockquote><p>4.2 mongod-27022实例启动</p></blockquote></blockquote><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>D:<span class="token punctuation">\</span>Program Files<span class="token punctuation">\</span>MongoDB<span class="token punctuation">\</span>Server<span class="token punctuation">\</span><span class="token number">7.0</span><span class="token punctuation">\</span>bin<span class="token operator">&gt;</span>mongod.exe <span class="token parameter variable">--config</span> ./shards/mongod-27022.cfg
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="/images/mongodb/mongodb_0047image.png" alt="Alt text"></p><blockquote><blockquote><p>4.3 mongod-27023实例启动</p></blockquote></blockquote><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>D:<span class="token punctuation">\</span>Program Files<span class="token punctuation">\</span>MongoDB<span class="token punctuation">\</span>Server<span class="token punctuation">\</span><span class="token number">7.0</span><span class="token punctuation">\</span>bin<span class="token operator">&gt;</span>mongod.exe <span class="token parameter variable">--config</span> ./shards/mongod-27023.cfg
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="/images/mongodb/mongodb_0048image.png" alt="Alt text"></p><h4 id="mongodb-分片角色分配" tabindex="-1"><a class="header-anchor" href="#mongodb-分片角色分配" aria-hidden="true">#</a> MongoDB 分片角色分配</h4><p>条件<br> 1、 mongosh.exe 步骤<br> 1、primary 节点初始化<br> 1.1 连接27021 节点 <code>mongosh.exe --host 127.0.0.1 --port 27021</code></p><p><img src="/images/mongodb/mongodb_0049image.png" alt="Alt text"></p><p>1.2 初始化主节点<code>rs.initiate()</code></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>rs.initiate<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="/images/mongodb/mongodb_0050image.png" alt="Alt text"></p><p>1.3、查看主节点状态 <code>rs.status()</code></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>rs.status<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="/images/mongodb/mongodb_0051image.png" alt="Alt text"></p><p>1.4、主节点添加270022节点</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>rs.add<span class="token punctuation">(</span><span class="token string">&quot;127.0.0.1:27022&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="/images/mongodb/mongodb_0052image.png" alt="Alt text"></p><p>1.5、主节点中添加27023节点</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>rs.add<span class="token punctuation">(</span><span class="token string">&quot;127.0.0.1:27023&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="/images/mongodb/mongodb_0053image.png" alt="Alt text"></p><p>1.6、 查看节点状态</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>rs.status<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="/images/mongodb/mongodb_0054image.png" alt="Alt text"></p><h3 id="mongodb复制集compass连接" tabindex="-1"><a class="header-anchor" href="#mongodb复制集compass连接" aria-hidden="true">#</a> MongoDB复制集Compass连接</h3><h4 id="compass连接地址" tabindex="-1"><a class="header-anchor" href="#compass连接地址" aria-hidden="true">#</a> Compass连接地址</h4><p><code>mongodb://localhost:27021,localhost:27022,localhost:27023/?readPreference=primary&amp;appname=MongoDB%20Compass&amp;ssl=false</code></p><p><img src="/images/mongodb/mongodb_0055image.png" alt="Alt text"></p><h4 id="mongodb分片2阶段准备" tabindex="-1"><a class="header-anchor" href="#mongodb分片2阶段准备" aria-hidden="true">#</a> MongoDB分片2阶段准备</h4><p>步骤<br> 1、Shard 分片2准备<br> 1.1 先在MongoDB bin目录中创建shards文件夹</p><p><img src="/images/mongodb/mongodb_0042image.png" alt="Alt text"></p><p>1.2、在MongoDB中创建3个配置文件</p><p><img src="/images/mongodb/mongodb_0043image.png" alt="Alt text"></p><p>​ 1.3、然后在mongod-27031.cfg文件中添加内容</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># mongod.conf</span>

<span class="token comment"># for documentation of all options, see:</span>
<span class="token comment">#   http://docs.mongodb.org/manual/reference/configuration-options/</span>

<span class="token comment"># Where and how to store data.</span>
storage:
 dbPath: D:<span class="token punctuation">\</span>Program Files<span class="token punctuation">\</span>MongoDB<span class="token punctuation">\</span>Server<span class="token punctuation">\</span><span class="token number">7.0</span><span class="token punctuation">\</span>shards-data<span class="token punctuation">\</span>shard-27031

<span class="token comment"># where to write logging data.</span>
systemLog:
 destination: <span class="token function">file</span>
 logAppend: <span class="token boolean">true</span>
 path:  D:<span class="token punctuation">\</span>Program Files<span class="token punctuation">\</span>MongoDB<span class="token punctuation">\</span>Server<span class="token punctuation">\</span><span class="token number">7.0</span><span class="token punctuation">\</span>shards-log<span class="token punctuation">\</span>mongod-27031.log

<span class="token comment"># network interfaces</span>
net:
 port: <span class="token number">27031</span>
 bindIp: <span class="token number">127.0</span>.0.1


<span class="token comment">#processManagement:</span>
    <span class="token comment">#mongodb使用的时区</span>
     <span class="token comment">#timeZoneInfo: /usr/share/zoneinfo</span>
    <span class="token comment"># 是否以后台驻留进程运行（true：是，false：否）</span>
     <span class="token comment">#fork: true</span>
<span class="token comment">#security:</span>

<span class="token comment">#operationProfiling:</span>

replication:
 replSetName: sharding2 

sharding:
 <span class="token comment">#  分片集群中当前实例的角色（configsvr：配置中心实例，shardsvr：分片实例）</span>
 clusterRole: shardsvr
<span class="token comment">## Enterprise-Only Options:</span>

<span class="token comment">#auditLog:</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>​ 1.4、然后在mongod-27032.cfg文件中添加内容</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># mongod.conf</span>

<span class="token comment"># for documentation of all options, see:</span>
<span class="token comment">#   http://docs.mongodb.org/manual/reference/configuration-options/</span>

<span class="token comment"># Where and how to store data.</span>
storage:
 dbPath: D:<span class="token punctuation">\</span>Program Files<span class="token punctuation">\</span>MongoDB<span class="token punctuation">\</span>Server<span class="token punctuation">\</span><span class="token number">7.0</span><span class="token punctuation">\</span>shards-data<span class="token punctuation">\</span>shard-27032

<span class="token comment"># where to write logging data.</span>
systemLog:
 destination: <span class="token function">file</span>
 logAppend: <span class="token boolean">true</span>
 path:  D:<span class="token punctuation">\</span>Program Files<span class="token punctuation">\</span>MongoDB<span class="token punctuation">\</span>Server<span class="token punctuation">\</span><span class="token number">7.0</span><span class="token punctuation">\</span>shards-log<span class="token punctuation">\</span>mongod-27032.log

<span class="token comment"># network interfaces</span>
net:
 port: <span class="token number">27032</span>
 bindIp: <span class="token number">127.0</span>.0.1


<span class="token comment">#processManagement:</span>
    <span class="token comment">#mongodb使用的时区</span>
     <span class="token comment">#timeZoneInfo: /usr/share/zoneinfo</span>
    <span class="token comment"># 是否以后台驻留进程运行（true：是，false：否）</span>
     <span class="token comment">#fork: true</span>
<span class="token comment">#security:</span>

<span class="token comment">#operationProfiling:</span>

replication:
 replSetName: sharding2 

sharding:
 <span class="token comment">#  分片集群中当前实例的角色（configsvr：配置中心实例，shardsvr：分片实例）</span>
 clusterRole: shardsvr
<span class="token comment">## Enterprise-Only Options:</span>

<span class="token comment">#auditLog:</span>


</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>1.5、然后在mongod-27033.cfg文件中添加内容</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># mongod.conf</span>

<span class="token comment"># for documentation of all options, see:</span>
<span class="token comment">#   http://docs.mongodb.org/manual/reference/configuration-options/</span>

<span class="token comment"># Where and how to store data.</span>
storage:
 dbPath: D:<span class="token punctuation">\</span>Program Files<span class="token punctuation">\</span>MongoDB<span class="token punctuation">\</span>Server<span class="token punctuation">\</span><span class="token number">7.0</span><span class="token punctuation">\</span>shards-data<span class="token punctuation">\</span>shard-27033

<span class="token comment"># where to write logging data.</span>
systemLog:
 destination: <span class="token function">file</span>
 logAppend: <span class="token boolean">true</span>
 path:  D:<span class="token punctuation">\</span>Program Files<span class="token punctuation">\</span>MongoDB<span class="token punctuation">\</span>Server<span class="token punctuation">\</span><span class="token number">7.0</span><span class="token punctuation">\</span>shards-log<span class="token punctuation">\</span>mongod-27033.log

<span class="token comment"># network interfaces</span>
net:
 port: <span class="token number">27033</span>
 bindIp: <span class="token number">127.0</span>.0.1


<span class="token comment">#processManagement:</span>
    <span class="token comment">#mongodb使用的时区</span>
     <span class="token comment">#timeZoneInfo: /usr/share/zoneinfo</span>
    <span class="token comment"># 是否以后台驻留进程运行（true：是，false：否）</span>
     <span class="token comment">#fork: true</span>
<span class="token comment">#security:</span>

<span class="token comment">#operationProfiling:</span>

replication:
 replSetName: sharding2 

sharding:
 <span class="token comment">#  分片集群中当前实例的角色（configsvr：配置中心实例，shardsvr：分片实例）</span>
 clusterRole: shardsvr
<span class="token comment">## Enterprise-Only Options:</span>

<span class="token comment">#auditLog:</span>


</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>2、在MongoDB 分片2中创建3个数据目录</p><p><img src="/images/mongodb/mongodb_0056image.png" alt="Alt text"></p><p>3、在MongoDB中创建日志目录</p><p><img src="/images/mongodb/mongodb_0045image.png" alt="Alt text"></p><p>4、MongoDB分片2多实例启动 4.1、mongod-27031实例启动</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>    mongod.exe <span class="token parameter variable">-f</span> ./shards/mongod-27031.cfg
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="/images/mongodb/mongodb_0057image.png" alt="Alt text"></p><p>4.2、mongod-27032实例启动</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>    mongod.exe <span class="token parameter variable">-f</span> ./shards/mongod-27032.cfg
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="/images/mongodb/mongodb_0058image.png" alt="Alt text"></p><p>4.3、mongod-27033实例启动</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>mongod.exe <span class="token parameter variable">-f</span> ./shards/mongod-27033.cfg
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="/images/mongodb/mongodb_0057image.png" alt="Alt text"></p><h4 id="mongodb-分片角色分配-1" tabindex="-1"><a class="header-anchor" href="#mongodb-分片角色分配-1" aria-hidden="true">#</a> MongoDB 分片角色分配</h4><p>条件<br> 1、 mongosh.exe 步骤<br> 1、primary 节点初始化<br> 1.1 连接27031 节点 <code>mongosh.exe --host 127.0.0.1 --port 27031</code><br><img src="/images/mongodb/mongodb_0060image.png" alt="Alt text"></p><p>1.2 初始化主节点<code>rs.initiate()</code></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>rs.initiate<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="/images/mongodb/mongodb_0061image.png" alt="Alt text"></p><p>1.3、查看主节点状态 <code>rs.status()</code></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>rs.status<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="/images/mongodb/mongodb_0062image.png" alt="Alt text"></p><p>1.4、主节点添加270032节点</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>rs.add<span class="token punctuation">(</span><span class="token string">&quot;127.0.0.1:27032&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="/images/mongodb/mongodb_0063image.png" alt="Alt text"></p><p>1.5、主节点中添加27033节点</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>rs.add<span class="token punctuation">(</span><span class="token string">&quot;127.0.0.1:27033&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="/images/mongodb/mongodb_0064image.png" alt="Alt text"></p><p>1.6、 查看节点状态</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>rs.status<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="/images/mongodb/mongodb_0065image.png" alt="Alt text"></p><h3 id="mongodb复制集compass连接-1" tabindex="-1"><a class="header-anchor" href="#mongodb复制集compass连接-1" aria-hidden="true">#</a> MongoDB复制集Compass连接</h3><h4 id="compass连接地址-1" tabindex="-1"><a class="header-anchor" href="#compass连接地址-1" aria-hidden="true">#</a> Compass连接地址</h4><p><code>mongodb://localhost:27031,localhost:27032,localhost:27033/?readPreference=primary&amp;appname=MongoDB%20Compass&amp;ssl=false</code></p><p><img src="/images/mongodb/mongodb_0066image.png" alt="Alt text"></p><h3 id="mongodb-config-server阶段准备" tabindex="-1"><a class="header-anchor" href="#mongodb-config-server阶段准备" aria-hidden="true">#</a> MongoDB Config Server阶段准备</h3><p>步骤<br> 1、Config Server 准备<br> 1.1、先在MongoDB bin目录中创建shards文件夹</p><p><img src="/images/mongodb/mongodb_0067image.png" alt="Alt text"></p><p>1.2、在MongoDB中创建ConfigServer</p><p><img src="/images/mongodb/mongodb_0068image.png" alt="Alt text"></p><p>1.3、在MongoDB中创建3个配置文件</p><p><img src="/images/mongodb/mongodb_0069image.png" alt="Alt text"></p><p>1.4 然后在mongod-27010.cfg文件中添加内容</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token comment"># mongod.conf</span>

<span class="token comment"># for documentation of all options, see:</span>
<span class="token comment">#   http://docs.mongodb.org/manual/reference/configuration-options/</span>

<span class="token comment"># Where and how to store data.</span>
<span class="token key atrule">storage</span><span class="token punctuation">:</span>
  <span class="token key atrule">dbPath</span><span class="token punctuation">:</span> D<span class="token punctuation">:</span>\Program Files\MongoDB\Server\7.0\shards<span class="token punctuation">-</span>data\ConfigServer\configserver<span class="token punctuation">-</span><span class="token number">27010</span>

<span class="token comment"># where to write logging data.</span>
<span class="token key atrule">systemLog</span><span class="token punctuation">:</span>
  <span class="token key atrule">destination</span><span class="token punctuation">:</span> file
  <span class="token key atrule">logAppend</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
  <span class="token key atrule">path</span><span class="token punctuation">:</span>  D<span class="token punctuation">:</span>\Program Files\MongoDB\Server\7.0\shards<span class="token punctuation">-</span>log\ConfigServer\mongod<span class="token punctuation">-</span>27010.log

<span class="token comment"># network interfaces</span>
<span class="token key atrule">net</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">27010</span>
  <span class="token key atrule">bindIp</span><span class="token punctuation">:</span> 127.0.0.1


<span class="token comment">#processManagement:</span>
     <span class="token comment">#mongodb使用的时区</span>
      <span class="token comment">#timeZoneInfo: /usr/share/zoneinfo</span>
     <span class="token comment"># 是否以后台驻留进程运行（true：是，false：否）</span>
      <span class="token comment">#fork: true</span>
<span class="token comment">#security:</span>

<span class="token comment">#operationProfiling:</span>

<span class="token key atrule">replication</span><span class="token punctuation">:</span>
  <span class="token comment">#集群名称，如果不是同一个集群内的机器，请不要配置重复</span>
  <span class="token key atrule">replSetName</span><span class="token punctuation">:</span> confset 

<span class="token key atrule">sharding</span><span class="token punctuation">:</span>
  <span class="token comment"># 分片集群中当前实例的角色（configsvr：配置中心实例，shardsvr：分片实例）</span>
  <span class="token key atrule">clusterRole</span><span class="token punctuation">:</span> configsvr
<span class="token comment">## Enterprise-Only Options:</span>

<span class="token comment">#auditLog:</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>1.5 然后在mongod-27011.cfg文件中添加内容</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token comment"># mongod.conf</span>

<span class="token comment"># for documentation of all options, see:</span>
<span class="token comment">#   http://docs.mongodb.org/manual/reference/configuration-options/</span>

<span class="token comment"># Where and how to store data.</span>
<span class="token key atrule">storage</span><span class="token punctuation">:</span>
  <span class="token key atrule">dbPath</span><span class="token punctuation">:</span> D<span class="token punctuation">:</span>\Program Files\MongoDB\Server\7.0\shards<span class="token punctuation">-</span>data\ConfigServer\configserver<span class="token punctuation">-</span><span class="token number">27011</span>

<span class="token comment"># where to write logging data.</span>
<span class="token key atrule">systemLog</span><span class="token punctuation">:</span>
  <span class="token key atrule">destination</span><span class="token punctuation">:</span> file
  <span class="token key atrule">logAppend</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
  <span class="token key atrule">path</span><span class="token punctuation">:</span>  D<span class="token punctuation">:</span>\Program Files\MongoDB\Server\7.0\shards<span class="token punctuation">-</span>log\ConfigServer\mongod<span class="token punctuation">-</span>27011.log

<span class="token comment"># network interfaces</span>
<span class="token key atrule">net</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">27011</span>
  <span class="token key atrule">bindIp</span><span class="token punctuation">:</span> 127.0.0.1


<span class="token comment">#processManagement:</span>
     <span class="token comment">#mongodb使用的时区</span>
      <span class="token comment">#timeZoneInfo: /usr/share/zoneinfo</span>
     <span class="token comment"># 是否以后台驻留进程运行（true：是，false：否）</span>
      <span class="token comment">#fork: true</span>
<span class="token comment">#security:</span>

<span class="token comment">#operationProfiling:</span>

<span class="token key atrule">replication</span><span class="token punctuation">:</span>
  <span class="token comment">#集群名称，如果不是同一个集群内的机器，请不要配置重复</span>
  <span class="token key atrule">replSetName</span><span class="token punctuation">:</span> confset 

<span class="token key atrule">sharding</span><span class="token punctuation">:</span>
  <span class="token comment"># 分片集群中当前实例的角色（configsvr：配置中心实例，shardsvr：分片实例）</span>
  <span class="token key atrule">clusterRole</span><span class="token punctuation">:</span> configsvr
<span class="token comment">## Enterprise-Only Options:</span>

<span class="token comment">#auditLog:</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>1.6 然后在mongod-27012.cfg文件中添加内容</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token comment"># mongod.conf</span>

<span class="token comment"># for documentation of all options, see:</span>
<span class="token comment">#   http://docs.mongodb.org/manual/reference/configuration-options/</span>

<span class="token comment"># Where and how to store data.</span>
<span class="token key atrule">storage</span><span class="token punctuation">:</span>
  <span class="token key atrule">dbPath</span><span class="token punctuation">:</span> D<span class="token punctuation">:</span>\Program Files\MongoDB\Server\7.0\shards<span class="token punctuation">-</span>data\ConfigServer\configserver<span class="token punctuation">-</span><span class="token number">27012</span>

<span class="token comment"># where to write logging data.</span>
<span class="token key atrule">systemLog</span><span class="token punctuation">:</span>
  <span class="token key atrule">destination</span><span class="token punctuation">:</span> file
  <span class="token key atrule">logAppend</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
  <span class="token key atrule">path</span><span class="token punctuation">:</span>  D<span class="token punctuation">:</span>\Program Files\MongoDB\Server\7.0\shards<span class="token punctuation">-</span>log\ConfigServer\mongod<span class="token punctuation">-</span>27012.log

<span class="token comment"># network interfaces</span>
<span class="token key atrule">net</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">27012</span>
  <span class="token key atrule">bindIp</span><span class="token punctuation">:</span> 127.0.0.1


<span class="token comment">#processManagement:</span>
     <span class="token comment">#mongodb使用的时区</span>
      <span class="token comment">#timeZoneInfo: /usr/share/zoneinfo</span>
     <span class="token comment"># 是否以后台驻留进程运行（true：是，false：否）</span>
      <span class="token comment">#fork: true</span>
<span class="token comment">#security:</span>

<span class="token comment">#operationProfiling:</span>

<span class="token key atrule">replication</span><span class="token punctuation">:</span>
  <span class="token comment">#集群名称，如果不是同一个集群内的机器，请不要配置重复</span>
  <span class="token key atrule">replSetName</span><span class="token punctuation">:</span> confset 

<span class="token key atrule">sharding</span><span class="token punctuation">:</span>
  <span class="token comment"># 分片集群中当前实例的角色（configsvr：配置中心实例，shardsvr：分片实例）</span>
  <span class="token key atrule">clusterRole</span><span class="token punctuation">:</span> configsvr
<span class="token comment">## Enterprise-Only Options:</span>

<span class="token comment">#auditLog:</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>2、在MongoDB 分片2 中创建3个数据目录</p><p><img src="/images/mongodb/mongodb_0070image.png" alt="Alt text"></p><p>3、在MongoDB 中创建3个日志目录</p><p><img src="/images/mongodb/mongodb_0071image.png" alt="Alt text"></p><p>4、MongoDB Config Server 多个实例启动 4.1 、mongod-27010实例启动</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>D:<span class="token punctuation">\</span>Program Files<span class="token punctuation">\</span>MongoDB<span class="token punctuation">\</span>Server<span class="token punctuation">\</span><span class="token number">7.0</span><span class="token punctuation">\</span>bin<span class="token operator">&gt;</span>mongod.exe <span class="token parameter variable">-f</span> ./shards/ConfigServer/mongod-27010.cfg
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="/images/mongodb/mongodb_0072image.png" alt="Alt text"></p><p>4.2 、mongod-27011 实例启动</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>D:<span class="token punctuation">\</span>Program Files<span class="token punctuation">\</span>MongoDB<span class="token punctuation">\</span>Server<span class="token punctuation">\</span><span class="token number">7.0</span><span class="token punctuation">\</span>bin<span class="token operator">&gt;</span>mongod.exe <span class="token parameter variable">-f</span> ./shards/ConfigServer/mongod-27011.cfg
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="/images/mongodb/mongodb_0073image.png" alt="Alt text"></p><p>4.3、mongod-27012 实例启动</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>D:<span class="token punctuation">\</span>Program Files<span class="token punctuation">\</span>MongoDB<span class="token punctuation">\</span>Server<span class="token punctuation">\</span><span class="token number">7.0</span><span class="token punctuation">\</span>bin<span class="token operator">&gt;</span>mongod.exe <span class="token parameter variable">-f</span> ./shards/ConfigServer/mongod-27012.cfg
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="/images/mongodb/mongodb_0074image.png" alt="Alt text"></p><h3 id="mongodb-config-server角色分配" tabindex="-1"><a class="header-anchor" href="#mongodb-config-server角色分配" aria-hidden="true">#</a> MongoDB Config Server角色分配</h3><p>条件<br> 1、mongosh.exe 步骤</p><blockquote><p>1、primary节点初始化</p><blockquote><p>1.1、连接2710节点 <code>mongosh.exe --host 127.0.0.1 --port 27010</code></p></blockquote></blockquote><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>mongosh.exe <span class="token parameter variable">--host</span> <span class="token number">127.0</span>.0.1 <span class="token parameter variable">--port</span> <span class="token number">27010</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="/images/mongodb/mongodb_0075image.png" alt="Alt text"></p><blockquote><blockquote><p>1.2、初始化主节点</p></blockquote></blockquote><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>rs.initiate<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="/images/mongodb/mongodb_0076image.png" alt="Alt text"></p><blockquote><blockquote><p>1.3、主节点查看状态</p></blockquote></blockquote><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>rs.status<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="/images/mongodb/mongodb_0077image.png" alt="Alt text"></p><blockquote><blockquote><p>1.4、主节点添加27011节点</p></blockquote></blockquote><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>rs.add<span class="token punctuation">(</span><span class="token string">&quot;127.0.0.1:27011&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="/images/mongodb/mongodb_0078image.png" alt="Alt text"></p><blockquote><blockquote><p>1.5、主节点添加27012节点</p></blockquote></blockquote><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>rs.add<span class="token punctuation">(</span><span class="token string">&quot;127.0.0.1:27012&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="/images/mongodb/mongodb_0079image.png" alt="Alt text"></p><blockquote><blockquote><p>1.6、查看节点状态</p></blockquote></blockquote><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>rs.status<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="/images/mongodb/mongodb_0080image.png" alt="Alt text"></p><h3 id="mongodb复制集compass连接-2" tabindex="-1"><a class="header-anchor" href="#mongodb复制集compass连接-2" aria-hidden="true">#</a> MongoDB复制集Compass连接</h3><h4 id="compass连接地址-2" tabindex="-1"><a class="header-anchor" href="#compass连接地址-2" aria-hidden="true">#</a> Compass连接地址</h4><p><code>mongodb://localhost:27010,localhost:27011,localhost:27012/?readPreference=primary&amp;appname=MongoDB%20Compass&amp;ssl=false</code></p><p><img src="/images/mongodb/mongodb_0081image.png" alt="Alt text"></p><h3 id="mongodb-routers阶段准备" tabindex="-1"><a class="header-anchor" href="#mongodb-routers阶段准备" aria-hidden="true">#</a> MongoDB Routers阶段准备</h3><p>步骤<br> 1、Routers准备<br> 1.1、 先在MongoDB bin 目录中创建shards文件夹</p><p><img src="/images/mongodb/mongodb_0067image.png" alt="Alt text"></p><p>1.2、 在MongoDB shard中创建Routers</p><p><img src="/images/mongodb/mongodb_0082image.png" alt="Alt text"></p><p>1.3、 在MongoDB 中创建2个配置文件</p><p><img src="/images/mongodb/mongodb_0083image.png" alt="Alt text"></p><p>1.4、然后再mongod-27000.cfg文件中添加内容</p><div class="custom-container tip"><p class="custom-container-title">`sharding下的配置是 configDB`</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">..</span><span class="token punctuation">..</span>
sharding:
  <span class="token comment"># 配置中心地址，你有几台就配置几台</span>
  configDB: confset/127.0.0.1:27010,127.0.0.1:27011,127.0.0.1:27012
<span class="token comment">## Enterprise-Only Options:</span>
<span class="token punctuation">..</span><span class="token punctuation">..</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># mongod.conf</span>

<span class="token comment"># for documentation of all options, see:</span>
<span class="token comment">#   http://docs.mongodb.org/manual/reference/configuration-options/</span>

<span class="token comment"># Where and how to store data.</span>
<span class="token comment">#storage:</span>
 <span class="token comment"># dbPath: D:\Program Files\MongoDB\Server\7.0\shards-data\Router\Router-27000</span>

<span class="token comment"># where to write logging data.</span>
systemLog:
  destination: <span class="token function">file</span>
  logAppend: <span class="token boolean">true</span>
  path:  D:<span class="token punctuation">\</span>Program Files<span class="token punctuation">\</span>MongoDB<span class="token punctuation">\</span>Server<span class="token punctuation">\</span><span class="token number">7.0</span><span class="token punctuation">\</span>shards-log<span class="token punctuation">\</span>Router<span class="token punctuation">\</span>mongod-27000.log

<span class="token comment"># network interfaces</span>
net:
  port: <span class="token number">27000</span>
  bindIp: <span class="token number">127.0</span>.0.1


<span class="token comment">#processManagement:</span>
     <span class="token comment">#mongodb使用的时区</span>
      <span class="token comment">#timeZoneInfo: /usr/share/zoneinfo</span>
     <span class="token comment"># 是否以后台驻留进程运行（true：是，false：否）</span>
      <span class="token comment">#fork: true</span>
<span class="token comment">#security:</span>

<span class="token comment">#operationProfiling:</span>

<span class="token comment">#replication:</span>
  <span class="token comment">#集群名称，如果不是同一个集群内的机器，请不要配置重复</span>
 <span class="token comment"># replSetName: confset </span>

sharding:
  <span class="token comment"># 配置中心地址，你有几台就配置几台</span>
  configDB: confset/127.0.0.1:27010,127.0.0.1:27011,127.0.0.1:27012
<span class="token comment">## Enterprise-Only Options:</span>

<span class="token comment">#auditLog:</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>1.5、然后再mongod-27100.cfg文件中添加内容</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># mongod.conf</span>

<span class="token comment"># for documentation of all options, see:</span>
<span class="token comment">#   http://docs.mongodb.org/manual/reference/configuration-options/</span>

<span class="token comment"># Where and how to store data.</span>
<span class="token comment">#storage:</span>
<span class="token comment">#  dbPath: D:\Program Files\MongoDB\Server\7.0\shards-data\Router\Router-27100</span>

<span class="token comment"># where to write logging data.</span>
systemLog:
  destination: <span class="token function">file</span>
  logAppend: <span class="token boolean">true</span>
  path:  D:<span class="token punctuation">\</span>Program Files<span class="token punctuation">\</span>MongoDB<span class="token punctuation">\</span>Server<span class="token punctuation">\</span><span class="token number">7.0</span><span class="token punctuation">\</span>shards-log<span class="token punctuation">\</span>Router<span class="token punctuation">\</span>mongod-27100.log

<span class="token comment"># network interfaces</span>
net:
  port: <span class="token number">27100</span>
  bindIp: <span class="token number">127.0</span>.0.1


<span class="token comment">#processManagement:</span>
     <span class="token comment">#mongodb使用的时区</span>
      <span class="token comment">#timeZoneInfo: /usr/share/zoneinfo</span>
     <span class="token comment"># 是否以后台驻留进程运行（true：是，false：否）</span>
      <span class="token comment">#fork: true</span>
<span class="token comment">#security:</span>

<span class="token comment">#operationProfiling:</span>

<span class="token comment">#replication:</span>
  <span class="token comment">#集群名称，如果不是同一个集群内的机器，请不要配置重复</span>
 <span class="token comment"># replSetName: confset </span>

sharding:
  <span class="token comment"># 配置中心地址，你有几台就配置几台</span>
  configDB: confset/127.0.0.1:27010,127.0.0.1:27011,127.0.0.1:27012
<span class="token comment">## Enterprise-Only Options:</span>

<span class="token comment">#auditLog:</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>2、在MongoDB Router中创建1个日志目录</p><p><img src="/images/mongodb/mongodb_0085image.png" alt="Alt text"></p><p>3、MongoDB Routers 多实例启动</p><p><img src="/images/mongodb/mongodb_0086image.png" alt="Alt text"></p><p>3.1 mongod-27000实例启动</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>D:<span class="token punctuation">\</span>Program Files<span class="token punctuation">\</span>MongoDB<span class="token punctuation">\</span>Server<span class="token punctuation">\</span><span class="token number">7.0</span><span class="token punctuation">\</span>bin<span class="token operator">&gt;</span>mongos.exe <span class="token parameter variable">--config</span> ./shards/Router/mongod-27000.cfg
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="/images/mongodb/mongodb_0087image.png" alt="Alt text"></p><p>3.2 mongod-27100实例启动</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>D:<span class="token punctuation">\</span>Program Files<span class="token punctuation">\</span>MongoDB<span class="token punctuation">\</span>Server<span class="token punctuation">\</span><span class="token number">7.0</span><span class="token punctuation">\</span>bin<span class="token operator">&gt;</span>mongos.exe <span class="token parameter variable">--config</span> ./shards/Router/mongod-27100.cfg
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="/images/mongodb/mongodb_0088image.png" alt="Alt text"></p><h3 id="mongodb复制集compass连接-3" tabindex="-1"><a class="header-anchor" href="#mongodb复制集compass连接-3" aria-hidden="true">#</a> MongoDB复制集Compass连接</h3><h4 id="compass连接地址-3" tabindex="-1"><a class="header-anchor" href="#compass连接地址-3" aria-hidden="true">#</a> Compass连接地址</h4><p><code>mongodb://localhost:27000,localhost:27100/?readPreference=primary&amp;appname=MongoDB%20Compass&amp;ssl=false</code></p><p><img src="/images/mongodb/mongodb_0089image.png" alt="Alt text"></p><h3 id="mongodb-复制集电商微服务项目连接-1" tabindex="-1"><a class="header-anchor" href="#mongodb-复制集电商微服务项目连接-1" aria-hidden="true">#</a> MongoDB 复制集电商微服务项目连接</h3><p>报错： <img src="/images/mongodb/mongodb_0090image.png" alt="Alt text"></p><h3 id="主要原因是-路由并没有注册" tabindex="-1"><a class="header-anchor" href="#主要原因是-路由并没有注册" aria-hidden="true">#</a> 主要原因是，路由并没有注册</h3><p>1、需要使用 <code>mongosh.exe</code> 连接27000实例，之前已经做了分片，以及configServer 配置，现在只需要在路由的实例上注册即可。</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>mongosh.exe <span class="token parameter variable">--host</span> <span class="token number">127.0</span>.0.1 <span class="token parameter variable">--port</span> <span class="token number">27000</span>
sh.help<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="/images/mongodb/mongodb_0091image.png" alt="Alt text"></p><p>2、然后将分片27021，27021分别配置到路由</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment">#单个注册 </span>
<span class="token comment"># sh.addShard(&quot;127.0.0.1:27021&quot;);</span>
<span class="token comment">#以分片批量注册  sharding1 作为前缀 </span>
sh.addShard<span class="token punctuation">(</span><span class="token string">&quot;sharding1/127.0.0.1:27021,127.0.0.1:27022,127.0.0.1:27023&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="/images/mongodb/mongodb_0092image.png" alt="Alt text"></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment">#单个注册 </span>
<span class="token comment"># sh.addShard(&quot;127.0.0.1:27031&quot;);</span>
<span class="token comment">#以分片批量注册  sharding2 作为前缀 </span>
sh.addShard<span class="token punctuation">(</span><span class="token string">&quot;sharding1/127.0.0.1:27031,127.0.0.1:27032,127.0.0.1:27033&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="/images/mongodb/mongodb_0093image.png" alt="Alt text"></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>sh.status<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="/images/mongodb/mongodb_0094image.png" alt="Alt text"></p><h4 id="现在使用项目添加项目商品数据-发现分片集群-只有分片2有数据-分片1没有数据-默认分片规则为范围分片。" tabindex="-1"><a class="header-anchor" href="#现在使用项目添加项目商品数据-发现分片集群-只有分片2有数据-分片1没有数据-默认分片规则为范围分片。" aria-hidden="true">#</a> 现在使用项目添加项目商品数据，发现分片集群，只有分片2有数据，分片1没有数据，默认分片规则为范围分片。</h4><p>1、范围分片 <img src="/images/mongodb/mongodb_0095image.png" alt="Alt text"></p><p>2、Hashed分片 ，就是可以均分数据到两个分片当中。 2.1 执行分片命令</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code> sh.shardCollection<span class="token punctuation">(</span><span class="token string">&quot;ProductDb.Product&quot;</span>,<span class="token punctuation">{</span><span class="token string">&quot;ProductCode&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;hashed&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
MongoServerError: Please create an index that starts with the proposed shard key before <span class="token function">sh</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>报错：</p><p><img src="/images/mongodb/mongodb_0096image.png" alt="Alt text"> 2.2 解决报错，需要通过<code>mongosh.exe</code> 执行指令 创建新的数据库。</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>direct: mongos<span class="token punctuation">]</span> test<span class="token operator">&gt;</span> sh.enableSharding<span class="token punctuation">(</span><span class="token string">&quot;productshard&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="/images/mongodb/mongodb_0097image.png" alt="Alt text"></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>direct: mongos<span class="token punctuation">]</span> test<span class="token operator">&gt;</span> sh.shardCollection<span class="token punctuation">(</span><span class="token string">&quot;productshard.Product&quot;</span>,<span class="token punctuation">{</span><span class="token string">&quot;ProductCode&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;hashed&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="/images/mongodb/mongodb_0098image.png" alt="Alt text"></p><p>3、项目连接，在浏览器上添加商品数据 <img src="/images/mongodb/mongodb_0099image.png" alt="Alt text"></p><p>4、实现了hashed 分片 <img src="/images/mongodb/mongodb_00100image.png" alt="Alt text"></p><h2 id="总结-分片集群" tabindex="-1"><a class="header-anchor" href="#总结-分片集群" aria-hidden="true">#</a> 总结 分片集群</h2><p>1、11节点搭建分片集群<br> 2、分片键就是字段<br> 3、分片算法：hash 分片，范围分片<br> 4、 MongoDB 一个表只能一个分片键。<br> 5、MongoDB 创建一个范围分片键 如:分页分片场景</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>sh.enableSharding<span class="token punctuation">(</span><span class="token string">&quot;productshard_1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment"># key: 1 表示升序，-1表示 降序 </span>
sh.shardCollection<span class="token punctuation">(</span><span class="token string">&quot;productshard_1.Product&quot;</span>,<span class="token punctuation">{</span><span class="token string">&quot;ProductTitle&quot;</span>:1<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="复制集和分片集群" tabindex="-1"><a class="header-anchor" href="#复制集和分片集群" aria-hidden="true">#</a> 复制集和分片集群</h3><p>1、 索引</p></div><!--[--><!--]--></div><footer class="page-meta"><!----><!----><!----></footer><!----><!--[--><!--]--></main><!--]--></div><!----><!----><!--]--></div>
    <script type="module" src="/assets/app-c1c3c937.js" defer></script>
  </body>
</html>
