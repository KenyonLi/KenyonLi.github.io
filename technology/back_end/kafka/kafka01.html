<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.63">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" href="/images/logo_v.png"><meta name="keywords" content="kenyonli"><title>分布式中间件-消息中间件Kafka介绍（一） | Kenyon Li 随笔 </title><meta name="description" content="欢迎您，来到 Kenyon Li 世界！">
    <link rel="preload" href="/assets/style-d5da7002.css" as="style"><link rel="stylesheet" href="/assets/style-d5da7002.css">
    <link rel="modulepreload" href="/assets/app-c1c3c937.js"><link rel="modulepreload" href="/assets/kafka01.html-d0597fdb.js"><link rel="modulepreload" href="/assets/kafka01.html-d20844e4.js"><link rel="prefetch" href="/assets/index.html-0c5df828.js" as="script"><link rel="prefetch" href="/assets/index.html-122d66cc.js" as="script"><link rel="prefetch" href="/assets/index.html-1565d8e0.js" as="script"><link rel="prefetch" href="/assets/index.html-6eb9f9a2.js" as="script"><link rel="prefetch" href="/assets/lan_dao.html-f8b49934.js" as="script"><link rel="prefetch" href="/assets/mo_fei_din_lu.html-e84486e3.js" as="script"><link rel="prefetch" href="/assets/read01.html-3499d74d.js" as="script"><link rel="prefetch" href="/assets/yan_pi_juen.html-ebc74c11.js" as="script"><link rel="prefetch" href="/assets/object_oriented_analysis.html-c0b97768.js" as="script"><link rel="prefetch" href="/assets/design001.html-683e1b25.js" as="script"><link rel="prefetch" href="/assets/design002.html-d00aa6ad.js" as="script"><link rel="prefetch" href="/assets/design003.html-ac2e30f0.js" as="script"><link rel="prefetch" href="/assets/ea001.html-e8ab0da6.js" as="script"><link rel="prefetch" href="/assets/ai0001.html-fbb9c4b1.js" as="script"><link rel="prefetch" href="/assets/abp001.html-4d078b9b.js" as="script"><link rel="prefetch" href="/assets/abp002.html-361c1354.js" as="script"><link rel="prefetch" href="/assets/abp003.html-370e112b.js" as="script"><link rel="prefetch" href="/assets/abp004.html-2a550719.js" as="script"><link rel="prefetch" href="/assets/abp005.html-b7b8040d.js" as="script"><link rel="prefetch" href="/assets/abp006.html-afe3148a.js" as="script"><link rel="prefetch" href="/assets/abp007.html-c73814a2.js" as="script"><link rel="prefetch" href="/assets/abp008.html-3c920bb6.js" as="script"><link rel="prefetch" href="/assets/abp009.html-5aa18139.js" as="script"><link rel="prefetch" href="/assets/abp010.html-2f60cd08.js" as="script"><link rel="prefetch" href="/assets/abp011.html-144ed9f8.js" as="script"><link rel="prefetch" href="/assets/abp012.html-b0b755c1.js" as="script"><link rel="prefetch" href="/assets/abp013.html-07f9ef95.js" as="script"><link rel="prefetch" href="/assets/abp014.html-d9b342ae.js" as="script"><link rel="prefetch" href="/assets/abp015.html-2f03e87a.js" as="script"><link rel="prefetch" href="/assets/abp016.html-94352902.js" as="script"><link rel="prefetch" href="/assets/abpmicroservices0001.html-af71ea93.js" as="script"><link rel="prefetch" href="/assets/abpmicroservices0002.html-22ac1590.js" as="script"><link rel="prefetch" href="/assets/abpmicroservices0003.html-fe194269.js" as="script"><link rel="prefetch" href="/assets/abpmicroservices0004.html-c78a6bc2.js" as="script"><link rel="prefetch" href="/assets/abpmicroservices0005.html-658ff302.js" as="script"><link rel="prefetch" href="/assets/abpmicroservices0006.html-229b0517.js" as="script"><link rel="prefetch" href="/assets/abpmicroservices0007.html-943fd56b.js" as="script"><link rel="prefetch" href="/assets/abpmicroservices0008.html-c0fd71da.js" as="script"><link rel="prefetch" href="/assets/abpmicroservices0009.html-1a1fd836.js" as="script"><link rel="prefetch" href="/assets/abpmicroservices0010.html-8139592f.js" as="script"><link rel="prefetch" href="/assets/abpmicroservices0011.html-da7de1f7.js" as="script"><link rel="prefetch" href="/assets/abpmicroservices0012.html-cf03f10f.js" as="script"><link rel="prefetch" href="/assets/index.html-e99c2026.js" as="script"><link rel="prefetch" href="/assets/csharp01.html-08c0927b.js" as="script"><link rel="prefetch" href="/assets/dotnet01.html-9daf028e.js" as="script"><link rel="prefetch" href="/assets/dotnet02.html-6c7c2a0a.js" as="script"><link rel="prefetch" href="/assets/index.html-6379db3c.js" as="script"><link rel="prefetch" href="/assets/socket001.html-7e4e5d27.js" as="script"><link rel="prefetch" href="/assets/elasticsearch001.html-da1479cf.js" as="script"><link rel="prefetch" href="/assets/elasticsearch002.html-bb49ddf5.js" as="script"><link rel="prefetch" href="/assets/minio001.html-98035ebe.js" as="script"><link rel="prefetch" href="/assets/rabbitmq01.html-6d96f442.js" as="script"><link rel="prefetch" href="/assets/rabbitmq02.html-d7e85cf9.js" as="script"><link rel="prefetch" href="/assets/schedule_master001.html-4e11cba4.js" as="script"><link rel="prefetch" href="/assets/sharding_sphere_proxy001.html-3469aa09.js" as="script"><link rel="prefetch" href="/assets/tuning001.html-61d6ef57.js" as="script"><link rel="prefetch" href="/assets/tuning002.html-6628017a.js" as="script"><link rel="prefetch" href="/assets/tuning003.html-a5dde2f7.js" as="script"><link rel="prefetch" href="/assets/tuning004.html-054bc685.js" as="script"><link rel="prefetch" href="/assets/tuning005.html-f5259f7c.js" as="script"><link rel="prefetch" href="/assets/index.html-89e48f33.js" as="script"><link rel="prefetch" href="/assets/index.html-33fe1ab6.js" as="script"><link rel="prefetch" href="/assets/mongodb001.html-fc05ec9d.js" as="script"><link rel="prefetch" href="/assets/redis001.html-235bdc89.js" as="script"><link rel="prefetch" href="/assets/01mysql_info.html-a6b66b2f.js" as="script"><link rel="prefetch" href="/assets/02mysql_info.html-068822cb.js" as="script"><link rel="prefetch" href="/assets/03mysql_innoDB.html-506d1653.js" as="script"><link rel="prefetch" href="/assets/04mysql_info.html-790a1718.js" as="script"><link rel="prefetch" href="/assets/05InnoDB_lock.html-223ae1b5.js" as="script"><link rel="prefetch" href="/assets/06mysql_info.html-4b2d3f6a.js" as="script"><link rel="prefetch" href="/assets/07mysql_info.html-50ae10d4.js" as="script"><link rel="prefetch" href="/assets/08mysql_info.html-7601e865.js" as="script"><link rel="prefetch" href="/assets/09mysql_centos.html-43a9f4a0.js" as="script"><link rel="prefetch" href="/assets/10mysql_write_read.html-84b83419.js" as="script"><link rel="prefetch" href="/assets/index.html-106989a1.js" as="script"><link rel="prefetch" href="/assets/cdn001.html-1eda9371.js" as="script"><link rel="prefetch" href="/assets/dns001.html-d38b2d4f.js" as="script"><link rel="prefetch" href="/assets/docker01.html-c099819b.js" as="script"><link rel="prefetch" href="/assets/docker02.html-2fa931a0.js" as="script"><link rel="prefetch" href="/assets/docker03.html-feb12d1f.js" as="script"><link rel="prefetch" href="/assets/docker04.html-8213c817.js" as="script"><link rel="prefetch" href="/assets/frp001.html-86b24d68.js" as="script"><link rel="prefetch" href="/assets/jenkins001.html-d0fcb613.js" as="script"><link rel="prefetch" href="/assets/centos9_001.html-e73b097e.js" as="script"><link rel="prefetch" href="/assets/index.html-7a43a8bb.js" as="script"><link rel="prefetch" href="/assets/linux001.html-a464543d.js" as="script"><link rel="prefetch" href="/assets/linux002.html-58cf1ca5.js" as="script"><link rel="prefetch" href="/assets/linux003.html-51f3f2b1.js" as="script"><link rel="prefetch" href="/assets/linux004.html-23a1a9e7.js" as="script"><link rel="prefetch" href="/assets/vpn01.html-d411bec4.js" as="script"><link rel="prefetch" href="/assets/vpn02.html-9041f95f.js" as="script"><link rel="prefetch" href="/assets/vpn03.html-10bdbaeb.js" as="script"><link rel="prefetch" href="/assets/vpn04.html-c838e0a5.js" as="script"><link rel="prefetch" href="/assets/nginx001.html-e8ab8a03.js" as="script"><link rel="prefetch" href="/assets/nginx002.html-c594a14a.js" as="script"><link rel="prefetch" href="/assets/index.html-f213c134.js" as="script"><link rel="prefetch" href="/assets/index.html-d290a688.js" as="script"><link rel="prefetch" href="/assets/index.html-32bd2362.js" as="script"><link rel="prefetch" href="/assets/index.html-aae62809.js" as="script"><link rel="prefetch" href="/assets/axure_rp_10_001.html-337bca08.js" as="script"><link rel="prefetch" href="/assets/management_0001.html-8076a85d.js" as="script"><link rel="prefetch" href="/assets/404.html-60b35caa.js" as="script"><link rel="prefetch" href="/assets/index.html-1db2663f.js" as="script"><link rel="prefetch" href="/assets/index.html-e7f831f3.js" as="script"><link rel="prefetch" href="/assets/index.html-8b52f0d9.js" as="script"><link rel="prefetch" href="/assets/index.html-4648e07d.js" as="script"><link rel="prefetch" href="/assets/lan_dao.html-8a98ac78.js" as="script"><link rel="prefetch" href="/assets/mo_fei_din_lu.html-f5dc1ae7.js" as="script"><link rel="prefetch" href="/assets/read01.html-1687e123.js" as="script"><link rel="prefetch" href="/assets/yan_pi_juen.html-64856c47.js" as="script"><link rel="prefetch" href="/assets/object_oriented_analysis.html-1470ec02.js" as="script"><link rel="prefetch" href="/assets/design001.html-2dca36d3.js" as="script"><link rel="prefetch" href="/assets/design002.html-d7f05fa3.js" as="script"><link rel="prefetch" href="/assets/design003.html-d38fa6cb.js" as="script"><link rel="prefetch" href="/assets/ea001.html-a0d6ab52.js" as="script"><link rel="prefetch" href="/assets/ai0001.html-570f8bf2.js" as="script"><link rel="prefetch" href="/assets/abp001.html-e8e8c350.js" as="script"><link rel="prefetch" href="/assets/abp002.html-8b64116a.js" as="script"><link rel="prefetch" href="/assets/abp003.html-97dcc164.js" as="script"><link rel="prefetch" href="/assets/abp004.html-61336e39.js" as="script"><link rel="prefetch" href="/assets/abp005.html-c353f637.js" as="script"><link rel="prefetch" href="/assets/abp006.html-1440855d.js" as="script"><link rel="prefetch" href="/assets/abp007.html-ab8fed2b.js" as="script"><link rel="prefetch" href="/assets/abp008.html-6d348981.js" as="script"><link rel="prefetch" href="/assets/abp009.html-49dfe559.js" as="script"><link rel="prefetch" href="/assets/abp010.html-9c827b9c.js" as="script"><link rel="prefetch" href="/assets/abp011.html-3fb5d44f.js" as="script"><link rel="prefetch" href="/assets/abp012.html-97019b82.js" as="script"><link rel="prefetch" href="/assets/abp013.html-70d09ec2.js" as="script"><link rel="prefetch" href="/assets/abp014.html-df3b5c55.js" as="script"><link rel="prefetch" href="/assets/abp015.html-68bba06f.js" as="script"><link rel="prefetch" href="/assets/abp016.html-301af947.js" as="script"><link rel="prefetch" href="/assets/abpmicroservices0001.html-fb866520.js" as="script"><link rel="prefetch" href="/assets/abpmicroservices0002.html-aac60f40.js" as="script"><link rel="prefetch" href="/assets/abpmicroservices0003.html-72bb2608.js" as="script"><link rel="prefetch" href="/assets/abpmicroservices0004.html-0aa290ee.js" as="script"><link rel="prefetch" href="/assets/abpmicroservices0005.html-84e05aa9.js" as="script"><link rel="prefetch" href="/assets/abpmicroservices0006.html-4fda8e55.js" as="script"><link rel="prefetch" href="/assets/abpmicroservices0007.html-69b1b7dd.js" as="script"><link rel="prefetch" href="/assets/abpmicroservices0008.html-cf956168.js" as="script"><link rel="prefetch" href="/assets/abpmicroservices0009.html-9ac9702e.js" as="script"><link rel="prefetch" href="/assets/abpmicroservices0010.html-87af3317.js" as="script"><link rel="prefetch" href="/assets/abpmicroservices0011.html-3da615b7.js" as="script"><link rel="prefetch" href="/assets/abpmicroservices0012.html-e913010d.js" as="script"><link rel="prefetch" href="/assets/index.html-318c85d6.js" as="script"><link rel="prefetch" href="/assets/csharp01.html-2c14b5d2.js" as="script"><link rel="prefetch" href="/assets/dotnet01.html-01750e0b.js" as="script"><link rel="prefetch" href="/assets/dotnet02.html-8c224ecf.js" as="script"><link rel="prefetch" href="/assets/index.html-1916077d.js" as="script"><link rel="prefetch" href="/assets/socket001.html-ba30a642.js" as="script"><link rel="prefetch" href="/assets/elasticsearch001.html-7430deaa.js" as="script"><link rel="prefetch" href="/assets/elasticsearch002.html-c4327d81.js" as="script"><link rel="prefetch" href="/assets/minio001.html-e4e18988.js" as="script"><link rel="prefetch" href="/assets/rabbitmq01.html-94778e50.js" as="script"><link rel="prefetch" href="/assets/rabbitmq02.html-5d7ed981.js" as="script"><link rel="prefetch" href="/assets/schedule_master001.html-db33de28.js" as="script"><link rel="prefetch" href="/assets/sharding_sphere_proxy001.html-e178b1f2.js" as="script"><link rel="prefetch" href="/assets/tuning001.html-81ee10f0.js" as="script"><link rel="prefetch" href="/assets/tuning002.html-3915c089.js" as="script"><link rel="prefetch" href="/assets/tuning003.html-d28fbc5d.js" as="script"><link rel="prefetch" href="/assets/tuning004.html-45498f86.js" as="script"><link rel="prefetch" href="/assets/tuning005.html-53075a0a.js" as="script"><link rel="prefetch" href="/assets/index.html-83472dc7.js" as="script"><link rel="prefetch" href="/assets/index.html-2e07e830.js" as="script"><link rel="prefetch" href="/assets/mongodb001.html-ac44abd4.js" as="script"><link rel="prefetch" href="/assets/redis001.html-81baf7e4.js" as="script"><link rel="prefetch" href="/assets/01mysql_info.html-d7f1867f.js" as="script"><link rel="prefetch" href="/assets/02mysql_info.html-8fc8d63a.js" as="script"><link rel="prefetch" href="/assets/03mysql_innoDB.html-9c9af126.js" as="script"><link rel="prefetch" href="/assets/04mysql_info.html-4b3160ce.js" as="script"><link rel="prefetch" href="/assets/05InnoDB_lock.html-205ddc38.js" as="script"><link rel="prefetch" href="/assets/06mysql_info.html-76bb44c4.js" as="script"><link rel="prefetch" href="/assets/07mysql_info.html-e1071d89.js" as="script"><link rel="prefetch" href="/assets/08mysql_info.html-c24d3548.js" as="script"><link rel="prefetch" href="/assets/09mysql_centos.html-4826990b.js" as="script"><link rel="prefetch" href="/assets/10mysql_write_read.html-f8502a25.js" as="script"><link rel="prefetch" href="/assets/index.html-341ba3fa.js" as="script"><link rel="prefetch" href="/assets/cdn001.html-1e454cb6.js" as="script"><link rel="prefetch" href="/assets/dns001.html-2add38d8.js" as="script"><link rel="prefetch" href="/assets/docker01.html-748273dd.js" as="script"><link rel="prefetch" href="/assets/docker02.html-d1864030.js" as="script"><link rel="prefetch" href="/assets/docker03.html-b13fc535.js" as="script"><link rel="prefetch" href="/assets/docker04.html-4a38e8b5.js" as="script"><link rel="prefetch" href="/assets/frp001.html-92c57efc.js" as="script"><link rel="prefetch" href="/assets/jenkins001.html-c62bbaa1.js" as="script"><link rel="prefetch" href="/assets/centos9_001.html-186fb4f5.js" as="script"><link rel="prefetch" href="/assets/index.html-aed31d7b.js" as="script"><link rel="prefetch" href="/assets/linux001.html-99ea1dd0.js" as="script"><link rel="prefetch" href="/assets/linux002.html-2fbd42df.js" as="script"><link rel="prefetch" href="/assets/linux003.html-3c59ddc1.js" as="script"><link rel="prefetch" href="/assets/linux004.html-b7f6db9b.js" as="script"><link rel="prefetch" href="/assets/vpn01.html-42016abb.js" as="script"><link rel="prefetch" href="/assets/vpn02.html-2ae1a7b1.js" as="script"><link rel="prefetch" href="/assets/vpn03.html-66ddcbf5.js" as="script"><link rel="prefetch" href="/assets/vpn04.html-022cbbf6.js" as="script"><link rel="prefetch" href="/assets/nginx001.html-5dfd0aa1.js" as="script"><link rel="prefetch" href="/assets/nginx002.html-23a7ed3a.js" as="script"><link rel="prefetch" href="/assets/index.html-b3e0fb83.js" as="script"><link rel="prefetch" href="/assets/index.html-1142373e.js" as="script"><link rel="prefetch" href="/assets/index.html-06a86388.js" as="script"><link rel="prefetch" href="/assets/index.html-5ce4eeab.js" as="script"><link rel="prefetch" href="/assets/axure_rp_10_001.html-e60bbb12.js" as="script"><link rel="prefetch" href="/assets/management_0001.html-c805580e.js" as="script"><link rel="prefetch" href="/assets/404.html-e3ed7bad.js" as="script"><link rel="prefetch" href="/assets/index-e32a7948.js" as="script"><link rel="prefetch" href="/assets/mermaid.core-f21db64e.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><img class="logo" src="/images/home_logo_v.png" alt="Kenyon Li 随笔 "><span class="site-name can-hide">Kenyon Li 随笔 </span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/" class="" aria-label="首页"><!--[--><!--]--> 首页 <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="生活"><span class="title">生活</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="生活"><span class="title">生活</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/life/index.md" class="router-link-active" aria-label="生活之旅"><!--[--><!--]--> 生活之旅 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="技术"><span class="title">技术</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="技术"><span class="title">技术</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/technology/front_end/vue/index.md" class="router-link-active" aria-label="前端设计与技术"><!--[--><!--]--> 前端设计与技术 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/technology/back_end/csharp/csharp01.md" class="router-link-active" aria-label="后端设计与技术"><!--[--><!--]--> 后端设计与技术 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/technology/database_design_analysis/mysql/01mysql_info.md" class="router-link-active" aria-label="数据库设计与技术"><!--[--><!--]--> 数据库设计与技术 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/technology/architecture_design_analysis/enterprise_architect/ea001.md" class="router-link-active" aria-label="架构设计与分析"><!--[--><!--]--> 架构设计与分析 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/technology/deployment_operations/docker/docker01.md" class="router-link-active" aria-label="部署与运维技术"><!--[--><!--]--> 部署与运维技术 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/technology/product_design_analysis/axure_rp_10_001.md" class="router-link-active" aria-label="产品设计与分析"><!--[--><!--]--> 产品设计与分析 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/technology/code_management/git/index.md" class="router-link-active" aria-label="代码管理"><!--[--><!--]--> 代码管理 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/technology/artificial_intelligence/ai/ai0001.md" class="router-link-active" aria-label="人工智能"><!--[--><!--]--> 人工智能 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/technology/project_management/project_management_0001.md" class="router-link-active" aria-label="项目管理"><!--[--><!--]--> 项目管理 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="阅读"><span class="title">阅读</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="阅读"><span class="title">阅读</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/read/social_interaction/yan_pi_juen.md" class="router-link-active" aria-label="羊皮卷"><!--[--><!--]--> 羊皮卷 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/read/social_interaction/lan_dao.md" class="router-link-active" aria-label="狼道"><!--[--><!--]--> 狼道 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/read/social_interaction/mo_fei_din_lu.md" class="router-link-active" aria-label="墨菲定律"><!--[--><!--]--> 墨菲定律 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/read/social_interaction/read01.md" class="router-link-active" aria-label="什么反刍思维"><!--[--><!--]--> 什么反刍思维 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/read/technology/object_oriented_analysis.md" class="router-link-active" aria-label="面向对象分析与设计"><!--[--><!--]--> 面向对象分析与设计 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="收藏"><span class="title">收藏</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="收藏"><span class="title">收藏</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/collect/index.md" class="router-link-active" aria-label="浏览器书签"><!--[--><!--]--> 浏览器书签 <!--[--><!--]--></a></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" placeholder="搜索" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/" class="" aria-label="首页"><!--[--><!--]--> 首页 <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="生活"><span class="title">生活</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="生活"><span class="title">生活</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/life/index.md" class="router-link-active" aria-label="生活之旅"><!--[--><!--]--> 生活之旅 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="技术"><span class="title">技术</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="技术"><span class="title">技术</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/technology/front_end/vue/index.md" class="router-link-active" aria-label="前端设计与技术"><!--[--><!--]--> 前端设计与技术 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/technology/back_end/csharp/csharp01.md" class="router-link-active" aria-label="后端设计与技术"><!--[--><!--]--> 后端设计与技术 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/technology/database_design_analysis/mysql/01mysql_info.md" class="router-link-active" aria-label="数据库设计与技术"><!--[--><!--]--> 数据库设计与技术 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/technology/architecture_design_analysis/enterprise_architect/ea001.md" class="router-link-active" aria-label="架构设计与分析"><!--[--><!--]--> 架构设计与分析 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/technology/deployment_operations/docker/docker01.md" class="router-link-active" aria-label="部署与运维技术"><!--[--><!--]--> 部署与运维技术 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/technology/product_design_analysis/axure_rp_10_001.md" class="router-link-active" aria-label="产品设计与分析"><!--[--><!--]--> 产品设计与分析 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/technology/code_management/git/index.md" class="router-link-active" aria-label="代码管理"><!--[--><!--]--> 代码管理 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/technology/artificial_intelligence/ai/ai0001.md" class="router-link-active" aria-label="人工智能"><!--[--><!--]--> 人工智能 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/technology/project_management/project_management_0001.md" class="router-link-active" aria-label="项目管理"><!--[--><!--]--> 项目管理 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="阅读"><span class="title">阅读</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="阅读"><span class="title">阅读</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/read/social_interaction/yan_pi_juen.md" class="router-link-active" aria-label="羊皮卷"><!--[--><!--]--> 羊皮卷 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/read/social_interaction/lan_dao.md" class="router-link-active" aria-label="狼道"><!--[--><!--]--> 狼道 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/read/social_interaction/mo_fei_din_lu.md" class="router-link-active" aria-label="墨菲定律"><!--[--><!--]--> 墨菲定律 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/read/social_interaction/read01.md" class="router-link-active" aria-label="什么反刍思维"><!--[--><!--]--> 什么反刍思维 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/read/technology/object_oriented_analysis.md" class="router-link-active" aria-label="面向对象分析与设计"><!--[--><!--]--> 面向对象分析与设计 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="收藏"><span class="title">收藏</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="收藏"><span class="title">收藏</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/collect/index.md" class="router-link-active" aria-label="浏览器书签"><!--[--><!--]--> 浏览器书签 <!--[--><!--]--></a></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">前端设计与技术 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><p tabindex="0" class="sidebar-item collapsible">javasrcipt <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/front_end/javascript/index.md" class="sidebar-item" aria-label="js语法基础"><!--[--><!--]--> js语法基础 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item collapsible">H5语法 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/front_end/h5/index.md" class="sidebar-item" aria-label="H5语法基础"><!--[--><!--]--> H5语法基础 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item collapsible">CSS样式 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/front_end/css/index.md" class="sidebar-item" aria-label="CSS语法基础"><!--[--><!--]--> CSS语法基础 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item collapsible">Vue语法 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/front_end/vue/index.md" class="sidebar-item" aria-label="vue语法基础"><!--[--><!--]--> vue语法基础 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading active collapsible">后端设计与技术 <span class="down arrow"></span></p><ul style="" class="sidebar-item-children"><!--[--><li><p tabindex="0" class="sidebar-item collapsible">C#语法特性 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/back_end/csharp/csharp01.md" class="sidebar-item" aria-label="C#语法特性"><!--[--><!--]--> C#语法特性 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item collapsible">C/C++ <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/back_end/cppreference/index.md" class="sidebar-item" aria-label="c/c++"><!--[--><!--]--> c/c++ <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item collapsible">dotnet Core <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/back_end/dotnetcore/dotnet01.md" class="sidebar-item" aria-label="dotnet 安装 CLI/SDK"><!--[--><!--]--> dotnet 安装 CLI/SDK <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/dotnetcore/index.md" class="sidebar-item" aria-label="EFCore数据库迁移命令"><!--[--><!--]--> EFCore数据库迁移命令 <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/dotnetcore/socket001.md" class="sidebar-item" aria-label="Socket网络编程"><!--[--><!--]--> Socket网络编程 <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/dotnetcore/dotnet02.md" class="sidebar-item" aria-label="Net 后台代码模拟浏览器请求 Get、Post、Put的扩展方法"><!--[--><!--]--> Net 后台代码模拟浏览器请求 Get、Post、Put的扩展方法 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item collapsible">ABP vNnext <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/back_end/abp/abp001.md" class="sidebar-item" aria-label="ABP CLI"><!--[--><!--]--> ABP CLI <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/abp/abp002.md" class="sidebar-item" aria-label="ABP vNnext  核心根基模块化"><!--[--><!--]--> ABP vNnext  核心根基模块化 <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/abp/abp003.md" class="sidebar-item" aria-label="ABP核心项目-电商项目(一)-落地实战"><!--[--><!--]--> ABP核心项目-电商项目(一)-落地实战 <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/abp/abp004.md" class="sidebar-item" aria-label="ABP核心项目-电商项目落地实战(二)-领域层优化"><!--[--><!--]--> ABP核心项目-电商项目落地实战(二)-领域层优化 <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/abp/abp005.md" class="sidebar-item" aria-label="ABP核心项目-电商项目落地实战(三)-仓储、服务层优化"><!--[--><!--]--> ABP核心项目-电商项目落地实战(三)-仓储、服务层优化 <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/abp/abp006.md" class="sidebar-item" aria-label="ABP核心项目-电商项目落地实战(四)-应用、web层优化、原理"><!--[--><!--]--> ABP核心项目-电商项目落地实战(四)-应用、web层优化、原理 <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/abp/abp007.md" class="sidebar-item" aria-label="ABP核心项目-电商项目(五)-动态c#API客户端模块"><!--[--><!--]--> ABP核心项目-电商项目(五)-动态c#API客户端模块 <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/abp/abp008.md" class="sidebar-item" aria-label="ABP核心项目-电商项目(六)-用户组件-用户身份模块"><!--[--><!--]--> ABP核心项目-电商项目(六)-用户组件-用户身份模块 <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/abp/abp009.md" class="sidebar-item" aria-label="ABP核心项目-电商项目(七)-用户组件-账户模块"><!--[--><!--]--> ABP核心项目-电商项目(七)-用户组件-账户模块 <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/abp/abp010.md" class="sidebar-item" aria-label="ABP核心项目-电商项目(八)-用户组件-权限模块"><!--[--><!--]--> ABP核心项目-电商项目(八)-用户组件-权限模块 <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/abp/abp011.md" class="sidebar-item" aria-label="ABP核心项目-电商项目(九)-用户组件-多租户模块"><!--[--><!--]--> ABP核心项目-电商项目(九)-用户组件-多租户模块 <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/abp/abp012.md" class="sidebar-item" aria-label="ABP核心项目-电商项目(十)-疑问记录"><!--[--><!--]--> ABP核心项目-电商项目(十)-疑问记录 <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/abp/abp013.md" class="sidebar-item" aria-label="ABP核心项目-电商项目(十一)-设置模块"><!--[--><!--]--> ABP核心项目-电商项目(十一)-设置模块 <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/abp/abp014.md" class="sidebar-item" aria-label="ABP核心项目-电商项目(十二)-特征模块"><!--[--><!--]--> ABP核心项目-电商项目(十二)-特征模块 <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/abp/abp015.md" class="sidebar-item" aria-label="ABP核心项目-电商项目(十三)-异常/认证/本地化模块"><!--[--><!--]--> ABP核心项目-电商项目(十三)-异常/认证/本地化模块 <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/abp/abp016.md" class="sidebar-item" aria-label="ABP核心项目-电商项目(十四)-虚拟文件系统"><!--[--><!--]--> ABP核心项目-电商项目(十四)-虚拟文件系统 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item collapsible">Apb微服务项目 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/back_end/abpmicroservices/abpmicroservices0001.md" class="sidebar-item" aria-label="微服务电商项目落地"><!--[--><!--]--> 微服务电商项目落地 <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/abpmicroservices/abpmicroservices0002.md" class="sidebar-item" aria-label="微服务通信"><!--[--><!--]--> 微服务通信 <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/abpmicroservices/abpmicroservices0003.md" class="sidebar-item" aria-label="微服务网关-Ocelot"><!--[--><!--]--> 微服务网关-Ocelot <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/abpmicroservices/abpmicroservices0004.md" class="sidebar-item" aria-label="微服务注册中心-Consul"><!--[--><!--]--> 微服务注册中心-Consul <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/abpmicroservices/abpmicroservices0005.md" class="sidebar-item" aria-label="微服务注配置中心-Nacos"><!--[--><!--]--> 微服务注配置中心-Nacos <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/abpmicroservices/abpmicroservices0006.md" class="sidebar-item" aria-label="微服务事件总线-CAP"><!--[--><!--]--> 微服务事件总线-CAP <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/abpmicroservices/abpmicroservices0007.md" class="sidebar-item" aria-label="微服务链路监控-skywalking"><!--[--><!--]--> 微服务链路监控-skywalking <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/abpmicroservices/abpmicroservices0008.md" class="sidebar-item" aria-label="微服务日志中心"><!--[--><!--]--> 微服务日志中心 <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/abpmicroservices/abpmicroservices0009.md" class="sidebar-item" aria-label="微服务分布式事务"><!--[--><!--]--> 微服务分布式事务 <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/abpmicroservices/abpmicroservices0010.md" class="sidebar-item" aria-label="微服务分布式权限"><!--[--><!--]--> 微服务分布式权限 <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/abpmicroservices/abpmicroservices0011.md" class="sidebar-item" aria-label="微服务分布式文件系统、分布式缓存、分布式锁"><!--[--><!--]--> 微服务分布式文件系统、分布式缓存、分布式锁 <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/abpmicroservices/abpmicroservices0012.md" class="sidebar-item" aria-label="微服务大数据库MongoDB、任务调度Hangfire"><!--[--><!--]--> 微服务大数据库MongoDB、任务调度Hangfire <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item collapsible">分布式消息中间件-RabbitMQ <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/back_end/rabbitmq/rabbitmq01.md" class="sidebar-item" aria-label="RabbitMQ简介（一）"><!--[--><!--]--> RabbitMQ简介（一） <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/rabbitmq/rabbitmq02.md" class="sidebar-item" aria-label="RabbitMQ（二）"><!--[--><!--]--> RabbitMQ（二） <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item active collapsible">分布式消息中间件-Kafka <span class="down arrow"></span></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/technology/back_end/kafka/kafka01.md" class="sidebar-item active" aria-label="Kafka介绍（一）"><!--[--><!--]--> Kafka介绍（一） <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item collapsible">分布式中间件-ShardingSphere-Proxy <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/back_end/sharding_sphere_proxy/sharding_sphere_proxy001.md" class="sidebar-item" aria-label="分布式中间件-ShardingSphere-Proxy"><!--[--><!--]--> 分布式中间件-ShardingSphere-Proxy <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item collapsible">分布式中间件-ElasticSearch <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/back_end/elasticsearch/elasticsearch001.md" class="sidebar-item" aria-label="ElasticSearch"><!--[--><!--]--> ElasticSearch <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/elasticsearch/elasticsearch002.md" class="sidebar-item" aria-label="ElasticSearch-分词器"><!--[--><!--]--> ElasticSearch-分词器 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item collapsible">分布式中间件-Minio <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/back_end/minio/minio001.md" class="sidebar-item" aria-label="Minio"><!--[--><!--]--> Minio <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item collapsible">分布式任务调度中间件-ScheduleMaster <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/back_end/schedule_master/schedule_master001.md" class="sidebar-item" aria-label="分布式任务调度中间件-ScheduleMaster"><!--[--><!--]--> 分布式任务调度中间件-ScheduleMaster <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item collapsible">性能调优 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/back_end/tuning/tuning001.md" class="sidebar-item" aria-label="DNS调优"><!--[--><!--]--> DNS调优 <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/tuning/tuning002.md" class="sidebar-item" aria-label="CDN调优"><!--[--><!--]--> CDN调优 <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/tuning/tuning003.md" class="sidebar-item" aria-label="Nginx调优"><!--[--><!--]--> Nginx调优 <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/tuning/tuning004.md" class="sidebar-item" aria-label="WebAPI调优"><!--[--><!--]--> WebAPI调优 <!--[--><!--]--></a><!----></li><li><a href="/technology/back_end/tuning/tuning005.md" class="sidebar-item" aria-label="EFCore调优"><!--[--><!--]--> EFCore调优 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">数据库设计与技术 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><p tabindex="0" class="sidebar-item collapsible">MySql数据库 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/database_design_analysis/mysql/index.md" class="sidebar-item" aria-label="Mysql8.0 Ubuntu 20.4 安装"><!--[--><!--]--> Mysql8.0 Ubuntu 20.4 安装 <!--[--><!--]--></a><!----></li><li><a href="/technology/database_design_analysis/mysql/09mysql_centos.md" class="sidebar-item" aria-label="Mysql8.0 CentOS Stream 9 安装"><!--[--><!--]--> Mysql8.0 CentOS Stream 9 安装 <!--[--><!--]--></a><!----></li><li><a href="/technology/database_design_analysis/mysql/10mysql_write_read.md" class="sidebar-item" aria-label="Mysql 8.0 主从部署-读写分离"><!--[--><!--]--> Mysql 8.0 主从部署-读写分离 <!--[--><!--]--></a><!----></li><li><a href="/technology/database_design_analysis/mysql/01mysql_info.md" class="sidebar-item" aria-label="Mysql 架构体系详解"><!--[--><!--]--> Mysql 架构体系详解 <!--[--><!--]--></a><!----></li><li><a href="/technology/database_design_analysis/mysql/02mysql_info.md" class="sidebar-item" aria-label="InnoDB架构详解、事务介绍"><!--[--><!--]--> InnoDB架构详解、事务介绍 <!--[--><!--]--></a><!----></li><li><a href="/technology/database_design_analysis/mysql/03mysql_innoDB.md" class="sidebar-item" aria-label="InnoDB事务"><!--[--><!--]--> InnoDB事务 <!--[--><!--]--></a><!----></li><li><a href="/technology/database_design_analysis/mysql/04mysql_info.md" class="sidebar-item" aria-label="InnoDB索引"><!--[--><!--]--> InnoDB索引 <!--[--><!--]--></a><!----></li><li><a href="/technology/database_design_analysis/mysql/05InnoDB_lock.md" class="sidebar-item" aria-label="Mysql InnoDB锁"><!--[--><!--]--> Mysql InnoDB锁 <!--[--><!--]--></a><!----></li><li><a href="/technology/database_design_analysis/mysql/06mysql_info.md" class="sidebar-item" aria-label="Mysql 性能优化"><!--[--><!--]--> Mysql 性能优化 <!--[--><!--]--></a><!----></li><li><a href="/technology/database_design_analysis/mysql/07mysql_info.md" class="sidebar-item" aria-label="MySQL分库分表"><!--[--><!--]--> MySQL分库分表 <!--[--><!--]--></a><!----></li><li><a href="/technology/database_design_analysis/mysql/08mysql_info.md" class="sidebar-item" aria-label="MySQL集群篇"><!--[--><!--]--> MySQL集群篇 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item collapsible">MongoDB数据库 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/database_design_analysis/mongodb/mongodb001.md" class="sidebar-item" aria-label="分布式中间件-MongoDB"><!--[--><!--]--> 分布式中间件-MongoDB <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item collapsible">Redis数据库 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/database_design_analysis/redis/redis001.md" class="sidebar-item" aria-label="分布式中间件-Redis"><!--[--><!--]--> 分布式中间件-Redis <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">架构设计与分析 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><p tabindex="0" class="sidebar-item collapsible">设计模式 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/architecture_design_analysis/design/design001.md" class="sidebar-item" aria-label="工厂、抽象工厂、策略模式"><!--[--><!--]--> 工厂、抽象工厂、策略模式 <!--[--><!--]--></a><!----></li><li><a href="/technology/architecture_design_analysis/design/design002.md" class="sidebar-item" aria-label="设计模式-应用场景和优缺点"><!--[--><!--]--> 设计模式-应用场景和优缺点 <!--[--><!--]--></a><!----></li><li><a href="/technology/architecture_design_analysis/design/design003.md" class="sidebar-item" aria-label="存储高可用"><!--[--><!--]--> 存储高可用 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item collapsible">EA工具 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/architecture_design_analysis/enterprise_architect/ea001.md" class="sidebar-item" aria-label="UML、类图、顺序图 "><!--[--><!--]--> UML、类图、顺序图  <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">部署与运维技术 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><p tabindex="0" class="sidebar-item collapsible">linux系统 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/deployment_operations/linux/index.md" class="sidebar-item" aria-label="linux基础"><!--[--><!--]--> linux基础 <!--[--><!--]--></a><!----></li><li><a href="/technology/deployment_operations/linux/centos9_001.md" class="sidebar-item" aria-label="linux（centos9）root密码忘记了，怎么重置或修改密码"><!--[--><!--]--> linux（centos9）root密码忘记了，怎么重置或修改密码 <!--[--><!--]--></a><!----></li><li><a href="/technology/deployment_operations/linux/vpn01.md" class="sidebar-item" aria-label="Ubuntu20.4 搭建vpn服务器"><!--[--><!--]--> Ubuntu20.4 搭建vpn服务器 <!--[--><!--]--></a><!----></li><li><a href="/technology/deployment_operations/linux/vpn02.md" class="sidebar-item" aria-label="Linux实现socks终端代理、全局代理"><!--[--><!--]--> Linux实现socks终端代理、全局代理 <!--[--><!--]--></a><!----></li><li><a href="/technology/deployment_operations/linux/vpn03.md" class="sidebar-item" aria-label="搭建 vpn 使用 x-ui 部署配置"><!--[--><!--]--> 搭建 vpn 使用 x-ui 部署配置 <!--[--><!--]--></a><!----></li><li><a href="/technology/deployment_operations/linux/linux001.md" class="sidebar-item" aria-label="yum及yum-config-manager命令详解"><!--[--><!--]--> yum及yum-config-manager命令详解 <!--[--><!--]--></a><!----></li><li><a href="/technology/deployment_operations/linux/linux002.md" class="sidebar-item" aria-label="dnf命令详解"><!--[--><!--]--> dnf命令详解 <!--[--><!--]--></a><!----></li><li><a href="/technology/deployment_operations/linux/linux003.md" class="sidebar-item" aria-label="linux 运行 AppImage 应用"><!--[--><!--]--> linux 运行 AppImage 应用 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item collapsible">Nginx工具 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/deployment_operations/nginx/nginx001.md" class="sidebar-item" aria-label="分布式中间件-Nginx"><!--[--><!--]--> 分布式中间件-Nginx <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item collapsible">Docker容器 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/deployment_operations/docker/docker01.md" class="sidebar-item" aria-label="微服务部署Docker"><!--[--><!--]--> 微服务部署Docker <!--[--><!--]--></a><!----></li><li><a href="/technology/deployment_operations/docker/docker02.md" class="sidebar-item" aria-label="Docker集群"><!--[--><!--]--> Docker集群 <!--[--><!--]--></a><!----></li><li><a href="/technology/deployment_operations/docker/docker03.md" class="sidebar-item" aria-label="微服务部署-k8s(一)"><!--[--><!--]--> 微服务部署-k8s(一) <!--[--><!--]--></a><!----></li><li><a href="/technology/deployment_operations/docker/docker04.md" class="sidebar-item" aria-label="微服务部署-k8s(二)-应用"><!--[--><!--]--> 微服务部署-k8s(二)-应用 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item collapsible">jenkins工具 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/deployment_operations/jenkins/jenkins001.md" class="sidebar-item" aria-label="Jenkins 安装部署"><!--[--><!--]--> Jenkins 安装部署 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item collapsible">frp 网络穿透工具 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/deployment_operations/frp/frp001.md" class="sidebar-item" aria-label="Frp网络穿透工具"><!--[--><!--]--> Frp网络穿透工具 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">产品设计与分析 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><p tabindex="0" class="sidebar-item collapsible">Axure原型工具 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/product_design_analysis/axure/axure_rp_10_001.md" class="sidebar-item" aria-label="axure原型设计工具"><!--[--><!--]--> axure原型设计工具 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">代码管理 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><p tabindex="0" class="sidebar-item collapsible">git工具 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/code_management/git/index.md" class="sidebar-item" aria-label="git 常用命令"><!--[--><!--]--> git 常用命令 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item collapsible">Markdown语法 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/code_management/markdown/index.md" class="sidebar-item" aria-label="Markdown使用手册"><!--[--><!--]--> Markdown使用手册 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">人工智能 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><p tabindex="0" class="sidebar-item collapsible">人工智能 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/artificial_intelligence/ai/ai0001.md" class="sidebar-item" aria-label="什么是人工智能"><!--[--><!--]--> 什么是人工智能 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">项目管理 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><p tabindex="0" class="sidebar-item collapsible">工作职责 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/technology/project_management/project/management_0001.md" class="sidebar-item" aria-label="项目管理工作职责"><!--[--><!--]--> 项目管理工作职责 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h2 id="目录" tabindex="-1"><a class="header-anchor" href="#目录" aria-hidden="true">#</a> 目录</h2><nav class="table-of-contents"><ul><li><a aria-current="page" href="/technology/back_end/kafka/kafka01.html#目录" class="router-link-active router-link-exact-active">目录</a></li><li><a aria-current="page" href="/technology/back_end/kafka/kafka01.html#什么是kafka" class="router-link-active router-link-exact-active">什么是Kafka</a></li><li><a aria-current="page" href="/technology/back_end/kafka/kafka01.html#什么是消息" class="router-link-active router-link-exact-active">什么是消息</a></li><li><a aria-current="page" href="/technology/back_end/kafka/kafka01.html#什么是队列" class="router-link-active router-link-exact-active">什么是队列</a></li><li><a aria-current="page" href="/technology/back_end/kafka/kafka01.html#什么是消息队列" class="router-link-active router-link-exact-active">什么是消息队列</a></li><li><a aria-current="page" href="/technology/back_end/kafka/kafka01.html#什么地方使用kafka" class="router-link-active router-link-exact-active">什么地方使用Kafka</a></li><li><a aria-current="page" href="/technology/back_end/kafka/kafka01.html#微服务系统中为什么要使用kafka" class="router-link-active router-link-exact-active">微服务系统中为什么要使用Kafka</a></li><li><a aria-current="page" href="/technology/back_end/kafka/kafka01.html#微服务系统中如何落地kafka" class="router-link-active router-link-exact-active">微服务系统中如何落地Kafka</a><ul><li><a aria-current="page" href="/technology/back_end/kafka/kafka01.html#创建订单业务场景落地" class="router-link-active router-link-exact-active">创建订单业务场景落地</a></li><li><a aria-current="page" href="/technology/back_end/kafka/kafka01.html#创建订单业务场景落地-情况1" class="router-link-active router-link-exact-active">创建订单业务场景落地-情况1</a></li><li><a aria-current="page" href="/technology/back_end/kafka/kafka01.html#创建订单业务场景落地-情况2" class="router-link-active router-link-exact-active">创建订单业务场景落地-情况2</a></li><li><a aria-current="page" href="/technology/back_end/kafka/kafka01.html#创建订单业务场景落地-情况3" class="router-link-active router-link-exact-active">创建订单业务场景落地-情况3</a></li><li><a aria-current="page" href="/technology/back_end/kafka/kafka01.html#创建订单-同时发送短信业务场景落地-订阅发布" class="router-link-active router-link-exact-active">创建订单，同时发送短信业务场景落地(订阅发布)</a></li><li><a aria-current="page" href="/technology/back_end/kafka/kafka01.html#创建订单-订单消息堆积场景落地" class="router-link-active router-link-exact-active">创建订单，订单消息堆积场景落地</a></li><li><a aria-current="page" href="/technology/back_end/kafka/kafka01.html#创建订单-订单消息延迟处理场景落地" class="router-link-active router-link-exact-active">创建订单----订单消息延迟处理场景落地</a></li></ul></li><li><a aria-current="page" href="/technology/back_end/kafka/kafka01.html#扩展" class="router-link-active router-link-exact-active">扩展</a></li></ul></nav><h1 id="分布式中间件-kafka" tabindex="-1"><a class="header-anchor" href="#分布式中间件-kafka" aria-hidden="true">#</a> 分布式中间件-Kafka</h1><h2 id="什么是kafka" tabindex="-1"><a class="header-anchor" href="#什么是kafka" aria-hidden="true">#</a> 什么是Kafka</h2><p>Kafka是消息队列。简称：MQ。MQ全称为Message Queue, 消息队列（MQ）是一种应用程序对应用程序的通信方法。应用程序通过读写出入队列的消息（针对应用程序的数据）来通信，而无需专用连接来链接它们。消息传递指的是程序之间通过在消息中发送数据进行通信，而不是通过直接调用彼此来通信，直接调用通常是用于诸如远程过程调用的技术。排队指的是应用程序通过 队列来通信。队列的使用除去了接收和发送应用程序同时执行的要求。其中较为成熟的MQ产品有IBM WEBSPHERE MQ等等...</p><h2 id="什么是消息" tabindex="-1"><a class="header-anchor" href="#什么是消息" aria-hidden="true">#</a> 什么是消息</h2><p>消息就是数据，增删改查的数据。例如：订单增删改查的数据</p><h2 id="什么是队列" tabindex="-1"><a class="header-anchor" href="#什么是队列" aria-hidden="true">#</a> 什么是队列</h2><p>队列指：<strong>一端进数据，一端出数据</strong></p><h2 id="什么是消息队列" tabindex="-1"><a class="header-anchor" href="#什么是消息队列" aria-hidden="true">#</a> 什么是消息队列</h2><p>消息队列指：<strong>一端进消息，一端进消息</strong></p><h2 id="什么地方使用kafka" tabindex="-1"><a class="header-anchor" href="#什么地方使用kafka" aria-hidden="true">#</a> 什么地方使用Kafka</h2><p>Kafka主要用在分布式系统中，主要是应用在微服务系统中。</p><h2 id="微服务系统中为什么要使用kafka" tabindex="-1"><a class="header-anchor" href="#微服务系统中为什么要使用kafka" aria-hidden="true">#</a> 微服务系统中为什么要使用Kafka</h2><p>在微服务系统中，微服务之间通信，主要是通过Http或者gRPC通信。由于http/gRPC通信方式是同步通信，如果遇到了高并发，同步通信就会导致微服务系统性能瓶颈，所以，为了解决微服务性能瓶颈问题。需要将同步通信换成异步通信方式。因此。就选用使用消息队列。</p><p>消息队列的代表技术，就是Kafka。</p><p>在什么样的微服务系统使用Kafka呢？用的比较多的就是电商微服务系统。那么，在电商微服务系统中如何落地Kafka？</p><p>业务场景：创建订单业务场景</p><h2 id="微服务系统中如何落地kafka" tabindex="-1"><a class="header-anchor" href="#微服务系统中如何落地kafka" aria-hidden="true">#</a> 微服务系统中如何落地Kafka</h2><p>条件</p><p>1、电商微服务系统</p><p>2、Kafka</p><p>3、JDK</p><p>步骤</p><p>1、电商微服务系统准备</p><p>​ 通过nuget创建电商微服务系统</p><p>2、JDK准备</p><p>​ JDK已经上传到百度云盘，百度一下即可安装JDK环境</p><p>2、Kafka准备</p><p>​ 2.1 Kafka前提准备</p><p>​ Kafka下载地址：https://downloads.apache.org/kafka/3.5.1/kafka_2.13-3.5.1.tgz <a href="https://kafka.apache.org/downloads" target="_blank" rel="noopener noreferrer">kafk官网下载地址<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> ​ 2.2 Kafka运行</p><p>​ 1、先运行zookeeper</p><div class="language-c# line-numbers-mode" data-ext="c#"><pre class="language-c#"><code>zookeeper-server-start.bat ../../config/zookeeper.properties
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="/images/kafka/kafka_001_image.png" alt="Alt text"><img src="/images/kafka/kafka_002_image.png" alt="Alt text"></p><p>​ 2、然后启动Kafka</p><div class="language-c# line-numbers-mode" data-ext="c#"><pre class="language-c#"><code>kafka-server-start.bat ../../config/server.properties
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="/images/kafka/kafka_003_image.png" alt="Alt text"><img src="/images/kafka/kafka_004_image.png" alt="Alt text"> ​ 3、使用Kafkatool判断kafka是否运行成功</p><p><a href="https://www.kafkatool.com/download.html" target="_blank" rel="noopener noreferrer">kafkatool下载地址<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><div class="language-c# line-numbers-mode" data-ext="c#"><pre class="language-c#"><code>双击kafkatool.exe
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="/images/kafka/kafka_005_image.png" alt="Alt text"></p><p>​ 4、查看结果</p><h3 id="创建订单业务场景落地" tabindex="-1"><a class="header-anchor" href="#创建订单业务场景落地" aria-hidden="true">#</a> 创建订单业务场景落地</h3><p>条件</p><p>1、电商网站微服务</p><p>2、订单微服务</p><p>3、Confluent.Kafka</p><p>步骤</p><p>1、添加订单消息到Kafka中</p><p>​ 1.1 先在电商网站微服务通过nuget引入</p><p>​ Confluent.Kafka</p><p>​ 1.2 然后在电商网站微服务中创建OrderController类</p><p>​ 1.3、然后在OrderController类添加代码</p><div class="language-c# line-numbers-mode" data-ext="c#"><pre class="language-c#"><code> /// &lt;summary&gt;
        /// 创建订单
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;orderCreateDto&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        [HttpPost]
        public IEnumerable&lt;OrderCreateDto&gt; CreateOrder(OrderCreateDto orderCreateDto)
        {
       		#region 1、生产者 Producer
            {
                var producerConfig = new ProducerConfig
                {
                    BootstrapServers = &quot;127.0.0.1:9092&quot;,
                    MessageTimeoutMs = 50000,
                    EnableIdempotence = true
                };

                var builder = new ProducerBuilder&lt;string, string&gt;(producerConfig);
                builder.SetDefaultPartitioner(RoundRobinPartitioner);
                using (var producer = builder.Build())
                {
                    try
                    {
                        var dr = producer.ProduceAsync(&quot;create-order&quot;, new Message&lt;string, string&gt; { Key = &quot;order-1&quot;, Value = OrderJson }).GetAwaiter().GetResult();
                        _logger.LogInformation(&quot;发送事件 {0} 到 {1} 成功&quot;, dr.Value, dr.TopicPartitionOffset);
                    }
                    catch (ProduceException&lt;string, string&gt; ex)
                    {
                        _logger.LogError(ex, &quot;发送事件到 {0} 失败，原因 {1} &quot;, &quot;order&quot;, ex.Error.Reason);
                    }
                }
            }
            #endregion
      }  
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>1.4、然后启动电商网站添加订单消息到Kafka</p><p>​ 1.5、添加订单消息</p><p>2、从Kafka中消费订单消息</p><p>​ 1.1 先在订单微服务通过nuget引入</p><p>​ Confluent.Kafka</p><p>​ 1.2 然后在订单微服务中创建OrderController类</p><p>​ 1.3、然后在OrderController类添加代码</p><div class="language-c# line-numbers-mode" data-ext="c#"><pre class="language-c#"><code> // &lt;summary&gt;
        /// 创建订单
        /// &lt;/summary&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        [HttpGet]
        public async Task&lt;Order&gt; OrderCreate()
        {
            #region 1、工作队列(单消费者) Consumer
            {
                new Task(() =&gt;
                {
                    var consumerConfig = new ConsumerConfig
                    {
                        BootstrapServers = &quot;127.0.0.1:9092&quot;,
                        AutoOffsetReset = AutoOffsetReset.Earliest,
                        GroupId = &quot;order&quot;,
                        EnableAutoCommit = false
                    };
                    var builder = new ConsumerBuilder&lt;string, string&gt;(consumerConfig);

                    using (var consumer = builder.Build())
                    {
                        // 1、订阅
                        consumer.Subscribe(&quot;create-order&quot;);
                        while (true)
                        {
                            try
                            {
                                // 2、消费(自动确认)
                                var result = consumer.Consume();

                                // 3、业务逻辑:业务逻辑----&gt;执行失败---&gt;消息丢失
                                string key = result.Key;
                                string value = result.Value;

                                _logger.LogInformation($&quot;创建订单：Key:{key}&quot;);
                                _logger.LogInformation($&quot;创建订单：Order:{value}&quot;);
                            }
                            catch (Exception e)
                            {
                                _logger.LogInformation($&quot;异常：Order:{e}&quot;);
                            }
                        }
                    }
                }).Start();
            }
            #endregion
        }
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>1.4、然后启动订单微服务执行监听Kafka</p><p>​ 1.5、消费订单消息</p><h3 id="创建订单业务场景落地-情况1" tabindex="-1"><a class="header-anchor" href="#创建订单业务场景落地-情况1" aria-hidden="true">#</a> 创建订单业务场景落地-情况1</h3><p>情况1：Kafka给订单微服务发消息期间，订单微服务宕机。导致消息丢失</p><p>方案：消息确认机制</p><h4 id="如何落地消息确认机制" tabindex="-1"><a class="header-anchor" href="#如何落地消息确认机制" aria-hidden="true">#</a> 如何落地消息确认机制</h4><p>条件</p><p>1、EnableAutoCommit</p><p>步骤</p><p>1、将订单微服务OrderController EnableAutoCommit修改为true</p><div class="language-c# line-numbers-mode" data-ext="c#"><pre class="language-c#"><code>// &lt;summary&gt;
        /// 创建订单
        /// &lt;/summary&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        [HttpGet]
        public async Task&lt;Order&gt; OrderCreate()
        {
            #region 1、工作队列(单消费者) Consumer
            {
                new Task(() =&gt;
                {
                    var consumerConfig = new ConsumerConfig
                    {
                        BootstrapServers = &quot;127.0.0.1:9092&quot;,
                        AutoOffsetReset = AutoOffsetReset.Earliest,
                        GroupId = &quot;order&quot;,
                        EnableAutoCommit = true
                    };
                    var builder = new ConsumerBuilder&lt;string, string&gt;(consumerConfig);

                    using (var consumer = builder.Build())
                    {
                        // 1、订阅
                        consumer.Subscribe(&quot;create-order&quot;);
                        while (true)
                        {
                            try
                            {
                                // 2、消费(自动确认)
                                var result = consumer.Consume();

                                // 3、业务逻辑:业务逻辑----&gt;执行失败---&gt;消息丢失
                                string key = result.Key;
                                string value = result.Value;

                                _logger.LogInformation($&quot;创建订单：Key:{key}&quot;);
                                _logger.LogInformation($&quot;创建订单：Order:{value}&quot;);
                            }
                            catch (Exception e)
                            {
                                _logger.LogInformation($&quot;异常：Order:{e}&quot;);
                            }
                        }
                    }
                }).Start();
            }
            #endregion
        }
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="创建订单业务场景落地-情况2" tabindex="-1"><a class="header-anchor" href="#创建订单业务场景落地-情况2" aria-hidden="true">#</a> 创建订单业务场景落地-情况2</h3><p>情况2：Kafka给订单微服务发了消息，订单微服务收到消息。 订单微服务发送确认消息给Kafka期间。执行业务逻辑失败了。 导致：消息重复消费</p><p>方案：手动确认</p><h4 id="如何落地手动确认消息" tabindex="-1"><a class="header-anchor" href="#如何落地手动确认消息" aria-hidden="true">#</a> 如何落地手动确认消息</h4><p>条件</p><p>1、Commit</p><p>步骤</p><p>1、将订单微服务OrderController 增加consumer.Commit(result);</p><div class="language-c# line-numbers-mode" data-ext="c#"><pre class="language-c#"><code>// &lt;summary&gt;
        /// 创建订单
        /// &lt;/summary&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        [HttpGet]
        public async Task&lt;Order&gt; OrderCreate()
        {
            #region 1、工作队列(单消费者) Consumer
            {
                new Task(() =&gt;
                {
                    var consumerConfig = new ConsumerConfig
                    {
                        BootstrapServers = &quot;127.0.0.1:9092&quot;,
                        AutoOffsetReset = AutoOffsetReset.Earliest,
                        GroupId = &quot;order&quot;,
                        EnableAutoCommit = false,
                    };
                    var builder = new ConsumerBuilder&lt;string, string&gt;(consumerConfig);
                    var consumer = builder.Build();
                    // 1、订阅
                    consumer.Subscribe(&quot;create-order&quot;);
                    while (true)
                    {
                        // 2、消费
                        var result = consumer.Consume();

                        // 3、业务逻辑
                        string key = result.Key;
                        string value = result.Value;

                        _logger.LogInformation($&quot;创建商品：Key:{key}&quot;);
                        _logger.LogInformation($&quot;创建商品：Order:{value}&quot;);

                        // 3、手动提交（向kafka确认消息）----偏移量---消息的序号
                        consumer.Commit(result);
                    }
                }).Start();
            }
            #endregion
        }
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="创建订单业务场景落地-情况3" tabindex="-1"><a class="header-anchor" href="#创建订单业务场景落地-情况3" aria-hidden="true">#</a> 创建订单业务场景落地-情况3</h3><p>情况3：Kafka给订单微服务发了消息，订单微服务收到消息。 订单微服务发送确认消息给Kafka期间。kafka宕机 导致：消息重复消费</p><p>方案：重置偏移量</p><h4 id="如何落地重置偏移量" tabindex="-1"><a class="header-anchor" href="#如何落地重置偏移量" aria-hidden="true">#</a> 如何落地重置偏移量</h4><p>条件</p><p>1、redis</p><p>2、Microsoft.Extensions.Caching.Redis</p><p>2、Offset</p><p>步骤</p><p>1、先启动redis</p><p>2、然后在订单微服务中nuget引入</p><p>​ Microsoft.Extensions.Caching.Redis</p><p>3、然后在订单微服务Startup中添加</p><div class="language-c# line-numbers-mode" data-ext="c#"><pre class="language-c#"><code>public void ConfigureServices(IServiceCollection services)
{
        ....
        services.AddDistributedRedisCache(options =&gt;
        {
            options.Configuration = &quot;localhost:6379&quot;;
        });
        ...
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>4、将订单微服务OrderController 增加Offset存储</p><div class="language-c# line-numbers-mode" data-ext="c#"><pre class="language-c#"><code>#region 4、工作队列(单消费者)-手动确认消息-偏移量(重复消费)-存储偏移量
{
    new Task(() =&gt;
             {
                 var consumerConfig = new ConsumerConfig
                 {
                     BootstrapServers = &quot;127.0.0.1:9092&quot;,
                     AutoOffsetReset = AutoOffsetReset.Earliest,
                     GroupId = &quot;order&quot;,
                     EnableAutoCommit = true,
                 };
                 var builder = new ConsumerBuilder&lt;string, string&gt;(consumerConfig);
                 using (var consumer = builder.Build())
                 {
                     // 1、订阅
                     consumer.Subscribe(&quot;create-order&quot;);

                     // 1.2、获取偏移量
                     string offset = distributedCache.GetString(&quot;create-order&quot;);
                     if (string.IsNullOrEmpty(offset))
                     {
                         offset = &quot;0&quot;;
                     }

                     // 1.3、重置偏移量
                     consumer.Assign(new TopicPartitionOffset(new TopicPartition(&quot;create-order&quot;, 0), int.Parse(offset) + 1));
                     while (true)
                     {
                         // 2、消费
                         var result = consumer.Consume();

                         // 2.1、获取偏移量
                         _logger.LogInformation($&quot;订单消息偏移量：Offset:{result.Offset}&quot;);
                         // 2.2、把kafka队列中偏移量存起来。redis mysql
                         // 2.3、重置kafka队列的偏移量
                         distributedCache.SetString(&quot;create-order&quot;, result.Offset.Value.ToString());

                         // 3、业务处理
                         string key = result.Key;
                         string value = result.Value;
                         _logger.LogInformation($&quot;创建订单：Key:{key}&quot;);
                         _logger.LogInformation($&quot;创建订单：Order:{value}&quot;);

                         // redis缺陷：无法保证偏移和业务同时成功。
                         // 方案：使用数据库来存储偏移量
                         //       核心：通过数据库事务来保证
                         // 3、手动提交
                         // consumer.Commit(result);
                     }
                 }
             }).Start();
}
#endregion
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>5、然后进行业务操作</p><h3 id="创建订单-同时发送短信业务场景落地-订阅发布" tabindex="-1"><a class="header-anchor" href="#创建订单-同时发送短信业务场景落地-订阅发布" aria-hidden="true">#</a> 创建订单，同时发送短信业务场景落地(订阅发布)</h3><p>条件</p><p>1、电商网站微服务</p><p>2、订单微服务</p><p>3、短信微服务</p><p>4、Kafka</p><p>5、Confluent.Kafka</p><p>步骤</p><p>1、电商网站微服务准备</p><p>​ 1.1 先在电商网站微服务nuget引入</p><p>​ Confluent.Kafka</p><p>​ 1.2 然后在电商网站微服务中OrderController类中添加</p><div class="language-c# line-numbers-mode" data-ext="c#"><pre class="language-c#"><code>	 /// &lt;summary&gt;
        /// 创建订单
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;orderCreateDto&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        [HttpPost]
        public IEnumerable&lt;OrderCreateDto&gt; CreateOrder(OrderCreateDto orderCreateDto)
        {
       		#region 1、生产者 Producer
            {
                var producerConfig = new ProducerConfig
                {
                    BootstrapServers = &quot;127.0.0.1:9092&quot;,
                    MessageTimeoutMs = 50000,
                    EnableIdempotence = true
                };

                var builder = new ProducerBuilder&lt;string, string&gt;(producerConfig);
                builder.SetDefaultPartitioner(RoundRobinPartitioner);
                using (var producer = builder.Build())
                {
                    try
                    {
                        var dr = producer.ProduceAsync(&quot;create-order&quot;, new Message&lt;string, string&gt; { Key = &quot;order-1&quot;, Value = OrderJson }).GetAwaiter().GetResult();
                        _logger.LogInformation(&quot;发送事件 {0} 到 {1} 成功&quot;, dr.Value, dr.TopicPartitionOffset);
                    }
                    catch (ProduceException&lt;string, string&gt; ex)
                    {
                        _logger.LogError(ex, &quot;发送事件到 {0} 失败，原因 {1} &quot;, &quot;order&quot;, ex.Error.Reason);
                    }
                }
            }
            #endregion
      }  
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>​ 1.3 最后启动电商网站微服务</p><p>2、订单微服务准备</p><p>​ 2.1 先在订单微服务中通过nuget引入</p><p>​ Confluent.Kafka</p><p>​ 2.2 然后在订单微服务中OrderController类中添加</p><div class="language-c# line-numbers-mode" data-ext="c#"><pre class="language-c#"><code>	// &lt;summary&gt;
    /// 创建订单
    /// &lt;/summary&gt;
    /// &lt;param name=&quot;OrderCreateDto&quot;&gt;&lt;/param&gt;
    /// &lt;returns&gt;&lt;/returns&gt;
    [HttpPost]
    public IEnumerable&lt;Order&gt; CreateOrder(OrderCreateDto OrderCreateDto)
    {
    	 #region 5、订阅发布(广播消费)1、创建订单----2、发送短信-GroupId
            {
                new Task(() =&gt;
                {
                    var consumerConfig = new ConsumerConfig
                    {
                        BootstrapServers = &quot;127.0.0.1:9092&quot;,
                        AutoOffsetReset = AutoOffsetReset.Earliest,
                        GroupId = &quot;order&quot;,
                        EnableAutoCommit = true,
                    };
                    var builder = new ConsumerBuilder&lt;string, string&gt;(consumerConfig);
                    var consumer = builder.Build();

                    // 1、订阅
                    consumer.Subscribe(&quot;create-order&quot;);
                    // 2、获取偏移量
                    string offset = distributedCache.GetString(&quot;create-order&quot;);
                    if (string.IsNullOrEmpty(offset))
                    {
                        offset = &quot;0&quot;;
                    }
                    // 3、重置偏移量
                    consumer.Assign(new TopicPartitionOffset(new TopicPartition(&quot;create-order&quot;, 0), int.Parse(offset)));
                    while (true)
                    {
                        // 2、消费
                        var result = consumer.Consume();
                        // 2.1、获取偏移量
                        _logger.LogInformation($&quot;订单消息偏移量：Offset:{result.Offset}&quot;);

                        // 3、业务处理
                        string key = result.Key;
                        string value = result.Value;
                        _logger.LogInformation($&quot;创建商品：Key:{key}&quot;);
                        _logger.LogInformation($&quot;创建商品：Order:{value}&quot;);

                        // 2.2、把kafka队列中偏移量存起来。redis mysql
                        // 2.3、重置kafka队列的偏移量
                        distributedCache.SetString(&quot;create-order&quot;, result.Offset.Value.ToString());

                        // 3、手动提交
                        //consumer.Commit(result);
                    }
                }).Start();
            }
            #endregion
    }

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>​ 2.3 最后启动电商网站微服务</p><p>3、短信微服务准备</p><p>​ 3.1 先在短信微服务中通过nuget引入</p><p>​ Confluent.Kafka</p><p>​ 2.2 然后在短信微服务中SmsController类中添加</p><div class="language-c# line-numbers-mode" data-ext="c#"><pre class="language-c#"><code>	/// &lt;summary&gt;
        /// 发送短信
        /// &lt;/summary&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        [HttpGet]
        public IEnumerable&lt;WeatherForecast&gt; Get()
        {
            new Task(() =&gt;
            {
                var consumerConfig = new ConsumerConfig
                {
                    BootstrapServers = &quot;127.0.0.1:9092&quot;,
                    AutoOffsetReset = AutoOffsetReset.Earliest,
                    GroupId = &quot;sms&quot;,
                    EnableAutoCommit = false,
                };
                var builder = new ConsumerBuilder&lt;string, string&gt;(consumerConfig);
                var consumer = builder.Build();

                // 1、订阅
                consumer.Subscribe(&quot;create-order&quot;);
                while (true)
                {
                    // 2、消费
                    var result = consumer.Consume();
                    // 2.1、获取偏移量
                    _logger.LogInformation($&quot;订单消息偏移量：Offset:{result.Offset}&quot;);

                    // 3、业务处理
                    string key = result.Key;
                    string value = result.Value;
                    _logger.LogInformation($&quot;创建商品：Key:{key}&quot;);
                    _logger.LogInformation($&quot;创建商品：Order:{value}&quot;);

                    // 3、手动提交
                    consumer.Commit(result);
                }
            }).Start();
        }
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>​ 2.3 最后启动电商网站微服务</p><p>4、Kafka准备</p><p>​ 4.1 启动Kafka</p><p>5、最后进行业务操作</p><h4 id="原理过程分析" tabindex="-1"><a class="header-anchor" href="#原理过程分析" aria-hidden="true">#</a> 原理过程分析</h4><p>条件</p><p>1、消费者组GroupId</p><p>过程</p><p>消费者组，就是订阅发布，生产者把消息发给给Kafka----&gt;Kafka再把消息发送给主题-----&gt;主题把消息发送给组-----&gt;组再把消息发送消费者</p><h3 id="创建订单-订单消息堆积场景落地" tabindex="-1"><a class="header-anchor" href="#创建订单-订单消息堆积场景落地" aria-hidden="true">#</a> 创建订单，订单消息堆积场景落地</h3><p>条件</p><p>1、电商网站微服务</p><p>2、订单微服务</p><p>3、Kafka</p><p>4、Confluent.Kafka</p><p>步骤</p><p>1、电商网站微服务准备</p><p>​ 1.1 先在电商网站微服务nuget引入</p><p>​ Confluent.Kafka</p><p>​ 1.2 然后在电商网站微服务中OrderController类中添加</p><div class="language-c# line-numbers-mode" data-ext="c#"><pre class="language-c#"><code>	/// &lt;summary&gt;
        /// 创建订单
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;orderCreateDto&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        [HttpPost]
        public IEnumerable&lt;OrderCreateDto&gt; CreateOrder(OrderCreateDto orderCreateDto)
        {
       		#region 1、生产者 Producer
            {
                var producerConfig = new ProducerConfig
                {
                    BootstrapServers = &quot;127.0.0.1:9092&quot;,
                    MessageTimeoutMs = 50000,
                    EnableIdempotence = true
                };

                var builder = new ProducerBuilder&lt;string, string&gt;(producerConfig);
                builder.SetDefaultPartitioner(RoundRobinPartitioner);
                using (var producer = builder.Build())
                {
                    try
                    {
                        var dr = producer.ProduceAsync(&quot;create-order&quot;, new Message&lt;string, string&gt; { Key = &quot;order-1&quot;, Value = OrderJson }).GetAwaiter().GetResult();
                        _logger.LogInformation(&quot;发送事件 {0} 到 {1} 成功&quot;, dr.Value, dr.TopicPartitionOffset);
                    }
                    catch (ProduceException&lt;string, string&gt; ex)
                    {
                        _logger.LogError(ex, &quot;发送事件到 {0} 失败，原因 {1} &quot;, &quot;order&quot;, ex.Error.Reason);
                    }
                }
            }
            #endregion
      }  
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>​ 1.3 最后启动电商网站微服务</p><p>2、订单微服务准备</p><p>​ 2.1 先在订单微服务中通过nuget引入</p><p>​ Confluent.Kafka</p><p>​ 2.2 然后在订单微服务中OrderController类中添加</p><div class="language-c# line-numbers-mode" data-ext="c#"><pre class="language-c#"><code>	// &lt;summary&gt;
    /// 创建订单
    /// &lt;/summary&gt;
    /// &lt;param name=&quot;OrderCreateDto&quot;&gt;&lt;/param&gt;
    /// &lt;returns&gt;&lt;/returns&gt;
    [HttpPost]
    public IEnumerable&lt;Order&gt; CreateOrder(OrderCreateDto OrderCreateDto)
    {
    	 new Task(() =&gt;
                {
                    var consumerConfig = new ConsumerConfig
                    {
                        BootstrapServers = &quot;127.0.0.1:9092&quot;,
                        AutoOffsetReset = AutoOffsetReset.Earliest,
                        GroupId = &quot;order&quot;,
                        EnableAutoCommit = false,
                    };
                    var builder = new ConsumerBuilder&lt;string, string&gt;(consumerConfig);
                    var consumer = builder.Build();

                    // 1、订阅
                    consumer.Subscribe(&quot;create-order-1&quot;);
                    // 2、获取偏移量
                    *//*string offset = distributedCache.GetString(&quot;create-order&quot;);
                    if (string.IsNullOrEmpty(offset))
                    {
                        offset = &quot;0&quot;;
                    }*//*
                    // 3、重置偏移量
                    //consumer.Assign(new TopicPartitionOffset(new TopicPartition(&quot;create-order&quot;, 1), int.Parse(offset)));
                    while (true)
                    {
                        // 2、消费
                        var result = consumer.Consume();
                        // 2.1、获取偏移量
                        _logger.LogInformation($&quot;订单消息偏移量：Offset:{result.Offset}&quot;);
                        // 3、业务处理
                        string key = result.Key;
                        string value = result.Value;
                        _logger.LogInformation($&quot;创建商品：Key:{key}&quot;);
                        _logger.LogInformation($&quot;创建商品：Order:{value}&quot;);

                        // 2.2、把kafka队列中偏移量存起来。redis mysql
                        // 2.3、重置kafka队列的偏移量
                        //distributedCache.SetString(&quot;create-order&quot;, result.Offset.Value.ToString());

                        // 3、手动提交
                        consumer.Commit(result);
                    }
                }).Start();
            }
            #endregion
    }
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>​ 2.3 然后在订单微服务中KafkaController类中添加</p><div class="language-c# line-numbers-mode" data-ext="c#"><pre class="language-c#"><code>/// &lt;summary&gt;
        /// 创建分区(更新分区)
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;topic&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;Partitions&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        [HttpGet(&quot;PartitionUpdate&quot;)]
        public async Task PartitionCreate(string topic,int PartitionCount)
        {
            AdminClientConfig adminClientConfig = new AdminClientConfig
            {
                BootstrapServers = &quot;127.0.0.1:9092&quot;,
            };

            var bu = new AdminClientBuilder(adminClientConfig).Build();
            bu.CreatePartitionsAsync(new PartitionsSpecification[] {
                    new PartitionsSpecification { Topic = topic, IncreaseTo=PartitionCount}
                }).Wait();

            await Task.CompletedTask;
        }
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>​ 2.4 然后启动订单微服务</p><p>​ 2.5 然后创建新的分区</p><p>​ 2.6、然后在kafkatool查看分区结果</p><p>4、Kafka准备</p><p>​ 4.1 启动Kafka</p><p>5、最后进行业务操作</p><h4 id="原理过程分析-1" tabindex="-1"><a class="header-anchor" href="#原理过程分析-1" aria-hidden="true">#</a> 原理过程分析</h4><p>条件</p><p>1、分区Partition</p><p>过程</p><p>分区Partition，就是指数据分开存储，生产者把消息发送给Kafka----&gt;Kafka再把消息发发送给主题----&gt;主题再把消息发送给指定分区-----&gt;指定分区再发送给消费者</p><p>注意：分区和消费者是固定绑定的</p><h3 id="创建订单-订单消息延迟处理场景落地" tabindex="-1"><a class="header-anchor" href="#创建订单-订单消息延迟处理场景落地" aria-hidden="true">#</a> 创建订单----订单消息延迟处理场景落地</h3><p>条件</p><p>1、电商网站微服务</p><p>2、订单微服务</p><p>3、Kafka</p><p>4、Confluent.Kafka</p><p>步骤</p><p>1、电商网站微服务准备</p><p>​ 1.1 先在电商网站微服务nuget引入</p><p>​ Confluent.Kafka</p><p>​ 1.2 然后在电商网站微服务中OrderController类中添加</p><div class="language-c# line-numbers-mode" data-ext="c#"><pre class="language-c#"><code>	// &lt;summary&gt;
    /// 创建订单
    /// &lt;/summary&gt;
    /// &lt;param name=&quot;OrderCreateDto&quot;&gt;&lt;/param&gt;
    /// &lt;returns&gt;&lt;/returns&gt;
    [HttpPost]
    public IEnumerable&lt;Order&gt; CreateOrder(OrderCreateDto OrderCreateDto)
    {
    	 #region 1、生产者 Producer
            {
                var producerConfig = new ProducerConfig
                {
                    BootstrapServers = &quot;127.0.0.1:9092&quot;,
                    MessageTimeoutMs = 50000,
                    EnableIdempotence = true
                };

                var builder = new ProducerBuilder&lt;string, string&gt;(producerConfig);
                builder.SetDefaultPartitioner(RoundRobinPartitioner);
                using (var producer = builder.Build())
                {
                    try
                    {
                        var OrderJson = JsonConvert.SerializeObject(orderCreateDto);
                       // TopicPartition topicPartition = new TopicPartition(&quot;order-create&quot;, 2); // 指定分区发送消息
                        //var dr = producer.ProduceAsync(topicPartition, new Message&lt;string, string&gt; { Key = &quot;order-1&quot;, Value = OrderJson }).GetAwaiter().GetResult();
                        var dr = producer.ProduceAsync(&quot;create-order-1&quot;, new Message&lt;string, string&gt; { Key = &quot;order-1&quot;, Value = OrderJson }).GetAwaiter().GetResult();
                        _logger.LogInformation(&quot;发送事件 {0} 到 {1} 成功&quot;, dr.Value, dr.TopicPartitionOffset);
                    }
                    catch (ProduceException&lt;string, string&gt; ex)
                    {
                        _logger.LogError(ex, &quot;发送事件到 {0} 失败，原因 {1} &quot;, &quot;order&quot;, ex.Error.Reason);
                    }
                }
            }
            #endregion
    }
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>​ 1.3 然后在电商网站微服务中OrderController类中添加</p><div class="language-c# line-numbers-mode" data-ext="c#"><pre class="language-c#"><code>	// &lt;summary&gt;
    /// 创建订单
    /// &lt;/summary&gt;
    /// &lt;param name=&quot;OrderCreateDto&quot;&gt;&lt;/param&gt;
    /// &lt;returns&gt;&lt;/returns&gt;
    [HttpPost]
    public IEnumerable&lt;Order&gt; CreateOrder(OrderCreateDto OrderCreateDto)
    {
    	 #region 8、创建订单----1、订单消息延迟处理
            {
                new Task(() =&gt;
                {
                    var consumerConfig = new ConsumerConfig
                    {
                        BootstrapServers = &quot;127.0.0.1:9092&quot;,
                        AutoOffsetReset = AutoOffsetReset.Earliest,
                        GroupId = &quot;order&quot;,
                        EnableAutoCommit = false,
                        FetchMinBytes=170,
                        FetchMaxBytes=3060
                    };
                    var builder = new ConsumerBuilder&lt;string, string&gt;(consumerConfig);
                    using (var consumer = builder.Build())
                    {
                        // 1、订阅
                        consumer.Subscribe(&quot;create-order-1&quot;);
                        // 2、偏移量恢复
                        string offset = distributedCache.GetString(&quot;create-order-1&quot;);
                        if (string.IsNullOrEmpty(offset))
                        {
                            offset = &quot;0&quot;;
                        }
                        consumer.Assign(new TopicPartitionOffset(new TopicPartition(&quot;create-order-1&quot;, 0), int.Parse(offset)));
                        while (true)
                        {
                            // 1、恢复消息
                            new Timer((s) =&gt;
                            {
                                consumer.Resume(new List&lt;TopicPartition&gt; { new TopicPartition(&quot;create-order-1&quot;, 0) });
                            }, null, Timeout.Infinite, Timeout.Infinite).Change(5000, 5000);

                            // 1.1、消费暂停
                            consumer.Pause(new List&lt;TopicPartition&gt; { new TopicPartition(&quot;create-order-1&quot;, 0) });

                            // 2、消费消息
                            var result = consumer.Consume(); //批量获取消息，根据-----》字节数
                            try
                            {
                                // 2.1、获取偏移量
                                _logger.LogInformation($&quot;订单消息偏移量：Offset:{result.Offset}&quot;);

                                // 3、业务处理
                                string key = result.Key;
                                string value = result.Value;
                                _logger.LogInformation($&quot;创建商品：Key:{key}&quot;);
                                _logger.LogInformation($&quot;创建商品：Order:{value}&quot;);

                                // 2.2、把kafka队列中偏移量存起来。redis mysql
                                // 2.3、重置kafka队列的偏移量
                                distributedCache.SetString(&quot;create-order-1&quot;, result.Offset.Value.ToString());

                                // 3、手动提交
                                consumer.Commit(result);
                            }
                            catch (Exception)
                            {

                                throw;
                            } finally
                            {
                                consumer.Pause(new List&lt;TopicPartition&gt; { new TopicPartition(&quot;create-order-1&quot;, 0) });
                                Console.WriteLine($&quot;暂停消费&quot;);
                            }
                        }
                    }

                }).Start();
            }
            #endregion
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>​ 1.3 最后启动订单微服务</p><p>2.3 然后在订单微服务中KafkaController类中添加</p><div class="language-c# line-numbers-mode" data-ext="c#"><pre class="language-c#"><code>/// &lt;summary&gt;
        /// 创建主题
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;topic&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;Partitions&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        [HttpGet(&quot;TopicCreate&quot;)]
        public async Task TopicCreate(string topic)
        {
            AdminClientConfig adminClientConfig = new AdminClientConfig
            {
                BootstrapServers = &quot;127.0.0.1:9092&quot;,
            };

            var bu = new AdminClientBuilder(adminClientConfig).Build();
            bu.CreateTopicsAsync(new TopicSpecification[] {
                    new TopicSpecification { Name = topic}
                }).Wait();

            await Task.CompletedTask;
        }
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>​ 2.4 然后启动订单微服务</p><p>​ 2.5 然后创建新的主题</p><p>​ 2.6、然后在kafkatool查看分区结果</p><p>4、Kafka准备</p><p>​ 4.1 启动Kafka</p><p>5、最后进行业务操作</p><h4 id="原理过程分析-2" tabindex="-1"><a class="header-anchor" href="#原理过程分析-2" aria-hidden="true">#</a> 原理过程分析</h4><p>条件</p><p>1、Pause</p><p>2、Resume</p><p>3、Timer</p><p>过程</p><p>1、生产者调用consumer.Pause（）。暂定消费var result = consumer.Consume();</p><p>2、然后使用定时器Timer每隔5秒钟调用consumer.Resume。重新消费</p><p>3、起到延时消费的作用</p><h2 id="扩展" tabindex="-1"><a class="header-anchor" href="#扩展" aria-hidden="true">#</a> <strong>扩展</strong></h2><p>1、集群。微服务里面</p><p>2、微服务</p><p>3、ssdb canal微服务</p><p>4、结合ABP</p></div><!--[--><!--]--></div><footer class="page-meta"><!----><!----><!----></footer><!----><!--[--><!--]--></main><!--]--></div><!----><!----><!--]--></div>
    <script type="module" src="/assets/app-c1c3c937.js" defer></script>
  </body>
</html>
